import*as e from"react";import t from"primereact/api";import{CSSTransition as n}from"primereact/csstransition";import{useMountEffect as a,usePrevious as i,useResizeListener as r,useUpdateEffect as l,useInterval as o,useUnmountEffect as c}from"primereact/hooks";import{Portal as u}from"primereact/portal";import{Ripple as s}from"primereact/ripple";import{classNames as m,UniqueComponentId as d,DomHandler as v,ObjectUtils as p,ZIndexUtils as h}from"primereact/utils";function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f.apply(this,arguments)}function g(e){if(Array.isArray(e))return e}function I(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],l=!0,o=!1;try{for(n=n.call(e);!(l=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);l=!0);}catch(e){o=!0,i=e}finally{try{l||null==n.return||n.return()}finally{if(o)throw i}}return r}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function x(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function y(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){return g(e)||I(e,t)||x(e,t)||y()}var E=e.memo(e.forwardRef((function(t,n){var i=function(){t.slideShowActive&&t.stopSlideShow&&t.stopSlideShow()},r=function(e){i(),t.onActiveItemChange({index:t.circular&&0===t.activeItemIndex?t.value.length-1:0!==t.activeItemIndex?t.activeItemIndex-1:0}),e&&e.cancelable&&e.preventDefault()},l=function(e){i(),t.onActiveItemChange({index:t.circular&&t.value.length-1===t.activeItemIndex?0:t.activeItemIndex+1}),e&&e.cancelable&&e.preventDefault()},o=function(e){i(),t.onActiveItemChange({index:e})},c=function(e){t.changeItemOnIndicatorHover&&(i(),t.onActiveItemChange({index:e}))},u=function(e,n){13===e.which&&(i(),t.onActiveItemChange({index:n}))};a((function(){t.autoPlay&&t.startSlideShow()}));var d=function(n){var a="p-galleria-indicator-"+n,i=m("p-galleria-indicator",{"p-highlight":t.activeItemIndex===n}),r=t.indicator&&t.indicator(n);return r||(r=e.createElement("button",{type:"button",tabIndex:-1,className:"p-link"},e.createElement(s,null))),e.createElement("li",{className:i,key:a,tabIndex:0,onClick:function(){return o(n)},onMouseEnter:function(){return c(n)},onKeyDown:function(e){return u(e,n)}},r)},v=t.itemTemplate&&t.itemTemplate(t.value[t.activeItemIndex]),p=function(){if(t.showItemNavigators){var n=!t.circular&&0===t.activeItemIndex,a=m("p-galleria-item-prev p-galleria-item-nav p-link",{"p-disabled":n});return e.createElement("button",{type:"button",className:a,onClick:r,disabled:n},e.createElement("span",{className:"p-galleria-item-prev-icon pi pi-chevron-left"}),e.createElement(s,null))}return null}(),h=function(){if(t.showItemNavigators){var n=!t.circular&&t.activeItemIndex===t.value.length-1,a=m("p-galleria-item-next p-galleria-item-nav p-link",{"p-disabled":n});return e.createElement("button",{type:"button",className:a,onClick:l,disabled:n},e.createElement("span",{className:"p-galleria-item-next-icon pi pi-chevron-right"}),e.createElement(s,null))}return null}(),f=function(){if(t.caption){var n=t.caption(t.value[t.activeItemIndex]);return e.createElement("div",{className:"p-galleria-caption"},n)}return null}(),g=function(){if(t.showIndicators){for(var n=m("p-galleria-indicators p-reset",t.indicatorsContentClassName),a=[],i=0;i<t.value.length;i++)a.push(d(i));return e.createElement("ul",{className:n},a)}return null}();return e.createElement("div",{ref:n,className:"p-galleria-item-wrapper"},e.createElement("div",{className:"p-galleria-item-container"},p,e.createElement("div",{className:"p-galleria-item"},v),h,f),g)})));function N(e){if(Array.isArray(e))return b(e)}function S(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}E.displayName="GalleriaItem";var T=e.memo((function(t){var n=t.active?0:null,a=t.template&&t.template(t.item),i=m("p-galleria-thumbnail-item",{"p-galleria-thumbnail-item-current":t.current,"p-galleria-thumbnail-item-active":t.active,"p-galleria-thumbnail-item-start":t.start,"p-galleria-thumbnail-item-end":t.end},t.className);return e.createElement("div",{className:i},e.createElement("div",{className:"p-galleria-thumbnail-item-content",tabIndex:n,onClick:function(e){t.onItemClick({originalEvent:e,index:t.index})},onKeyDown:function(e){13===e.which&&t.onItemClick({originalEvent:e,index:t.index})}},a))})),A=e.memo(e.forwardRef((function(n,o){var c=w(e.useState(n.numVisible),2),u=c[0],h=c[1],f=w(e.useState(0),2),g=f[0],I=f[1],b=e.useRef(null),y=e.useRef(null),E=e.useRef(""),A=e.useRef(null),O=e.useRef(null),k=i(u),V=i(n.activeItemIndex),P=w(r({listener:function(){U()},when:n.responsiveOptions}),1)[0],H=function(e){var t=g+e;e<0&&-1*t+u>n.value.length-1?t=u-n.value.length:e>0&&t>0&&(t=0),n.circular&&(e<0&&n.value.length-1===n.activeItemIndex?t=0:e>0&&0===n.activeItemIndex&&(t=u-n.value.length)),b.current&&(v.removeClass(b.current,"p-items-hidden"),b.current.style.transform=n.isVertical?"translate3d(0, ".concat(t*(100/u),"%, 0)"):"translate3d(".concat(t*(100/u),"%, 0, 0)"),b.current.style.transition="transform 500ms ease 0s"),I(t)},R=function(){n.slideShowActive&&n.stopSlideShow&&n.stopSlideShow()},D=function(){var e=Math.floor(u/2);return u%2?e:e-1},j=function(e){R();var t=0!==n.activeItemIndex?n.activeItemIndex-1:0;u-(t+g)-1>D()&&(-1*g!=0||n.circular)&&H(1),n.onActiveItemChange({index:n.circular&&0===n.activeItemIndex?n.value.length-1:t}),e.cancelable&&e.preventDefault()},M=function(e){R();var t=n.activeItemIndex+1;t+g>D()&&(-1*g<z()-1||n.circular)&&H(-1),n.onActiveItemChange({index:n.circular&&n.value.length-1===n.activeItemIndex?0:t}),e.cancelable&&e.preventDefault()},G=function(e){R();var t=e.index;if(t!==n.activeItemIndex){var a=t+g,i=0;t<n.activeItemIndex?(i=u-a-1-D())>0&&-1*g!=0&&H(i):(i=D()-a)<0&&-1*g<z()-1&&H(i),n.onActiveItemChange({index:t})}},K=function(e){b.current&&"transform"===e.propertyName&&(v.addClass(b.current,"p-items-hidden"),b.current.style.transition="")},Y=function(e){var t=e.changedTouches[0];y.current={x:t.pageX,y:t.pageY}},Z=function(e){e.cancelable&&e.preventDefault()},X=function(e){var t=e.changedTouches[0];_(e,n.isVertical?t.pageY-y.current.y:t.pageX-y.current.x)},_=function(e,t){t<0?M(e):j(e)},z=function(){return n.value.length>u?n.value.length-u+1:0},L=function(){A.current||(A.current=v.createInlineStyle(t.nonce));var e,a="\n            .p-galleria-thumbnail-items[".concat(E.current,"] .p-galleria-thumbnail-item {\n                flex: 1 0 ").concat(100/u,"%\n            }\n        ");if(n.responsiveOptions){O.current=N(e=n.responsiveOptions)||S(e)||x(e)||C(),O.current.sort((function(e,n){return p.sort(e.breakpoint,n.breakpoint,-1,t.locale,t.nullSortOrder)}));for(var i=0;i<O.current.length;i++){var r=O.current[i];a+="\n                    @media screen and (max-width: ".concat(r.breakpoint,") {\n                        .p-galleria-thumbnail-items[").concat(E.current,"] .p-galleria-thumbnail-item {\n                            flex: 1 0 ").concat(100/r.numVisible,"%\n                        }\n                    }\n                ")}}A.current.innerHTML=a},U=function(){if(b.current&&O.current){for(var e=window.innerWidth,t={numVisible:n.numVisible},a=0;a<O.current.length;a++){var i=O.current[a];parseInt(i.breakpoint,10)>=e&&(t=i)}u!==t.numVisible&&h(t.numVisible)}};a((function(){b.current&&(E.current=d(),b.current.setAttribute(E.current,"")),L(),U(),P()})),l((function(){var e=g;k===u&&V===n.activeItemIndex||((e=n.activeItemIndex<=D()?0:n.value.length-u+D()<n.activeItemIndex?u-n.value.length:n.value.length-u<n.activeItemIndex&&u%2==0?-1*n.activeItemIndex+D()+1:-1*n.activeItemIndex+D())!==g&&I(e),b.current.style.transform=n.isVertical?"translate3d(0, ".concat(e*(100/u),"%, 0)"):"translate3d(".concat(e*(100/u),"%, 0, 0)"),V!==n.activeItemIndex&&(v.removeClass(b.current,"p-items-hidden"),b.current.style.transition="transform 500ms ease 0s"))}));var W,$,q,B,F=function(){if(n.showThumbnailNavigators){var t=!n.circular&&0===n.activeItemIndex||n.value.length<=u,a=m("p-galleria-thumbnail-prev p-link",{"p-disabled":t}),i=m("p-galleria-thumbnail-prev-icon pi",{"pi-chevron-left":!n.isVertical,"pi-chevron-up":n.isVertical});return e.createElement("button",{className:a,onClick:j,disabled:t},e.createElement("span",{className:i}),e.createElement(s,null))}return null},J=function(){if(n.showThumbnailNavigators){var t=!n.circular&&n.activeItemIndex===n.value.length-1||n.value.length<=u,a=m("p-galleria-thumbnail-next p-link",{"p-disabled":t}),i=m("p-galleria-thumbnail-next-icon pi",{"pi-chevron-right":!n.isVertical,"pi-chevron-down":n.isVertical});return e.createElement("button",{className:a,onClick:M,disabled:t},e.createElement("span",{className:i}),e.createElement(s,null))}return null},Q=(W=n.value.map((function(t,a){var i=-1*g,r=i+u-1;return e.createElement(T,{key:a,index:a,template:n.itemTemplate,item:t,active:i<=a&&r>=a,start:i===a,end:r===a,onItemClick:G,current:n.activeItemIndex===a})})),$=n.isVertical?n.contentHeight:"",q=F(),B=J(),e.createElement("div",{className:"p-galleria-thumbnail-container"},q,e.createElement("div",{className:"p-galleria-thumbnail-items-container",style:{height:$}},e.createElement("div",{ref:b,className:"p-galleria-thumbnail-items",onTransitionEnd:K,onTouchStart:Y,onTouchMove:Z,onTouchEnd:X},W)),B));return e.createElement("div",{className:"p-galleria-thumbnail-wrapper"},Q)})));T.displayName="GalleriaThumbnailItem",A.displayName="GalleriaThumbnails";var O=e.memo(e.forwardRef((function(a,i){var r=w(e.useState(!1),2),l=r[0],d=r[1],g=w(e.useState(a.numVisible),2),I=g[0],b=g[1],x=w(e.useState(!1),2),y=x[0],N=x[1],S=w(e.useState(a.activeIndex),2),C=S[0],T=S[1],k=e.useRef(null),V=e.useRef(null),P=e.useRef(null),H=a.onItemChange?a.activeIndex:C,R="left"===a.thumbnailsPosition||"right"===a.thumbnailsPosition;o((function(){D({index:a.circular&&a.value.length-1===H?0:H+1})}),a.transitionInterval,y);var D=function(e){a.onItemChange?a.onItemChange(e):T(e.index)},j=function(){d(!0)},M=function(){d(!1)},G=function(){v.addClass(document.body,"p-overflow-hidden")},K=function(){h.set("modal",P.current,t.autoZIndex,a.baseZIndex||t.zIndex.modal),v.addMultipleClasses(P.current,"p-component-overlay p-component-overlay-enter")},Y=function(){a.onShow&&a.onShow()},Z=function(){v.removeClass(document.body,"p-overflow-hidden"),v.addClass(P.current,"p-component-overlay-leave")},X=function(){h.clear(P.current),a.onHide&&a.onHide()},_=function(){return y},z=function(){N(!0)},L=function(){N(!1)},U=function(e,t){var n=["top","left","bottom","right"].find((function(e){return e===t}));return n?"".concat(e,"-").concat(n):""};e.useEffect((function(){a.value&&a.value.length<I&&b(a.value.length)}),[a.value,I]),e.useEffect((function(){b(a.numVisible)}),[a.numVisible]),c((function(){y&&L(),h.clear(P.current)})),e.useImperativeHandle(i,(function(){return{props:a,show:j,hide:M,isAutoPlayActive:_,startSlideShow:z,stopSlideShow:L,getElement:function(){return k.current},getPreviewContent:function(){return V.current}}}));return p.isNotEmpty(a.value)&&function(){var t,i,r,o,c,d,v,h=(t=p.findDiffKeys(a,O.defaultProps),i=a.showThumbnails&&U("p-galleria-thumbnails",a.thumbnailsPosition),r=a.showIndicators&&U("p-galleria-indicators",a.indicatorsPosition),o=m("p-galleria p-component",a.className,{"p-galleria-fullscreen":a.fullScreen,"p-galleria-indicator-onitem":a.showIndicatorsOnItem,"p-galleria-item-nav-onhover":a.showItemNavigatorsOnHover&&!a.fullScreen},i,r),c=a.fullScreen&&e.createElement("button",{type:"button",className:"p-galleria-close p-link","aria-label":localeOption("close"),onClick:M},e.createElement("span",{className:"p-galleria-close-icon pi pi-times","aria-hidden":"true"}),e.createElement(s,null)),d=a.header?e.createElement("div",{className:"p-galleria-header"},a.header):null,v=a.footer?e.createElement("div",{className:"p-galleria-footer"},a.footer):null,e.createElement("div",f({ref:k,id:a.id,className:o,style:a.style},t),c,d,e.createElement("div",{className:"p-galleria-content"},e.createElement(E,{ref:V,value:a.value,activeItemIndex:H,onActiveItemChange:D,itemTemplate:a.item,circular:a.circular,caption:a.caption,showIndicators:a.showIndicators,changeItemOnIndicatorHover:a.changeItemOnIndicatorHover,indicator:a.indicator,showItemNavigators:a.showItemNavigators,autoPlay:a.autoPlay,slideShowActive:y,startSlideShow:z,stopSlideShow:L}),a.showThumbnails&&e.createElement(A,{value:a.value,activeItemIndex:H,onActiveItemChange:D,itemTemplate:a.thumbnail,numVisible:I,responsiveOptions:a.responsiveOptions,circular:a.circular,isVertical:R,contentHeight:a.verticalThumbnailViewPortHeight,showThumbnailNavigators:a.showThumbnailNavigators,autoPlay:a.autoPlay,slideShowActive:y,stopSlideShow:L})),v));if(a.fullScreen){var g=m("p-galleria-mask",{"p-galleria-visible":l});return e.createElement(u,{element:e.createElement("div",{ref:P,className:g},e.createElement(n,{nodeRef:k,classNames:"p-galleria",in:l,timeout:{enter:150,exit:150},options:a.transitionOptions,unmountOnExit:!0,onEnter:G,onEntering:K,onEntered:Y,onExit:Z,onExited:X},h))})}return h}()})));O.displayName="Galleria",O.defaultProps={__TYPE:"Galleria",id:null,value:null,activeIndex:0,fullScreen:!1,item:null,thumbnail:null,indicator:null,caption:null,className:null,style:null,header:null,footer:null,numVisible:3,responsiveOptions:null,showItemNavigators:!1,showThumbnailNavigators:!0,showItemNavigatorsOnHover:!1,changeItemOnIndicatorHover:!1,circular:!1,autoPlay:!1,transitionInterval:4e3,showThumbnails:!0,thumbnailsPosition:"bottom",verticalThumbnailViewPortHeight:"300px",showIndicators:!1,showIndicatorsOnItem:!1,indicatorsPosition:"bottom",baseZIndex:0,transitionOptions:null,onItemChange:null};export{O as Galleria};
