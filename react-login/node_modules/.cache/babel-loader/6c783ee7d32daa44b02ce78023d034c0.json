{"ast":null,"code":"import _slicedToArray from \"/Users/jinsonwu/Desktop/MIRC-Code-Verification/react-login/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"/Users/jinsonwu/Desktop/MIRC-Code-Verification/react-login/src/components/Notifications.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from \"react\";\nimport firebase from \"firebase\";\nimport { db } from \"../Fire\";\nimport { CSSTransition, TransitionGroup } from \"react-transition-group\";\nimport { BrowserRouter as Router, Switch, Route, Link, NavLink, Redirect, useLocation } from \"react-router-dom\";\nimport Usersettings from \"./Usersettings\";\nimport { ContextApp } from \"../ContextAPI\";\nimport Calendars from \"./Calendars\";\nimport Hoverlink from \"./Hoverlink\";\nimport ElapsedTime from \"./Elapsedtime\";\nimport ReactTimeAgo from 'react-time-ago';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Notifications(props) {\n  _s();\n  var _this = this;\n  var _useContext = useContext(ContextApp),\n    themecolor = _useContext.themecolor;\n  var setChatuser = props.setChatuser;\n  var user = firebase.auth().currentUser;\n  var _useState = useState(\"\"),\n    _useState2 = _slicedToArray(_useState, 2),\n    cover = _useState2[0],\n    setCover = _useState2[1];\n  var _useState3 = useState(0),\n    _useState4 = _slicedToArray(_useState3, 2),\n    notifi = _useState4[0],\n    setNotifLength = _useState4[1];\n  var _useState5 = useState([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    notifications = _useState6[0],\n    setNotifications = _useState6[1];\n  var imageRegexB = /(?:https?|ftp):\\/\\/[\\S]*\\.(?:png|jpe?g|gif|svg|webp)/g;\n  function determineNotiMsg(msg) {\n    if (msg.gif) {\n      return 'Sent a GIF';\n    } else if (msg.file) {\n      return 'Sent a file';\n    } else if (msg.video) {\n      return 'Sent a video';\n    } else if (msg.base64 || msg.notifimsg.match(imageRegexB) != null) {\n      return 'Sent a photo';\n    } else {\n      return msg.notifimsg;\n    }\n  }\n  var id = db.collection('users').doc().id;\n  function deleteNotifi(el) {\n    notifications && notifications.map(function (noti) {\n      if (el.notifiid === noti.notifiid) {\n        var itemindex = notifications.indexOf(noti);\n        notifications.splice(itemindex, 1);\n        db.collection('notifications').doc(user.uid).update({\n          notifications: notifications\n        });\n      }\n    });\n  }\n  function deleteAllNotifi() {\n    db.collection('notifications').doc(user.uid).update({\n      notifications: []\n    });\n  }\n  var notificationsrow = notifications && notifications.slice(0).reverse().map(function (noti) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: '/chat/' + noti.id,\n        onClick: function onClick() {\n          setChatuser(noti.senderid);\n          deleteNotifi(noti);\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"notification flex\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"userprofile\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: cover,\n              alt: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 65,\n              columnNumber: 9\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 7\n          }, _this), /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [\" \", /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"From: \", noti.sender]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 67,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 6\n          }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"Message: \", determineNotiMsg(noti)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 7\n          }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"Sent: \", /*#__PURE__*/_jsxDEV(ReactTimeAgo, {\n              date: noti.notifidate.toDate(),\n              locale: \"en-US\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 19\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 7\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 5\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 18\n      }, _this), /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fal fa-times\",\n        onClick: function onClick() {\n          return deleteNotifi(noti);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 5\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 12\n    }, _this);\n  });\n  useEffect(function () {\n    db.collection('notifications').doc(user.uid).onSnapshot(function (snap) {\n      var notifi = snap.data();\n      setNotifLength(notifi.notifications.length);\n      setNotifications(notifi.notifications);\n      setCover(notifi.notifications.cover);\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"notificationspage\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tp\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header flexrow \",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          class: \"far fa-inbox\",\n          style: {\n            color: themecolor,\n            cursor: 'auto'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Your Notifications\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n        style: {\n          width: '100%'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 8\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notificationsrow flex\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"notifiBtnCont\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \" themeBtn notifiBtn\",\n          onClick: function onClick() {\n            return deleteAllNotifi();\n          },\n          children: \"Clear Notifications \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), notificationsrow]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n}\n_s(Notifications, \"yK42a3PbuvLgr8pspa9cOrn5OHU=\");\n_c = Notifications;\nexport default Notifications;\nvar _c;\n$RefreshReg$(_c, \"Notifications\");","map":{"version":3,"names":["React","useState","useEffect","useContext","firebase","db","CSSTransition","TransitionGroup","BrowserRouter","Router","Switch","Route","Link","NavLink","Redirect","useLocation","Usersettings","ContextApp","Calendars","Hoverlink","ElapsedTime","ReactTimeAgo","Notifications","props","themecolor","setChatuser","user","auth","currentUser","cover","setCover","notifi","setNotifLength","notifications","setNotifications","imageRegexB","determineNotiMsg","msg","gif","file","video","base64","notifimsg","match","id","collection","doc","deleteNotifi","el","map","noti","notifiid","itemindex","indexOf","splice","uid","update","deleteAllNotifi","notificationsrow","slice","reverse","senderid","sender","notifidate","toDate","onSnapshot","snap","data","length","color","cursor","width"],"sources":["/Users/jinsonwu/Desktop/MIRC-Code-Verification/react-login/src/components/Notifications.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport firebase from \"firebase\";\r\nimport { db } from \"../Fire\";\r\nimport { CSSTransition, TransitionGroup } from \"react-transition-group\";\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Link,\r\n  NavLink,\r\n  Redirect,\r\n  useLocation\r\n} from \"react-router-dom\";\r\nimport Usersettings from \"./Usersettings\";\r\nimport { ContextApp } from \"../ContextAPI\";\r\nimport Calendars from \"./Calendars\";\r\nimport Hoverlink from \"./Hoverlink\";\r\nimport ElapsedTime from \"./Elapsedtime\";\r\nimport ReactTimeAgo from 'react-time-ago'\r\nfunction Notifications(props) {\r\n  const { themecolor } = useContext(ContextApp);\r\n  const {setChatuser} = props\r\n  const user = firebase.auth().currentUser;\r\n  const [cover, setCover] = useState(\"\");\r\n  const [notifi, setNotifLength]=useState(0)\r\n  const [notifications, setNotifications]=useState([])\r\n\r\n  const imageRegexB = /(?:https?|ftp):\\/\\/[\\S]*\\.(?:png|jpe?g|gif|svg|webp)/g;\r\n\r\n  function determineNotiMsg(msg){\r\n    if(msg.gif){\r\n      return 'Sent a GIF'\r\n    }else if(msg.file){\r\n      return 'Sent a file'\r\n    }else if(msg.video){\r\n      return 'Sent a video'\r\n    }else if(msg.base64||msg.notifimsg.match(imageRegexB) != null){\r\n      return 'Sent a photo'\r\n    }\r\n    else {\r\n      return msg.notifimsg\r\n    }\r\n  }\r\n  const id =db.collection('users').doc().id\r\n  function deleteNotifi(el){\r\n      notifications && notifications.map(noti=>{\r\n        if(el.notifiid===noti.notifiid){\r\n          let itemindex = notifications.indexOf(noti)\r\n          notifications.splice(itemindex, 1)\r\n          db.collection('notifications').doc(user.uid).update({\r\n            notifications: notifications\r\n          })\r\n        }\r\n      })\r\n  }\r\n  function deleteAllNotifi(){\r\n    db.collection('notifications').doc(user.uid).update({\r\n      notifications: []\r\n    })\r\n  }\r\n  const notificationsrow = notifications && notifications.slice(0).reverse().map(noti=>{\r\n    return <div ><Link to={'/chat/'+noti.id} onClick={()=>{setChatuser(noti.senderid); deleteNotifi(noti)}}>\r\n    <div className=\"notification flex\">\r\n      <div className=\"userprofile\">\r\n        <img src={cover} alt=\"\"/>\r\n      </div>\r\n     <strong> <p>From: {noti.sender}</p></strong>\r\n      <span>Message: {determineNotiMsg(noti)}</span>\r\n      <span>Sent: <ReactTimeAgo date={noti.notifidate.toDate()} locale='en-US'/></span>\r\n      \r\n   </div>\r\n    </Link>\r\n    <i className=\"fal fa-times\" onClick={()=>deleteNotifi(noti)}></i></div>\r\n  })\r\n  useEffect(()=>{\r\n    \r\n    db.collection('notifications').doc(user.uid).onSnapshot(snap=>{\r\n      const notifi = snap.data()\r\n      setNotifLength(notifi.notifications.length)\r\n      setNotifications(notifi.notifications)\r\n      setCover(notifi.notifications.cover)\r\n    }) \r\n  },[])\r\n  return (\r\n    <div className=\"notificationspage\">\r\n      <div className=\"tp\">\r\n      <div className=\"header flexrow \">\r\n      <i class=\"far fa-inbox\" style={{color: themecolor, cursor: 'auto'}}></i>\r\n        <h2>Your Notifications</h2>\r\n      </div>   \r\n       <hr style={{width: '100%'}}/>\r\n      </div>\r\n      <div className=\"notificationsrow flex\">\r\n        <div className='notifiBtnCont'>\r\n          <button className=' themeBtn notifiBtn' onClick={()=>deleteAllNotifi()}>Clear Notifications </button>\r\n          </div>\r\n        {notificationsrow}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nexport default Notifications;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}