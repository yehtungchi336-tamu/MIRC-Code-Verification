{"ast":null,"code":"import _slicedToArray from \"/Users/jinsonwu/Desktop/MIRC-Code-Verification/react-login/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"/Users/jinsonwu/Desktop/MIRC-Code-Verification/react-login/src/components/Userrow.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport Users from './Users';\nimport { db } from '../Fire';\nimport firebase from 'firebase';\nimport { ContextApp } from '../ContextAPI';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Userrow(props) {\n  _s();\n  var _this = this;\n  var _useContext = useContext(ContextApp),\n    themecolor = _useContext.themecolor;\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    keyword = _useState2[0],\n    setKeyword = _useState2[1];\n  var pattern = new RegExp('\\\\b' + keyword.replace(/[\\W_]+/g, \"\"), 'i');\n  var convoinfo = props.convoinfo,\n    setConvoinfo = props.setConvoinfo,\n    setChatuser = props.setChatuser,\n    chatuser = props.chatuser;\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userlist = _useState4[0],\n    setUserlist = _useState4[1];\n  var _useState5 = useState([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    convos = _useState6[0],\n    setConvos = _useState6[1];\n  var id = db.collection('users').doc().id;\n  var user = firebase.auth().currentUser;\n  var allconvos = convos && convos.sort(function (a, b) {\n    return b.lastmsgdate - a.lastmsgdate;\n  }).map(function (el) {\n    if (user) {\n      return /*#__PURE__*/_jsxDEV(Users, {\n        chatuser: chatuser,\n        setChatuser: setChatuser,\n        el: el,\n        convoinfo: convoinfo,\n        setConvoinfo: setConvoinfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 18\n      }, _this);\n    } else {\n      return null;\n    }\n  });\n  useEffect(function () {\n    db.collection('users').doc(user.uid).onSnapshot(function (user) {\n      var userlist = user.data();\n      setUserlist(userlist);\n      db.collection('conversations').onSnapshot(function (snap) {\n        var convos = [];\n        snap.forEach(function (doc) {\n          if (userlist.msgids.includes(doc.id)) {\n            convos.push(doc.data());\n          }\n        });\n        setConvos(convos);\n      });\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Chats\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"search abs\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        class: \"far fa-plus\",\n        style: {\n          color: themecolor\n        },\n        onClick: function onClick() {\n          return props.setAdduser();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Search\",\n        onFocus: function onFocus() {\n          return props.setAdduser();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 8\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 6\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"users\",\n      children: allconvos\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 6\n    }, this)]\n  }, void 0, true);\n}\n_s(Userrow, \"P/b7617EIxO+SjT0H2EqIxNApn8=\");\n_c = Userrow;\nexport default Userrow;\nvar _c;\n$RefreshReg$(_c, \"Userrow\");","map":{"version":3,"names":["React","useState","useEffect","useContext","NavLink","Users","db","firebase","ContextApp","Userrow","props","themecolor","keyword","setKeyword","pattern","RegExp","replace","convoinfo","setConvoinfo","setChatuser","chatuser","userlist","setUserlist","convos","setConvos","id","collection","doc","user","auth","currentUser","allconvos","sort","a","b","lastmsgdate","map","el","uid","onSnapshot","data","snap","forEach","msgids","includes","push","color","setAdduser"],"sources":["/Users/jinsonwu/Desktop/MIRC-Code-Verification/react-login/src/components/Userrow.js"],"sourcesContent":["import React, {useState, useEffect, useContext} from 'react'\r\nimport { NavLink } from 'react-router-dom'\r\nimport Users from './Users'\r\nimport {db} from '../Fire'\r\nimport firebase from 'firebase'\r\nimport { ContextApp } from '../ContextAPI'\r\n\r\nfunction Userrow (props) {\r\n  const {themecolor}=useContext(ContextApp)\r\n  const [keyword, setKeyword]=useState('')\r\n  const pattern = new RegExp('\\\\b' + keyword.replace(/[\\W_]+/g,\"\"), 'i')\r\n\r\n    const {convoinfo, setConvoinfo, setChatuser, chatuser}= props \r\n    const [userlist, setUserlist]=useState([])\r\n    const [convos, setConvos]=useState([])\r\n    const id =db.collection('users').doc().id\r\n    const  user = firebase.auth().currentUser\r\n    const allconvos = convos && convos.sort((a, b) => b.lastmsgdate - a.lastmsgdate).map(el=>{\r\n      if(user){\r\n          return <Users   chatuser={chatuser} setChatuser={setChatuser} el={el} convoinfo={convoinfo} setConvoinfo={setConvoinfo}/>    \r\n\r\n      }else {\r\n        return null\r\n      }\r\n    })\r\n    useEffect(()=>{\r\n     db.collection('users').doc(user.uid).onSnapshot(user=>{\r\n       const userlist = user.data()\r\n       setUserlist(userlist)\r\n       db.collection('conversations').onSnapshot(snap=>{\r\n         let convos = []\r\n          snap.forEach(doc=>{\r\n            if(userlist.msgids.includes(doc.id)){\r\n              convos.push(doc.data())\r\n            }\r\n          })\r\n          setConvos(convos)\r\n       })\r\n     })\r\n    },[])\r\n  return (\r\n   <>\r\n    <h2>Chats</h2>\r\n     <div className=\"search abs\">\r\n      \r\n       <i class=\"far fa-plus\" style={{color: themecolor}} onClick={()=>props.setAdduser()}></i>\r\n       <input type=\"text\" placeholder='Search' onFocus={()=>props.setAdduser()}/>\r\n     </div> \r\n   \r\n     <div className=\"users\">\r\n     {allconvos}     \r\n     </div>\r\n    \r\n  </>\r\n  )\r\n}\r\nexport default Userrow"],"mappings":"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"},"metadata":{},"sourceType":"module"}