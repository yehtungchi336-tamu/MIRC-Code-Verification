{"ast":null,"code":"import{db}from\"../Fire\";import firebase from\"firebase\";export function StartConvo(recipientid,message,convoid,recipientname){var user=firebase.auth().currentUser;var date=firebase.firestore.FieldValue.serverTimestamp();var convoinfo={convoid:convoid,creatorid:user.uid,creatorname:user.displayName,recipientid:recipientid,recipientname:recipientname,typerid:user.uid,userref:db.collection(\"users\").doc(recipientid)// usertyping: false,\n};var customizedconvo={theme:\"https://i.imgur.com/4hzNTTq.png\",emoji:\"ðŸ¤—\"};var nicknames={nickname1:\"\",nickname2:\"\"};var messages={message:message,reaction1:\"\",reaction2:\"\",msgdate:firebase.firestore.Timestamp.now(),msgid:db.collection(\"conversations\").doc().id,read:false,senderid:user.uid,sendername:user.displayName,editing:false};var notificationobj={notifimsg:message,notifidate:firebase.firestore.Timestamp.now(),read:false,sender:user.displayName,id:convoid,senderid:user.uid,notifiid:db.collection('users').doc().id};db.collection('notifications').doc(recipientid).update({notifications:firebase.firestore.FieldValue.arrayUnion(notificationobj)});db.collection(\"users\").doc(user.uid).update({msgids:firebase.firestore.FieldValue.arrayUnion(convoid),msgpersonids:firebase.firestore.FieldValue.arrayUnion(recipientid)});db.collection(\"users\").doc(recipientid).update({msgids:firebase.firestore.FieldValue.arrayUnion(convoid),msgpersonids:firebase.firestore.FieldValue.arrayUnion(user.uid)});db.collection(\"conversations\").doc(convoid).set({lastmsgdate:date,convoinfo:convoinfo,messages:firebase.firestore.FieldValue.arrayUnion(messages),customizedconvo:customizedconvo,nickname1:'',notifications1:true,nickname2:'',notifications2:true});}","map":{"version":3,"names":["db","firebase","StartConvo","recipientid","message","convoid","recipientname","user","auth","currentUser","date","firestore","FieldValue","serverTimestamp","convoinfo","creatorid","uid","creatorname","displayName","typerid","userref","collection","doc","customizedconvo","theme","emoji","nicknames","nickname1","nickname2","messages","reaction1","reaction2","msgdate","Timestamp","now","msgid","id","read","senderid","sendername","editing","notificationobj","notifimsg","notifidate","sender","notifiid","update","notifications","arrayUnion","msgids","msgpersonids","set","lastmsgdate","notifications1","notifications2"],"sources":["/Users/jinsonwu/Desktop/MIRC-Code-Verification/react-login/src/components/StartConvo.js"],"sourcesContent":["import { db } from \"../Fire\";\r\nimport firebase from \"firebase\";\r\n\r\nexport function StartConvo(recipientid, message, convoid, recipientname) {\r\n  const user = firebase.auth().currentUser;\r\n  const date = firebase.firestore.FieldValue.serverTimestamp()\r\n  let convoinfo = {\r\n    convoid,\r\n    creatorid: user.uid,\r\n    creatorname: user.displayName,\r\n    recipientid,\r\n    recipientname,\r\n    typerid: user.uid,\r\n    userref: db.collection(\"users\").doc(recipientid)\r\n    // usertyping: false,\r\n  };\r\n  let customizedconvo = {\r\n    theme: \"https://i.imgur.com/4hzNTTq.png\",\r\n    emoji: \"ðŸ¤—\"\r\n  };\r\n  let nicknames = {\r\n    nickname1: \"\",\r\n    nickname2: \"\"\r\n  };\r\n  let messages = {\r\n    message,\r\n    reaction1: \"\",\r\n    reaction2: \"\",\r\n    msgdate: firebase.firestore.Timestamp.now(),\r\n    msgid: db.collection(\"conversations\").doc().id,\r\n    read: false,\r\n    senderid: user.uid,\r\n    sendername: user.displayName,\r\n    editing: false\r\n  };\r\n  let notificationobj = {\r\n    notifimsg: message,\r\n    notifidate: firebase.firestore.Timestamp.now(),\r\n    read: false,\r\n    sender: user.displayName,\r\n    id: convoid,\r\n    senderid: user.uid,\r\n    notifiid: db.collection('users').doc().id\r\n  }      \r\n    db.collection('notifications').doc(recipientid).update({\r\n      notifications: firebase.firestore.FieldValue.arrayUnion(notificationobj)\r\n    })\r\n  db.collection(\"users\")\r\n    .doc(user.uid)\r\n    .update({\r\n      msgids: firebase.firestore.FieldValue.arrayUnion(convoid),\r\n      msgpersonids: firebase.firestore.FieldValue.arrayUnion(recipientid)\r\n    });\r\n  db.collection(\"users\")\r\n    .doc(recipientid)\r\n    .update({\r\n      msgids: firebase.firestore.FieldValue.arrayUnion(convoid),\r\n      msgpersonids: firebase.firestore.FieldValue.arrayUnion(user.uid)\r\n    });\r\n  db.collection(\"conversations\")\r\n    .doc(convoid)\r\n    .set({\r\n      lastmsgdate : date,\r\n      convoinfo,\r\n      messages: firebase.firestore.FieldValue.arrayUnion(messages),\r\n      customizedconvo,\r\n      nickname1: '',\r\n      notifications1: true,\r\n      nickname2: '',\r\n      notifications2: true,\r\n    });\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}