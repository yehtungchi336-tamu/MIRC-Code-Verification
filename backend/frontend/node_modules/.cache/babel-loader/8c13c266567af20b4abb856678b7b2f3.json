{"ast":null,"code":"/*!\n * FilePond 4.25.1\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = global || self, factory(global.FilePond = {}));\n})(this, function (exports) {\n  'use strict';\n\n  var isNode = function isNode(value) {\n    return value instanceof HTMLElement;\n  };\n  var createStore = function createStore(initialState) {\n    var queries = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var actions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    // internal state\n    var state = Object.assign({}, initialState);\n\n    // contains all actions for next frame, is clear when actions are requested\n    var actionQueue = [];\n    var dispatchQueue = [];\n\n    // returns a duplicate of the current state\n    var getState = function getState() {\n      return Object.assign({}, state);\n    };\n\n    // returns a duplicate of the actions array and clears the actions array\n    var processActionQueue = function processActionQueue() {\n      // create copy of actions queue\n      var queue = [].concat(actionQueue);\n\n      // clear actions queue (we don't want no double actions)\n      actionQueue.length = 0;\n      return queue;\n    };\n\n    // processes actions that might block the main UI thread\n    var processDispatchQueue = function processDispatchQueue() {\n      // create copy of actions queue\n      var queue = [].concat(dispatchQueue);\n\n      // clear actions queue (we don't want no double actions)\n      dispatchQueue.length = 0;\n\n      // now dispatch these actions\n      queue.forEach(function (_ref) {\n        var type = _ref.type,\n          data = _ref.data;\n        dispatch(type, data);\n      });\n    };\n\n    // adds a new action, calls its handler and\n    var dispatch = function dispatch(type, data, isBlocking) {\n      // is blocking action (should never block if document is hidden)\n      if (isBlocking && !document.hidden) {\n        dispatchQueue.push({\n          type: type,\n          data: data\n        });\n        return;\n      }\n\n      // if this action has a handler, handle the action\n      if (actionHandlers[type]) {\n        actionHandlers[type](data);\n      }\n\n      // now add action\n      actionQueue.push({\n        type: type,\n        data: data\n      });\n    };\n    var query = function query(str) {\n      var _queryHandles;\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n      return queryHandles[str] ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args) : null;\n    };\n    var api = {\n      getState: getState,\n      processActionQueue: processActionQueue,\n      processDispatchQueue: processDispatchQueue,\n      dispatch: dispatch,\n      query: query\n    };\n    var queryHandles = {};\n    queries.forEach(function (query) {\n      queryHandles = Object.assign({}, query(state), {}, queryHandles);\n    });\n    var actionHandlers = {};\n    actions.forEach(function (action) {\n      actionHandlers = Object.assign({}, action(dispatch, query, state), {}, actionHandlers);\n    });\n    return api;\n  };\n  var defineProperty = function defineProperty(obj, property, definition) {\n    if (typeof definition === 'function') {\n      obj[property] = definition;\n      return;\n    }\n    Object.defineProperty(obj, property, Object.assign({}, definition));\n  };\n  var forin = function forin(obj, cb) {\n    for (var key in obj) {\n      if (!obj.hasOwnProperty(key)) {\n        continue;\n      }\n      cb(key, obj[key]);\n    }\n  };\n  var createObject = function createObject(definition) {\n    var obj = {};\n    forin(definition, function (property) {\n      defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n  };\n  var attr = function attr(node, name) {\n    var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    if (value === null) {\n      return node.getAttribute(name) || node.hasAttribute(name);\n    }\n    node.setAttribute(name, value);\n  };\n  var ns = 'http://www.w3.org/2000/svg';\n  var svgElements = ['svg', 'path']; // only svg elements used\n\n  var isSVGElement = function isSVGElement(tag) {\n    return svgElements.includes(tag);\n  };\n  var createElement = function createElement(tag, className) {\n    var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    if (typeof className === 'object') {\n      attributes = className;\n      className = null;\n    }\n    var element = isSVGElement(tag) ? document.createElementNS(ns, tag) : document.createElement(tag);\n    if (className) {\n      if (isSVGElement(tag)) {\n        attr(element, 'class', className);\n      } else {\n        element.className = className;\n      }\n    }\n    forin(attributes, function (name, value) {\n      attr(element, name, value);\n    });\n    return element;\n  };\n  var appendChild = function appendChild(parent) {\n    return function (child, index) {\n      if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n      } else {\n        parent.appendChild(child);\n      }\n    };\n  };\n  var appendChildView = function appendChildView(parent, childViews) {\n    return function (view, index) {\n      if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n      } else {\n        childViews.push(view);\n      }\n      return view;\n    };\n  };\n  var removeChildView = function removeChildView(parent, childViews) {\n    return function (view) {\n      // remove from child views\n      childViews.splice(childViews.indexOf(view), 1);\n\n      // remove the element\n      if (view.element.parentNode) {\n        parent.removeChild(view.element);\n      }\n      return view;\n    };\n  };\n  var IS_BROWSER = function () {\n    return typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  }();\n  var isBrowser = function isBrowser() {\n    return IS_BROWSER;\n  };\n  var testElement = isBrowser() ? createElement('svg') : {};\n  var getChildCount = 'children' in testElement ? function (el) {\n    return el.children.length;\n  } : function (el) {\n    return el.childNodes.length;\n  };\n  var getViewRect = function getViewRect(elementRect, childViews, offset, scale) {\n    var left = offset[0] || elementRect.left;\n    var top = offset[1] || elementRect.top;\n    var right = left + elementRect.width;\n    var bottom = top + elementRect.height * (scale[1] || 1);\n    var rect = {\n      // the rectangle of the element itself\n      element: Object.assign({}, elementRect),\n      // the rectangle of the element expanded to contain its children, does not include any margins\n      inner: {\n        left: elementRect.left,\n        top: elementRect.top,\n        right: elementRect.right,\n        bottom: elementRect.bottom\n      },\n      // the rectangle of the element expanded to contain its children including own margin and child margins\n      // margins will be added after we've recalculated the size\n      outer: {\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      }\n    };\n\n    // expand rect to fit all child rectangles\n    childViews.filter(function (childView) {\n      return !childView.isRectIgnored();\n    }).map(function (childView) {\n      return childView.rect;\n    }).forEach(function (childViewRect) {\n      expandRect(rect.inner, Object.assign({}, childViewRect.inner));\n      expandRect(rect.outer, Object.assign({}, childViewRect.outer));\n    });\n\n    // calculate inner width and height\n    calculateRectSize(rect.inner);\n\n    // append additional margin (top and left margins are included in top and left automatically)\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight;\n\n    // calculate outer width and height\n    calculateRectSize(rect.outer);\n    return rect;\n  };\n  var expandRect = function expandRect(parent, child) {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n    if (child.bottom > parent.bottom) {\n      parent.bottom = child.bottom;\n    }\n    if (child.right > parent.right) {\n      parent.right = child.right;\n    }\n  };\n  var calculateRectSize = function calculateRectSize(rect) {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n  };\n  var isNumber = function isNumber(value) {\n    return typeof value === 'number';\n  };\n\n  /**\n   * Determines if position is at destination\n   * @param position\n   * @param destination\n   * @param velocity\n   * @param errorMargin\n   * @returns {boolean}\n   */\n  var thereYet = function thereYet(position, destination, velocity) {\n    var errorMargin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;\n    return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;\n  };\n\n  /**\n   * Spring animation\n   */\n  var spring =\n  // default options\n  function spring()\n  // method definition\n  {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$stiffness = _ref.stiffness,\n      stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,\n      _ref$damping = _ref.damping,\n      damping = _ref$damping === void 0 ? 0.75 : _ref$damping,\n      _ref$mass = _ref.mass,\n      mass = _ref$mass === void 0 ? 10 : _ref$mass;\n    var target = null;\n    var position = null;\n    var velocity = 0;\n    var resting = false;\n\n    // updates spring state\n    var interpolate = function interpolate(ts, skipToEndState) {\n      // in rest, don't animate\n      if (resting) return;\n\n      // need at least a target or position to do springy things\n      if (!(isNumber(target) && isNumber(position))) {\n        resting = true;\n        velocity = 0;\n        return;\n      }\n\n      // calculate spring force\n      var f = -(position - target) * stiffness;\n\n      // update velocity by adding force based on mass\n      velocity += f / mass;\n\n      // update position by adding velocity\n      position += velocity;\n\n      // slow down based on amount of damping\n      velocity *= damping;\n\n      // we've arrived if we're near target and our velocity is near zero\n      if (thereYet(position, target, velocity) || skipToEndState) {\n        position = target;\n        velocity = 0;\n        resting = true;\n\n        // we done\n        api.onupdate(position);\n        api.oncomplete(position);\n      } else {\n        // progress update\n        api.onupdate(position);\n      }\n    };\n\n    /**\n     * Set new target value\n     * @param value\n     */\n    var setTarget = function setTarget(value) {\n      // if currently has no position, set target and position to this value\n      if (isNumber(value) && !isNumber(position)) {\n        position = value;\n      }\n\n      // next target value will not be animated to\n      if (target === null) {\n        target = value;\n        position = value;\n      }\n\n      // let start moving to target\n      target = value;\n\n      // already at target\n      if (position === target || typeof target === 'undefined') {\n        // now resting as target is current position, stop moving\n        resting = true;\n        velocity = 0;\n\n        // done!\n        api.onupdate(position);\n        api.oncomplete(position);\n        return;\n      }\n      resting = false;\n    };\n\n    // need 'api' to call onupdate callback\n    var api = createObject({\n      interpolate: interpolate,\n      target: {\n        set: setTarget,\n        get: function get() {\n          return target;\n        }\n      },\n      resting: {\n        get: function get() {\n          return resting;\n        }\n      },\n      onupdate: function onupdate(value) {},\n      oncomplete: function oncomplete(value) {}\n    });\n    return api;\n  };\n  var easeLinear = function easeLinear(t) {\n    return t;\n  };\n  var easeInOutQuad = function easeInOutQuad(t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n  };\n  var tween =\n  // default values\n  function tween()\n  // method definition\n  {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$duration = _ref.duration,\n      duration = _ref$duration === void 0 ? 500 : _ref$duration,\n      _ref$easing = _ref.easing,\n      easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,\n      _ref$delay = _ref.delay,\n      delay = _ref$delay === void 0 ? 0 : _ref$delay;\n    var start = null;\n    var t;\n    var p;\n    var resting = true;\n    var reverse = false;\n    var target = null;\n    var interpolate = function interpolate(ts, skipToEndState) {\n      if (resting || target === null) return;\n      if (start === null) {\n        start = ts;\n      }\n      if (ts - start < delay) return;\n      t = ts - start - delay;\n      if (t >= duration || skipToEndState) {\n        t = 1;\n        p = reverse ? 0 : 1;\n        api.onupdate(p * target);\n        api.oncomplete(p * target);\n        resting = true;\n      } else {\n        p = t / duration;\n        api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n      }\n    };\n\n    // need 'api' to call onupdate callback\n    var api = createObject({\n      interpolate: interpolate,\n      target: {\n        get: function get() {\n          return reverse ? 0 : target;\n        },\n        set: function set(value) {\n          // is initial value\n          if (target === null) {\n            target = value;\n            api.onupdate(value);\n            api.oncomplete(value);\n            return;\n          }\n\n          // want to tween to a smaller value and have a current value\n          if (value < target) {\n            target = 1;\n            reverse = true;\n          } else {\n            // not tweening to a smaller value\n            reverse = false;\n            target = value;\n          }\n\n          // let's go!\n          resting = false;\n          start = null;\n        }\n      },\n      resting: {\n        get: function get() {\n          return resting;\n        }\n      },\n      onupdate: function onupdate(value) {},\n      oncomplete: function oncomplete(value) {}\n    });\n    return api;\n  };\n  var animator = {\n    spring: spring,\n    tween: tween\n  };\n\n  /*\n                       { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n                       { translation: { type: 'spring', ... }, ... }\n                       { translation: { x: { type: 'spring', ... } } }\n                      */\n  var createAnimator = function createAnimator(definition, category, property) {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    var def = definition[category] && typeof definition[category][property] === 'object' ? definition[category][property] : definition[category] || definition;\n    var type = typeof def === 'string' ? def : def.type;\n    var props = typeof def === 'object' ? Object.assign({}, def) : {};\n    return animator[type] ? animator[type](props) : null;\n  };\n  var addGetSet = function addGetSet(keys, obj, props) {\n    var overwrite = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(function (o) {\n      keys.forEach(function (key) {\n        var name = key;\n        var getter = function getter() {\n          return props[key];\n        };\n        var setter = function setter(value) {\n          return props[key] = value;\n        };\n        if (typeof key === 'object') {\n          name = key.key;\n          getter = key.getter || getter;\n          setter = key.setter || setter;\n        }\n        if (o[name] && !overwrite) {\n          return;\n        }\n        o[name] = {\n          get: getter,\n          set: setter\n        };\n      });\n    });\n  };\n\n  // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // setup animators\n\n  var animations = function animations(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI;\n    // initial properties\n    var initialProps = Object.assign({}, viewProps);\n\n    // list of all active animations\n    var animations = [];\n\n    // setup animators\n    forin(mixinConfig, function (property, animation) {\n      var animator = createAnimator(animation);\n      if (!animator) {\n        return;\n      }\n\n      // when the animator updates, update the view state value\n      animator.onupdate = function (value) {\n        viewProps[property] = value;\n      };\n\n      // set animator target\n      animator.target = initialProps[property];\n\n      // when value is set, set the animator target value\n      var prop = {\n        key: property,\n        setter: function setter(value) {\n          // if already at target, we done!\n          if (animator.target === value) {\n            return;\n          }\n          animator.target = value;\n        },\n        getter: function getter() {\n          return viewProps[property];\n        }\n      };\n\n      // add getters and setters\n      addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);\n\n      // add it to the list for easy updating from the _write method\n      animations.push(animator);\n    });\n\n    // expose internal write api\n    return {\n      write: function write(ts) {\n        var skipToEndState = document.hidden;\n        var resting = true;\n        animations.forEach(function (animation) {\n          if (!animation.resting) resting = false;\n          animation.interpolate(ts, skipToEndState);\n        });\n        return resting;\n      },\n      destroy: function destroy() {}\n    };\n  };\n  var addEvent = function addEvent(element) {\n    return function (type, fn) {\n      element.addEventListener(type, fn);\n    };\n  };\n  var removeEvent = function removeEvent(element) {\n    return function (type, fn) {\n      element.removeEventListener(type, fn);\n    };\n  };\n\n  // mixin\n  var listeners = function listeners(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      viewState = _ref.viewState,\n      view = _ref.view;\n    var events = [];\n    var add = addEvent(view.element);\n    var remove = removeEvent(view.element);\n    viewExternalAPI.on = function (type, fn) {\n      events.push({\n        type: type,\n        fn: fn\n      });\n      add(type, fn);\n    };\n    viewExternalAPI.off = function (type, fn) {\n      events.splice(events.findIndex(function (event) {\n        return event.type === type && event.fn === fn;\n      }), 1);\n      remove(type, fn);\n    };\n    return {\n      write: function write() {\n        // not busy\n        return true;\n      },\n      destroy: function destroy() {\n        events.forEach(function (event) {\n          remove(event.type, event.fn);\n        });\n      }\n    };\n  };\n\n  // add to external api and link to props\n\n  var apis = function apis(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewExternalAPI = _ref.viewExternalAPI;\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n  };\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n\n  // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // set initial state based on props in viewProps\n  // apply as transforms each frame\n\n  var defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0\n  };\n  var styles = function styles(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      view = _ref.view;\n    // initial props\n    var initialProps = Object.assign({}, viewProps);\n\n    // current props\n    var currentProps = {};\n\n    // we will add those properties to the external API and link them to the viewState\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);\n\n    // override rect on internal and external rect getter so it takes in account transforms\n    var getOffset = function getOffset() {\n      return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    };\n    var getScale = function getScale() {\n      return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    };\n    var getRect = function getRect() {\n      return view.rect ? getViewRect(view.rect, view.childViews, getOffset(), getScale()) : null;\n    };\n    viewInternalAPI.rect = {\n      get: getRect\n    };\n    viewExternalAPI.rect = {\n      get: getRect\n    };\n\n    // apply view props\n    mixinConfig.forEach(function (key) {\n      viewProps[key] = typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];\n    });\n\n    // expose api\n    return {\n      write: function write() {\n        // see if props have changed\n        if (!propsHaveChanged(currentProps, viewProps)) {\n          return;\n        }\n\n        // moves element to correct position on screen\n        applyStyles(view.element, viewProps);\n\n        // store new transforms\n        Object.assign(currentProps, Object.assign({}, viewProps));\n\n        // no longer busy\n        return true;\n      },\n      destroy: function destroy() {}\n    };\n  };\n  var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n      return true;\n    }\n\n    // lets analyze the individual props\n    for (var prop in newProps) {\n      if (newProps[prop] !== currentProps[prop]) {\n        return true;\n      }\n    }\n    return false;\n  };\n  var applyStyles = function applyStyles(element, _ref2) {\n    var opacity = _ref2.opacity,\n      perspective = _ref2.perspective,\n      translateX = _ref2.translateX,\n      translateY = _ref2.translateY,\n      scaleX = _ref2.scaleX,\n      scaleY = _ref2.scaleY,\n      rotateX = _ref2.rotateX,\n      rotateY = _ref2.rotateY,\n      rotateZ = _ref2.rotateZ,\n      originX = _ref2.originX,\n      originY = _ref2.originY,\n      width = _ref2.width,\n      height = _ref2.height;\n    var transforms = '';\n    var styles = '';\n\n    // handle transform origin\n    if (isDefined(originX) || isDefined(originY)) {\n      styles += 'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';\n    }\n\n    // transform order is relevant\n    // 0. perspective\n    if (isDefined(perspective)) {\n      transforms += 'perspective(' + perspective + 'px) ';\n    }\n\n    // 1. translate\n    if (isDefined(translateX) || isDefined(translateY)) {\n      transforms += 'translate3d(' + (translateX || 0) + 'px, ' + (translateY || 0) + 'px, 0) ';\n    }\n\n    // 2. scale\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n      transforms += 'scale3d(' + (isDefined(scaleX) ? scaleX : 1) + ', ' + (isDefined(scaleY) ? scaleY : 1) + ', 1) ';\n    }\n\n    // 3. rotate\n    if (isDefined(rotateZ)) {\n      transforms += 'rotateZ(' + rotateZ + 'rad) ';\n    }\n    if (isDefined(rotateX)) {\n      transforms += 'rotateX(' + rotateX + 'rad) ';\n    }\n    if (isDefined(rotateY)) {\n      transforms += 'rotateY(' + rotateY + 'rad) ';\n    }\n\n    // add transforms\n    if (transforms.length) {\n      styles += 'transform:' + transforms + ';';\n    }\n\n    // add opacity\n    if (isDefined(opacity)) {\n      styles += 'opacity:' + opacity + ';';\n\n      // if we reach zero, we make the element inaccessible\n      if (opacity === 0) {\n        styles += 'visibility:hidden;';\n      }\n\n      // if we're below 100% opacity this element can't be clicked\n      if (opacity < 1) {\n        styles += 'pointer-events:none;';\n      }\n    }\n\n    // add height\n    if (isDefined(height)) {\n      styles += 'height:' + height + 'px;';\n    }\n\n    // add width\n    if (isDefined(width)) {\n      styles += 'width:' + width + 'px;';\n    }\n\n    // apply styles\n    var elementCurrentStyle = element.elementCurrentStyle || '';\n\n    // if new styles does not match current styles, lets update!\n    if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {\n      element.style.cssText = styles;\n      // store current styles so we can compare them to new styles later on\n      // _not_ getting the style value is faster\n      element.elementCurrentStyle = styles;\n    }\n  };\n  var Mixins = {\n    styles: styles,\n    listeners: listeners,\n    animations: animations,\n    apis: apis\n  };\n  var updateRect = function updateRect() {\n    var rect = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var element = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var style = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    if (!element.layoutCalculated) {\n      rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n      rect.marginTop = parseInt(style.marginTop, 10) || 0;\n      rect.marginRight = parseInt(style.marginRight, 10) || 0;\n      rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n      rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n      element.layoutCalculated = true;\n    }\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n    rect.scrollTop = element.scrollTop;\n    rect.hidden = element.offsetParent === null;\n    return rect;\n  };\n  var createView =\n  // default view definition\n  function createView() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$tag = _ref.tag,\n      tag = _ref$tag === void 0 ? 'div' : _ref$tag,\n      _ref$name = _ref.name,\n      name = _ref$name === void 0 ? null : _ref$name,\n      _ref$attributes = _ref.attributes,\n      attributes = _ref$attributes === void 0 ? {} : _ref$attributes,\n      _ref$read = _ref.read,\n      read = _ref$read === void 0 ? function () {} : _ref$read,\n      _ref$write = _ref.write,\n      write = _ref$write === void 0 ? function () {} : _ref$write,\n      _ref$create = _ref.create,\n      create = _ref$create === void 0 ? function () {} : _ref$create,\n      _ref$destroy = _ref.destroy,\n      destroy = _ref$destroy === void 0 ? function () {} : _ref$destroy,\n      _ref$filterFrameActio = _ref.filterFrameActionsForChild,\n      filterFrameActionsForChild = _ref$filterFrameActio === void 0 ? function (child, actions) {\n        return actions;\n      } : _ref$filterFrameActio,\n      _ref$didCreateView = _ref.didCreateView,\n      didCreateView = _ref$didCreateView === void 0 ? function () {} : _ref$didCreateView,\n      _ref$didWriteView = _ref.didWriteView,\n      didWriteView = _ref$didWriteView === void 0 ? function () {} : _ref$didWriteView,\n      _ref$ignoreRect = _ref.ignoreRect,\n      ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,\n      _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,\n      ignoreRectUpdate = _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,\n      _ref$mixins = _ref.mixins,\n      mixins = _ref$mixins === void 0 ? [] : _ref$mixins;\n    return function (\n    // each view requires reference to store\n    store) {\n      var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      // root element should not be changed\n      var element = createElement(tag, 'filepond--' + name, attributes);\n\n      // style reference should also not be changed\n      var style = window.getComputedStyle(element, null);\n\n      // element rectangle\n      var rect = updateRect();\n      var frameRect = null;\n\n      // rest state\n      var isResting = false;\n\n      // pretty self explanatory\n      var childViews = [];\n\n      // loaded mixins\n      var activeMixins = [];\n\n      // references to created children\n      var ref = {};\n\n      // state used for each instance\n      var state = {};\n\n      // list of writers that will be called to update this view\n      var writers = [write // default writer\n      ];\n\n      var readers = [read // default reader\n      ];\n\n      var destroyers = [destroy // default destroy\n      ];\n\n      // core view methods\n      var getElement = function getElement() {\n        return element;\n      };\n      var getChildViews = function getChildViews() {\n        return childViews.concat();\n      };\n      var getReference = function getReference() {\n        return ref;\n      };\n      var createChildView = function createChildView(store) {\n        return function (view, props) {\n          return view(store, props);\n        };\n      };\n      var getRect = function getRect() {\n        if (frameRect) {\n          return frameRect;\n        }\n        frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n        return frameRect;\n      };\n      var getStyle = function getStyle() {\n        return style;\n      };\n\n      /**\n       * Read data from DOM\n       * @private\n       */\n      var _read = function _read() {\n        frameRect = null;\n\n        // read child views\n        childViews.forEach(function (child) {\n          return child._read();\n        });\n        var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n        if (shouldUpdate) {\n          updateRect(rect, element, style);\n        }\n\n        // readers\n        var api = {\n          root: internalAPI,\n          props: props,\n          rect: rect\n        };\n        readers.forEach(function (reader) {\n          return reader(api);\n        });\n      };\n\n      /**\n       * Write data to DOM\n       * @private\n       */\n      var _write = function _write(ts, frameActions, shouldOptimize) {\n        // if no actions, we assume that the view is resting\n        var resting = frameActions.length === 0;\n\n        // writers\n        writers.forEach(function (writer) {\n          var writerResting = writer({\n            props: props,\n            root: internalAPI,\n            actions: frameActions,\n            timestamp: ts,\n            shouldOptimize: shouldOptimize\n          });\n          if (writerResting === false) {\n            resting = false;\n          }\n        });\n\n        // run mixins\n        activeMixins.forEach(function (mixin) {\n          // if one of the mixins is still busy after write operation, we are not resting\n          var mixinResting = mixin.write(ts);\n          if (mixinResting === false) {\n            resting = false;\n          }\n        });\n\n        // updates child views that are currently attached to the DOM\n        childViews.filter(function (child) {\n          return !!child.element.parentNode;\n        }).forEach(function (child) {\n          // if a child view is not resting, we are not resting\n          var childResting = child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize);\n          if (!childResting) {\n            resting = false;\n          }\n        });\n\n        // append new elements to DOM and update those\n        childViews\n        //.filter(child => !child.element.parentNode)\n        .forEach(function (child, index) {\n          // skip\n          if (child.element.parentNode) {\n            return;\n          }\n\n          // append to DOM\n          internalAPI.appendChild(child.element, index);\n\n          // call read (need to know the size of these elements)\n          child._read();\n\n          // re-call write\n          child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize);\n\n          // we just added somthing to the dom, no rest\n          resting = false;\n        });\n\n        // update resting state\n        isResting = resting;\n        didWriteView({\n          props: props,\n          root: internalAPI,\n          actions: frameActions,\n          timestamp: ts\n        });\n\n        // let parent know if we are resting\n        return resting;\n      };\n      var _destroy = function _destroy() {\n        activeMixins.forEach(function (mixin) {\n          return mixin.destroy();\n        });\n        destroyers.forEach(function (destroyer) {\n          destroyer({\n            root: internalAPI,\n            props: props\n          });\n        });\n        childViews.forEach(function (child) {\n          return child._destroy();\n        });\n      };\n\n      // sharedAPI\n      var sharedAPIDefinition = {\n        element: {\n          get: getElement\n        },\n        style: {\n          get: getStyle\n        },\n        childViews: {\n          get: getChildViews\n        }\n      };\n\n      // private API definition\n      var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n        rect: {\n          get: getRect\n        },\n        // access to custom children references\n        ref: {\n          get: getReference\n        },\n        // dom modifiers\n        is: function is(needle) {\n          return name === needle;\n        },\n        appendChild: appendChild(element),\n        createChildView: createChildView(store),\n        linkView: function linkView(view) {\n          childViews.push(view);\n          return view;\n        },\n        unlinkView: function unlinkView(view) {\n          childViews.splice(childViews.indexOf(view), 1);\n        },\n        appendChildView: appendChildView(element, childViews),\n        removeChildView: removeChildView(element, childViews),\n        registerWriter: function registerWriter(writer) {\n          return writers.push(writer);\n        },\n        registerReader: function registerReader(reader) {\n          return readers.push(reader);\n        },\n        registerDestroyer: function registerDestroyer(destroyer) {\n          return destroyers.push(destroyer);\n        },\n        invalidateLayout: function invalidateLayout() {\n          return element.layoutCalculated = false;\n        },\n        // access to data store\n        dispatch: store.dispatch,\n        query: store.query\n      });\n\n      // public view API methods\n      var externalAPIDefinition = {\n        element: {\n          get: getElement\n        },\n        childViews: {\n          get: getChildViews\n        },\n        rect: {\n          get: getRect\n        },\n        resting: {\n          get: function get() {\n            return isResting;\n          }\n        },\n        isRectIgnored: function isRectIgnored() {\n          return ignoreRect;\n        },\n        _read: _read,\n        _write: _write,\n        _destroy: _destroy\n      };\n\n      // mixin API methods\n      var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n        rect: {\n          get: function get() {\n            return rect;\n          }\n        }\n      });\n\n      // add mixin functionality\n      Object.keys(mixins).sort(function (a, b) {\n        // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n        if (a === 'styles') {\n          return 1;\n        } else if (b === 'styles') {\n          return -1;\n        }\n        return 0;\n      }).forEach(function (key) {\n        var mixinAPI = Mixins[key]({\n          mixinConfig: mixins[key],\n          viewProps: props,\n          viewState: state,\n          viewInternalAPI: internalAPIDefinition,\n          viewExternalAPI: externalAPIDefinition,\n          view: createObject(mixinAPIDefinition)\n        });\n        if (mixinAPI) {\n          activeMixins.push(mixinAPI);\n        }\n      });\n\n      // construct private api\n      var internalAPI = createObject(internalAPIDefinition);\n\n      // create the view\n      create({\n        root: internalAPI,\n        props: props\n      });\n\n      // append created child views to root node\n      var childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\n      childViews.forEach(function (child, index) {\n        internalAPI.appendChild(child.element, childCount + index);\n      });\n\n      // call did create\n      didCreateView(internalAPI);\n\n      // expose public api\n      return createObject(externalAPIDefinition);\n    };\n  };\n  var createPainter = function createPainter(read, write) {\n    var fps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;\n    var name = '__framePainter';\n\n    // set global painter\n    if (window[name]) {\n      window[name].readers.push(read);\n      window[name].writers.push(write);\n      return;\n    }\n    window[name] = {\n      readers: [read],\n      writers: [write]\n    };\n    var painter = window[name];\n    var interval = 1000 / fps;\n    var last = null;\n    var id = null;\n    var requestTick = null;\n    var cancelTick = null;\n    var setTimerType = function setTimerType() {\n      if (document.hidden) {\n        requestTick = function requestTick() {\n          return window.setTimeout(function () {\n            return tick(performance.now());\n          }, interval);\n        };\n        cancelTick = function cancelTick() {\n          return window.clearTimeout(id);\n        };\n      } else {\n        requestTick = function requestTick() {\n          return window.requestAnimationFrame(tick);\n        };\n        cancelTick = function cancelTick() {\n          return window.cancelAnimationFrame(id);\n        };\n      }\n    };\n    document.addEventListener('visibilitychange', function () {\n      if (cancelTick) cancelTick();\n      setTimerType();\n      tick(performance.now());\n    });\n    var tick = function tick(ts) {\n      // queue next tick\n      id = requestTick(tick);\n\n      // limit fps\n      if (!last) {\n        last = ts;\n      }\n      var delta = ts - last;\n      if (delta <= interval) {\n        // skip frame\n        return;\n      }\n\n      // align next frame\n      last = ts - delta % interval;\n\n      // update view\n      painter.readers.forEach(function (read) {\n        return read();\n      });\n      painter.writers.forEach(function (write) {\n        return write(ts);\n      });\n    };\n    setTimerType();\n    tick(performance.now());\n    return {\n      pause: function pause() {\n        cancelTick(id);\n      }\n    };\n  };\n  var createRoute = function createRoute(routes, fn) {\n    return function (_ref) {\n      var root = _ref.root,\n        props = _ref.props,\n        _ref$actions = _ref.actions,\n        actions = _ref$actions === void 0 ? [] : _ref$actions,\n        timestamp = _ref.timestamp,\n        shouldOptimize = _ref.shouldOptimize;\n      actions.filter(function (action) {\n        return routes[action.type];\n      }).forEach(function (action) {\n        return routes[action.type]({\n          root: root,\n          props: props,\n          action: action.data,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      });\n      if (fn) {\n        fn({\n          root: root,\n          props: props,\n          actions: actions,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      }\n    };\n  };\n  var insertBefore = function insertBefore(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode);\n  };\n  var insertAfter = function insertAfter(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n  };\n  var isArray = function isArray(value) {\n    return Array.isArray(value);\n  };\n  var isEmpty = function isEmpty(value) {\n    return value == null;\n  };\n  var trim = function trim(str) {\n    return str.trim();\n  };\n  var toString = function toString(value) {\n    return '' + value;\n  };\n  var toArray = function toArray(value) {\n    var splitter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n    if (isEmpty(value)) {\n      return [];\n    }\n    if (isArray(value)) {\n      return value;\n    }\n    return toString(value).split(splitter).map(trim).filter(function (str) {\n      return str.length;\n    });\n  };\n  var isBoolean = function isBoolean(value) {\n    return typeof value === 'boolean';\n  };\n  var toBoolean = function toBoolean(value) {\n    return isBoolean(value) ? value : value === 'true';\n  };\n  var isString = function isString(value) {\n    return typeof value === 'string';\n  };\n  var toNumber = function toNumber(value) {\n    return isNumber(value) ? value : isString(value) ? toString(value).replace(/[a-z]+/gi, '') : 0;\n  };\n  var toInt = function toInt(value) {\n    return parseInt(toNumber(value), 10);\n  };\n  var toFloat = function toFloat(value) {\n    return parseFloat(toNumber(value));\n  };\n  var isInt = function isInt(value) {\n    return isNumber(value) && isFinite(value) && Math.floor(value) === value;\n  };\n  var toBytes = function toBytes(value) {\n    var base = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    // is in bytes\n    if (isInt(value)) {\n      return value;\n    }\n\n    // is natural file size\n    var naturalFileSize = toString(value).trim();\n\n    // if is value in megabytes\n    if (/MB$/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n      return toInt(naturalFileSize) * base * base;\n    }\n\n    // if is value in kilobytes\n    if (/KB/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n      return toInt(naturalFileSize) * base;\n    }\n    return toInt(naturalFileSize);\n  };\n  var isFunction = function isFunction(value) {\n    return typeof value === 'function';\n  };\n  var toFunctionReference = function toFunctionReference(string) {\n    var ref = self;\n    var levels = string.split('.');\n    var level = null;\n    while (level = levels.shift()) {\n      ref = ref[level];\n      if (!ref) {\n        return null;\n      }\n    }\n    return ref;\n  };\n  var methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET'\n  };\n  var createServerAPI = function createServerAPI(outline) {\n    var api = {};\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n    forin(methods, function (key) {\n      api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);\n    });\n\n    // special treatment for remove\n    api.remove = outline.remove || null;\n\n    // remove generic headers from api object\n    delete api.headers;\n    return api;\n  };\n  var createAction = function createAction(name, outline, method, timeout, headers) {\n    // is explicitely set to null so disable\n    if (outline === null) {\n      return null;\n    }\n\n    // if is custom function, done! Dev handles everything.\n    if (typeof outline === 'function') {\n      return outline;\n    }\n\n    // build action object\n    var action = {\n      url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',\n      method: method,\n      headers: headers,\n      withCredentials: false,\n      timeout: timeout,\n      onload: null,\n      ondata: null,\n      onerror: null\n    };\n\n    // is a single url\n    if (isString(outline)) {\n      action.url = outline;\n      return action;\n    }\n\n    // overwrite\n    Object.assign(action, outline);\n\n    // see if should reformat headers;\n    if (isString(action.headers)) {\n      var parts = action.headers.split(/:(.+)/);\n      action.headers = {\n        header: parts[0],\n        value: parts[1]\n      };\n    }\n\n    // if is bool withCredentials\n    action.withCredentials = toBoolean(action.withCredentials);\n    return action;\n  };\n  var toServerAPI = function toServerAPI(value) {\n    return createServerAPI(value);\n  };\n  var isNull = function isNull(value) {\n    return value === null;\n  };\n  var isObject = function isObject(value) {\n    return typeof value === 'object' && value !== null;\n  };\n  var isAPI = function isAPI(value) {\n    return isObject(value) && isString(value.url) && isObject(value.process) && isObject(value.revert) && isObject(value.restore) && isObject(value.fetch);\n  };\n  var getType = function getType(value) {\n    if (isArray(value)) {\n      return 'array';\n    }\n    if (isNull(value)) {\n      return 'null';\n    }\n    if (isInt(value)) {\n      return 'int';\n    }\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n      return 'bytes';\n    }\n    if (isAPI(value)) {\n      return 'api';\n    }\n    return typeof value;\n  };\n  var replaceSingleQuotes = function replaceSingleQuotes(str) {\n    return str.replace(/{\\s*'/g, '{\"').replace(/'\\s*}/g, '\"}').replace(/'\\s*:/g, '\":').replace(/:\\s*'/g, ':\"').replace(/,\\s*'/g, ',\"').replace(/'\\s*,/g, '\",');\n  };\n  var conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: function int(value) {\n      return getType(value) === 'bytes' ? toBytes(value) : toInt(value);\n    },\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: function string(value) {\n      return isFunction(value) ? value : toString(value);\n    },\n    function: function _function(value) {\n      return toFunctionReference(value);\n    },\n    serverapi: toServerAPI,\n    object: function object(value) {\n      try {\n        return JSON.parse(replaceSingleQuotes(value));\n      } catch (e) {\n        return null;\n      }\n    }\n  };\n  var convertTo = function convertTo(value, type) {\n    return conversionTable[type](value);\n  };\n  var getValueByType = function getValueByType(newValue, defaultValue, valueType) {\n    // can always assign default value\n    if (newValue === defaultValue) {\n      return newValue;\n    }\n\n    // get the type of the new value\n    var newValueType = getType(newValue);\n\n    // is valid type?\n    if (newValueType !== valueType) {\n      // is string input, let's attempt to convert\n      var convertedValue = convertTo(newValue, valueType);\n\n      // what is the type now\n      newValueType = getType(convertedValue);\n\n      // no valid conversions found\n      if (convertedValue === null) {\n        throw 'Trying to assign value with incorrect type to \"' + option + '\", allowed type: \"' + valueType + '\"';\n      } else {\n        newValue = convertedValue;\n      }\n    }\n\n    // assign new value\n    return newValue;\n  };\n  var createOption = function createOption(defaultValue, valueType) {\n    var currentValue = defaultValue;\n    return {\n      enumerable: true,\n      get: function get() {\n        return currentValue;\n      },\n      set: function set(newValue) {\n        currentValue = getValueByType(newValue, defaultValue, valueType);\n      }\n    };\n  };\n  var createOptions = function createOptions(options) {\n    var obj = {};\n    forin(options, function (prop) {\n      var optionDefinition = options[prop];\n      obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n  };\n  var createInitialState = function createInitialState(options) {\n    return {\n      // model\n      items: [],\n      // timeout used for calling update items\n      listUpdateTimeout: null,\n      // timeout used for stacking metadata updates\n      itemUpdateTimeout: null,\n      // queue of items waiting to be processed\n      processingQueue: [],\n      // options\n      options: createOptions(options)\n    };\n  };\n  var fromCamels = function fromCamels(string) {\n    var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.split(/(?=[A-Z])/).map(function (part) {\n      return part.toLowerCase();\n    }).join(separator);\n  };\n  var createOptionAPI = function createOptionAPI(store, options) {\n    var obj = {};\n    forin(options, function (key) {\n      obj[key] = {\n        get: function get() {\n          return store.getState().options[key];\n        },\n        set: function set(value) {\n          store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        }\n      };\n    });\n    return obj;\n  };\n  var createOptionActions = function createOptionActions(options) {\n    return function (dispatch, query, state) {\n      var obj = {};\n      forin(options, function (key) {\n        var name = fromCamels(key, '_').toUpperCase();\n        obj['SET_' + name] = function (action) {\n          try {\n            state.options[key] = action.value;\n          } catch (e) {} // nope, failed\n\n          // we successfully set the value of this option\n          dispatch('DID_SET_' + name, {\n            value: state.options[key]\n          });\n        };\n      });\n      return obj;\n    };\n  };\n  var createOptionQueries = function createOptionQueries(options) {\n    return function (state) {\n      var obj = {};\n      forin(options, function (key) {\n        obj['GET_' + fromCamels(key, '_').toUpperCase()] = function (action) {\n          return state.options[key];\n        };\n      });\n      return obj;\n    };\n  };\n  var InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5\n  };\n  var getUniqueId = function getUniqueId() {\n    return Math.random().toString(36).substr(2, 9);\n  };\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;\n      };\n    }\n    return _typeof(obj);\n  }\n  var REACT_ELEMENT_TYPE;\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol['for'] && Symbol['for']('react.element') || 0xeac7;\n    }\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n      props.children = childArray;\n    }\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n  function _asyncIterator(iterable) {\n    var method;\n    if (typeof Symbol !== 'undefined') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n    throw new TypeError('Object is not async iterable');\n  }\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n  function _AsyncGenerator(gen) {\n    var front, back;\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n          if (wrappedAwait) {\n            resume('next', arg);\n            return;\n          }\n          settle(result.done ? 'return' : 'normal', arg);\n        }, function (err) {\n          resume('throw', err);\n        });\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n        case 'throw':\n          front.reject(value);\n          break;\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n      front = front.next;\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n    this._invoke = send;\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n  _AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke('next', arg);\n  };\n  _AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke('throw', arg);\n  };\n  _AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke('return', arg);\n  };\n  function _wrapAsyncGenerator(fn) {\n    return function () {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function (resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function () {\n        return this;\n      };\n    }\n    iter.next = function (value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n      return pump('next', value);\n    };\n    if (typeof inner.throw === 'function') {\n      iter.throw = function (value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n        return pump('throw', value);\n      };\n    }\n    if (typeof inner.return === 'function') {\n      iter.return = function (value) {\n        return pump('return', value);\n      };\n    }\n    return iter;\n  }\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n  function _asyncToGenerator(fn) {\n    return function () {\n      var self = this,\n        args = arguments;\n      return new Promise(function (resolve, reject) {\n        var gen = fn.apply(self, args);\n        function _next(value) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n        }\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n        _next(undefined);\n      });\n    };\n  }\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n    return obj;\n  }\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n    return obj;\n  }\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  function _extends() {\n    _extends = Object.assign || function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n      return target;\n    };\n    return _extends.apply(this, arguments);\n  }\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n        }));\n      }\n      ownKeys.forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n    return target;\n  }\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n    return keys;\n  }\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      if (i % 2) {\n        ownKeys(source, true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(source).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n    return target;\n  }\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n    return _setPrototypeOf(o, p);\n  }\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n    return _construct.apply(null, arguments);\n  }\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n      if (typeof Class !== 'function') {\n        throw new TypeError('Super expression must either be null or a function');\n      }\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n        _cache.set(Class, Wrapper);\n      }\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n    return _wrapNativeSuper(Class);\n  }\n  function _instanceof(left, right) {\n    if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n      return !!right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n    return target;\n  }\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n    var key, i;\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n    return target;\n  }\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n    return self;\n  }\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n    return _assertThisInitialized(self);\n  }\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n    return object;\n  }\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n        return desc.value;\n      };\n    }\n    return _get(target, property, receiver || target);\n  }\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n        var desc;\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n        return true;\n      };\n    }\n    return set(target, property, value, receiver);\n  }\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n    return value;\n  }\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n    return Object.freeze(Object.defineProperties(strings, {\n      raw: {\n        value: Object.freeze(raw)\n      }\n    }));\n  }\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n    strings.raw = raw;\n    return strings;\n  }\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n  function _classNameTDZError(name) {\n    throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n  }\n  var _temporalUndefined = {};\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n  function _slicedToArrayLoose(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n  }\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n        arr2[i] = arr[i];\n      }\n      return arr2;\n    }\n  }\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === '[object Arguments]') return Array.from(iter);\n  }\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n      if (i && _arr.length === i) break;\n    }\n    return _arr;\n  }\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n  function _skipFirstGeneratorNext(fn) {\n    return function () {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n    return (hint === 'string' ? String : Number)(input);\n  }\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n    return typeof key === 'symbol' ? key : String(key);\n  }\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and set to use loose mode. ' + 'To use proposal-class-properties in spec mode with decorators, wait for ' + 'the next major version of decorators in stage 2.');\n  }\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer ? descriptor.initializer.call(context) : void 0\n    });\n  }\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function (key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n    desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n      return decorator(target, property, desc) || desc;\n    }, desc);\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n    return desc;\n  }\n  var id = 0;\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n    return receiver;\n  }\n  function _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = privateMap.get(receiver);\n    if (!descriptor) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n    return descriptor.value;\n  }\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    var descriptor = privateMap.get(receiver);\n    if (!descriptor) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n      descriptor.value = value;\n    }\n    return value;\n  }\n  function _classPrivateFieldDestructureSet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n    var descriptor = privateMap.get(receiver);\n    if (descriptor.set) {\n      if (!('__destrObj' in descriptor)) {\n        descriptor.__destrObj = {\n          set value(v) {\n            descriptor.set.call(receiver, v);\n          }\n        };\n      }\n      return descriptor.__destrObj;\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n      return descriptor;\n    }\n  }\n  function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    return descriptor.value;\n  }\n  function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n    descriptor.value = value;\n    return value;\n  }\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    return method;\n  }\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function _getDecoratorsApi() {\n      return api;\n    };\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function initializeInstanceElements(O, elements) {\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function initializeClassElements(F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            var placement = element.placement;\n            if (element.kind === kind && (placement === 'static' || placement === 'prototype')) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function defineClassElement(receiver, element) {\n        var descriptor = element.descriptor;\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function decorateClass(elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function (element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function (element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(element, placements);\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function addElementPlacement(element, placements, silent) {\n        var keys = placements[element.placement];\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n        keys.push(element.key);\n      },\n      decorateElement: function decorateElement(element, placements) {\n        var extras = [];\n        var finishers = [];\n        for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n          var newExtras = elementFinisherExtras.extras;\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n            extras.push.apply(extras, newExtras);\n          }\n        }\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function decorateConstructor(elements, decorators) {\n        var finishers = [];\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {\n                  throw new TypeError('Duplicated element (' + elements[j].key + ')');\n                }\n              }\n            }\n          }\n        }\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function fromElementDescriptor(element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function toElementDescriptors(elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function (elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n          this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function toElementDescriptor(elementObject) {\n        var kind = String(elementObject.kind);\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError('An element descriptor\\'s .kind property must be either \"method\" or' + ' \"field\", but a decorator created an element descriptor with' + ' .kind \"' + kind + '\"');\n        }\n        var key = _toPropertyKey(elementObject.key);\n        var placement = String(elementObject.placement);\n        if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n          throw new TypeError('An element descriptor\\'s .placement property must be one of \"static\",' + ' \"prototype\" or \"own\", but a decorator created an element descriptor' + ' with .placement \"' + placement + '\"');\n        }\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n        if (kind !== 'field') {\n          this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n        } else {\n          this.disallowProperty(descriptor, 'get', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'set', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'value', 'The property descriptor of a field descriptor');\n          element.initializer = elementObject.initializer;\n        }\n        return element;\n      },\n      toElementFinisherExtras: function toElementFinisherExtras(elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function fromClassDescriptor(elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function toClassDescriptor(obj) {\n        var kind = String(obj.kind);\n        if (kind !== 'class') {\n          throw new TypeError('A class descriptor\\'s .kind property must be \"class\", but a decorator' + ' created a class descriptor with .kind \"' + kind + '\"');\n        }\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function runClassFinishers(constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n            constructor = newConstructor;\n          }\n        }\n        return constructor;\n      },\n      disallowProperty: function disallowProperty(obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n        }\n      }\n    };\n    return api;\n  }\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n    var descriptor;\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n    var isSameElement = function isSameElement(other) {\n      return other.kind === 'method' && other.key === element.key && other.placement === element.placement;\n    };\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n      if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n        if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError('Duplicated methods (' + element.key + \") can't be decorated.\");\n          }\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\"Decorators can't be placed on different accessors with for \" + 'the same property (' + element.key + ').');\n            }\n            other.decorators = element.decorators;\n          }\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n    return newElements;\n  }\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n  function _isDataDescriptor(desc) {\n    return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n  }\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n    return value;\n  }\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n    return fn;\n  }\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function _wrapRegExp(re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n    var _RegExp = _wrapNativeSuper(RegExp);\n    var _super = RegExp.prototype;\n    var _groups = new WeakMap();\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n      _groups.set(_this, groups);\n      return _this;\n    }\n    _inherits(BabelRegExp, _RegExp);\n    BabelRegExp.prototype.exec = function (str) {\n      var result = _super.exec.call(this, str);\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n    BabelRegExp.prototype[Symbol.replace] = function (str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n        return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) {\n          return '$' + groups[name];\n        }));\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n        return _super[Symbol.replace].call(this, str, function () {\n          var args = [];\n          args.push.apply(args, arguments);\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n      return Object.keys(g).reduce(function (groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n    return _wrapRegExp.apply(this, arguments);\n  }\n  var arrayRemove = function arrayRemove(arr, index) {\n    return arr.splice(index, 1);\n  };\n  var run = function run(cb, sync) {\n    if (sync) {\n      cb();\n    } else if (document.hidden) {\n      Promise.resolve(1).then(cb);\n    } else {\n      setTimeout(cb, 0);\n    }\n  };\n  var on = function on() {\n    var listeners = [];\n    var off = function off(event, cb) {\n      arrayRemove(listeners, listeners.findIndex(function (listener) {\n        return listener.event === event && (listener.cb === cb || !cb);\n      }));\n    };\n    var _fire = function fire(event, args, sync) {\n      listeners.filter(function (listener) {\n        return listener.event === event;\n      }).map(function (listener) {\n        return listener.cb;\n      }).forEach(function (cb) {\n        return run(function () {\n          return cb.apply(void 0, _toConsumableArray(args));\n        }, sync);\n      });\n    };\n    return {\n      fireSync: function fireSync(event) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n        _fire(event, args, true);\n      },\n      fire: function fire(event) {\n        for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n          args[_key2 - 1] = arguments[_key2];\n        }\n        _fire(event, args, false);\n      },\n      on: function on(event, cb) {\n        listeners.push({\n          event: event,\n          cb: cb\n        });\n      },\n      onOnce: function onOnce(event, _cb) {\n        listeners.push({\n          event: event,\n          cb: function cb() {\n            off(event, _cb);\n            _cb.apply(void 0, arguments);\n          }\n        });\n      },\n      off: off\n    };\n  };\n  var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(src, target, excluded) {\n    Object.getOwnPropertyNames(src).filter(function (property) {\n      return !excluded.includes(property);\n    }).forEach(function (key) {\n      return Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(src, key));\n    });\n  };\n  var PRIVATE = ['fire', 'process', 'revert', 'load', 'on', 'off', 'onOnce', 'retryLoad', 'extend', 'archive', 'archived', 'release', 'released', 'requestProcessing', 'freeze'];\n  var createItemAPI = function createItemAPI(item) {\n    var api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n  };\n  var removeReleasedItems = function removeReleasedItems(items) {\n    items.forEach(function (item, index) {\n      if (item.released) {\n        arrayRemove(items, index);\n      }\n    });\n  };\n  var ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8\n  };\n  var FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3\n  };\n  var getNonNumeric = function getNonNumeric(str) {\n    return /[^0-9]+/.exec(str);\n  };\n  var getDecimalSeparator = function getDecimalSeparator() {\n    return getNonNumeric(1.1.toLocaleString())[0];\n  };\n  var getThousandsSeparator = function getThousandsSeparator() {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    var decimalSeparator = getDecimalSeparator();\n    var thousandsStringWithSeparator = 1000.0.toLocaleString();\n    var thousandsStringWithoutSeparator = 1000.0.toString();\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n      return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n    return decimalSeparator === '.' ? ',' : '.';\n  };\n  var Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex'\n  };\n\n  // all registered filters\n  var filters = [];\n\n  // loops over matching filters and passes options to each filter, returning the mapped results\n  var applyFilterChain = function applyFilterChain(key, value, utils) {\n    return new Promise(function (resolve, reject) {\n      // find matching filters for this key\n      var matchingFilters = filters.filter(function (f) {\n        return f.key === key;\n      }).map(function (f) {\n        return f.cb;\n      });\n\n      // resolve now\n      if (matchingFilters.length === 0) {\n        resolve(value);\n        return;\n      }\n\n      // first filter to kick things of\n      var initialFilter = matchingFilters.shift();\n\n      // chain filters\n      matchingFilters.reduce(\n      // loop over promises passing value to next promise\n      function (current, next) {\n        return current.then(function (value) {\n          return next(value, utils);\n        });\n      },\n      // call initial filter, will return a promise\n      initialFilter(value, utils)\n\n      // all executed\n      ).then(function (value) {\n        return resolve(value);\n      }).catch(function (error) {\n        return reject(error);\n      });\n    });\n  };\n  var applyFilters = function applyFilters(key, value, utils) {\n    return filters.filter(function (f) {\n      return f.key === key;\n    }).map(function (f) {\n      return f.cb(value, utils);\n    });\n  };\n\n  // adds a new filter to the list\n  var addFilter = function addFilter(key, cb) {\n    return filters.push({\n      key: key,\n      cb: cb\n    });\n  };\n  var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {\n    return Object.assign(defaultOptions, additionalOptions);\n  };\n  var getOptions = function getOptions() {\n    return Object.assign({}, defaultOptions);\n  };\n  var setOptions = function setOptions(opts) {\n    forin(opts, function (key, value) {\n      // key does not exist, so this option cannot be set\n      if (!defaultOptions[key]) {\n        return;\n      }\n      defaultOptions[key][0] = getValueByType(value, defaultOptions[key][0], defaultOptions[key][1]);\n    });\n  };\n\n  // default options on app\n  var defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n    // input field name to use\n    name: ['filepond', Type.STRING],\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n    // is the field required\n    required: [false, Type.BOOLEAN],\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n\n    // sync `acceptedFileTypes` property with `accept` attribute\n    allowSyncAcceptAttribute: [true, Type.BOOLEAN],\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN],\n    // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN],\n    // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN],\n    // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN],\n    // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN],\n    // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN],\n    // Allows user to revert file upload\n    allowRemove: [true, Type.BOOLEAN],\n    // Allow user to remove a file\n    allowProcess: [true, Type.BOOLEAN],\n    // Allows user to process a file, when set to false, this removes the file upload button\n    allowReorder: [false, Type.BOOLEAN],\n    // Allow reordering of files\n    allowDirectoriesOnly: [false, Type.BOOLEAN],\n    // Allow only selecting directories with browse (no support for filtering dnd at this point)\n\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN],\n    // Set to 'force' to require the file to be reverted before removal\n\n    // Input requirements\n    maxFiles: [null, Type.INT],\n    // Max number of files\n    checkValidity: [false, Type.BOOLEAN],\n    // Enables custom validity messages\n\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN],\n    // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING],\n    // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN],\n    // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN],\n    // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN],\n    // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN],\n    // Should upload files immediately on drop\n    maxParallelUploads: [2, Type.INT],\n    // Maximum files to upload in parallel\n\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN],\n    // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN],\n    // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT],\n    // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.Array],\n    // Amount of times to retry upload of a chunk when it fails\n\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n    // File size calculations, can set to 1024, this is only used for display, properties use file size base 1000\n    fileSizeBase: [1000, Type.INT],\n    // Labels and status messages\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING],\n    // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING],\n    // Default is locale separator\n\n    labelIdle: ['Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>', Type.STRING],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING],\n    // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING],\n    // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconProcess: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>', Type.STRING],\n    iconRetry: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconUndo: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconDone: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    oninitfile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n    onreorderfiles: [null, Type.FUNCTION],\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n    beforePrepareFile: [null, Type.FUNCTION],\n    // styles\n    stylePanelLayout: [null, Type.STRING],\n    // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING],\n    // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n    styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\n    // custom initial files array\n    files: [[], Type.ARRAY],\n    // show support by displaying credits\n    credits: [['https://pqina.nl/', 'Powered by PQINA'], Type.ARRAY]\n  };\n  var getItemByQuery = function getItemByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return items[0] || null;\n    }\n\n    // query is index\n    if (isInt(query)) {\n      return items[query] || null;\n    }\n\n    // if query is item, get the id\n    if (typeof query === 'object') {\n      query = query.id;\n    }\n\n    // assume query is a string and return item by id\n    return items.find(function (item) {\n      return item.id === query;\n    }) || null;\n  };\n  var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(aspectRatio) {\n    if (isEmpty(aspectRatio)) {\n      return aspectRatio;\n    }\n    if (/:/.test(aspectRatio)) {\n      var parts = aspectRatio.split(':');\n      return parts[1] / parts[0];\n    }\n    return parseFloat(aspectRatio);\n  };\n  var getActiveItems = function getActiveItems(items) {\n    return items.filter(function (item) {\n      return !item.archived;\n    });\n  };\n  var Status = {\n    EMPTY: 0,\n    IDLE: 1,\n    // waiting\n    ERROR: 2,\n    // a file is in error state\n    BUSY: 3,\n    // busy processing or loading\n    READY: 4 // all files uploaded\n  };\n\n  var ITEM_ERROR = [ItemStatus.LOAD_ERROR, ItemStatus.PROCESSING_ERROR, ItemStatus.PROCESSING_REVERT_ERROR];\n  var ITEM_BUSY = [ItemStatus.LOADING, ItemStatus.PROCESSING, ItemStatus.PROCESSING_QUEUED, ItemStatus.INIT];\n  var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n  var isItemInErrorState = function isItemInErrorState(item) {\n    return ITEM_ERROR.includes(item.status);\n  };\n  var isItemInBusyState = function isItemInBusyState(item) {\n    return ITEM_BUSY.includes(item.status);\n  };\n  var isItemInReadyState = function isItemInReadyState(item) {\n    return ITEM_READY.includes(item.status);\n  };\n  var queries = function queries(state) {\n    return {\n      GET_STATUS: function GET_STATUS() {\n        var items = getActiveItems(state.items);\n        var EMPTY = Status.EMPTY,\n          ERROR = Status.ERROR,\n          BUSY = Status.BUSY,\n          IDLE = Status.IDLE,\n          READY = Status.READY;\n        if (items.length === 0) return EMPTY;\n        if (items.some(isItemInErrorState)) return ERROR;\n        if (items.some(isItemInBusyState)) return BUSY;\n        if (items.some(isItemInReadyState)) return READY;\n        return IDLE;\n      },\n      GET_ITEM: function GET_ITEM(query) {\n        return getItemByQuery(state.items, query);\n      },\n      GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {\n        return getItemByQuery(getActiveItems(state.items), query);\n      },\n      GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {\n        return getActiveItems(state.items);\n      },\n      GET_ITEMS: function GET_ITEMS() {\n        return state.items;\n      },\n      GET_ITEM_NAME: function GET_ITEM_NAME(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n      },\n      GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n      },\n      GET_STYLES: function GET_STYLES() {\n        return Object.keys(state.options).filter(function (key) {\n          return /^style/.test(key);\n        }).map(function (option) {\n          return {\n            name: option,\n            value: state.options[option]\n          };\n        });\n      },\n      GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {\n        var isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        var aspectRatio = isShapeCircle ? 1 : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);\n        return aspectRatio;\n      },\n      GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {\n        return state.options.styleItemPanelAspectRatio;\n      },\n      GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {\n        return getActiveItems(state.items).filter(function (item) {\n          return item.status === status;\n        });\n      },\n      GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {\n        return getActiveItems(state.items).length;\n      },\n      IS_ASYNC: function IS_ASYNC() {\n        return isObject(state.options.server) && (isObject(state.options.server.process) || isFunction(state.options.server.process));\n      }\n    };\n  };\n  var hasRoomForItem = function hasRoomForItem(state) {\n    var count = getActiveItems(state.items).length;\n\n    // if cannot have multiple items, to add one item it should currently not contain items\n    if (!state.options.allowMultiple) {\n      return count === 0;\n    }\n\n    // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n    var maxFileCount = state.options.maxFiles;\n    if (maxFileCount === null) {\n      return true;\n    }\n\n    // we check if the current count is smaller than the max count, if so, another file can still be added\n    if (count < maxFileCount) {\n      return true;\n    }\n\n    // no more room for another file\n    return false;\n  };\n  var limit = function limit(value, min, max) {\n    return Math.max(Math.min(max, value), min);\n  };\n  var arrayInsert = function arrayInsert(arr, index, item) {\n    return arr.splice(index, 0, item);\n  };\n  var insertItem = function insertItem(items, item, index) {\n    if (isEmpty(item)) {\n      return null;\n    }\n\n    // if index is undefined, append\n    if (typeof index === 'undefined') {\n      items.push(item);\n      return item;\n    }\n\n    // limit the index to the size of the items array\n    index = limit(index, 0, items.length);\n\n    // add item to array\n    arrayInsert(items, index, item);\n\n    // expose\n    return item;\n  };\n  var isBase64DataURI = function isBase64DataURI(str) {\n    return /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(str);\n  };\n  var getFilenameFromURL = function getFilenameFromURL(url) {\n    return url.split('/').pop().split('?').shift();\n  };\n  var getExtensionFromFilename = function getExtensionFromFilename(name) {\n    return name.split('.').pop();\n  };\n  var guesstimateExtension = function guesstimateExtension(type) {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n      return '';\n    }\n\n    // get subtype\n    var subtype = type.split('/').pop();\n\n    // is svg subtype\n    if (/svg/.test(subtype)) {\n      return 'svg';\n    }\n    if (/zip|compressed/.test(subtype)) {\n      return 'zip';\n    }\n    if (/plain/.test(subtype)) {\n      return 'txt';\n    }\n    if (/msword/.test(subtype)) {\n      return 'doc';\n    }\n\n    // if is valid subtype\n    if (/[a-z]+/.test(subtype)) {\n      // always use jpg extension\n      if (subtype === 'jpeg') {\n        return 'jpg';\n      }\n\n      // return subtype\n      return subtype;\n    }\n    return '';\n  };\n  var leftPad = function leftPad(value) {\n    var padding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    return (padding + value).slice(-padding.length);\n  };\n  var getDateString = function getDateString() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n    return date.getFullYear() + '-' + leftPad(date.getMonth() + 1, '00') + '-' + leftPad(date.getDate(), '00') + '_' + leftPad(date.getHours(), '00') + '-' + leftPad(date.getMinutes(), '00') + '-' + leftPad(date.getSeconds(), '00');\n  };\n  var getFileFromBlob = function getFileFromBlob(blob, filename) {\n    var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var extension = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    var file = typeof type === 'string' ? blob.slice(0, blob.size, type) : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date();\n\n    // copy relative path\n    if (blob._relativePath) file._relativePath = blob._relativePath;\n\n    // if blob has name property, use as filename if no filename supplied\n    if (!isString(filename)) {\n      filename = getDateString();\n    }\n\n    // if filename supplied but no extension and filename has extension\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n      file.name = filename;\n    } else {\n      extension = extension || guesstimateExtension(file.type);\n      file.name = filename + (extension ? '.' + extension : '');\n    }\n    return file;\n  };\n  var getBlobBuilder = function getBlobBuilder() {\n    return window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n  };\n  var createBlob = function createBlob(arrayBuffer, mimeType) {\n    var BB = getBlobBuilder();\n    if (BB) {\n      var bb = new BB();\n      bb.append(arrayBuffer);\n      return bb.getBlob(mimeType);\n    }\n    return new Blob([arrayBuffer], {\n      type: mimeType\n    });\n  };\n  var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(byteString, mimeType) {\n    var ab = new ArrayBuffer(byteString.length);\n    var ia = new Uint8Array(ab);\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n    return createBlob(ab, mimeType);\n  };\n  var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(dataURI) {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n  };\n  var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(dataURI) {\n    // get data part of string (remove data:image/jpeg...,)\n    var data = dataURI.split(',')[1];\n\n    // remove any whitespace as that causes InvalidCharacterError in IE\n    return data.replace(/\\s/g, '');\n  };\n  var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(dataURI) {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n  };\n  var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {\n    var mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    var byteString = getByteStringFromBase64DataURI(dataURI);\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n  };\n  var getFileFromBase64DataURI = function getFileFromBase64DataURI(dataURI, filename, extension) {\n    return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);\n  };\n  var getFileNameFromHeader = function getFileNameFromHeader(header) {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null;\n\n    // get filename parts\n    var matches = header.split(/filename=|filename\\*=.+''/).splice(1).map(function (name) {\n      return name.trim().replace(/^[\"']|[;\"']{0,2}$/g, '');\n    }).filter(function (name) {\n      return name.length;\n    });\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n  };\n  var getFileSizeFromHeader = function getFileSizeFromHeader(header) {\n    if (/content-length:/i.test(header)) {\n      var size = header.match(/[0-9]+/)[0];\n      return size ? parseInt(size, 10) : null;\n    }\n    return null;\n  };\n  var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {\n    if (/x-content-transfer-id:/i.test(header)) {\n      var id = (header.split(':')[1] || '').trim();\n      return id || null;\n    }\n    return null;\n  };\n  var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {\n    var info = {\n      source: null,\n      name: null,\n      size: null\n    };\n    var rows = headers.split('\\n');\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n    try {\n      for (var _iterator = rows[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var header = _step.value;\n        var name = getFileNameFromHeader(header);\n        if (name) {\n          info.name = name;\n          continue;\n        }\n        var size = getFileSizeFromHeader(header);\n        if (size) {\n          info.size = size;\n          continue;\n        }\n        var source = getTranfserIdFromHeader(header);\n        if (source) {\n          info.source = source;\n          continue;\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n    return info;\n  };\n  var createFileLoader = function createFileLoader(fetchFn) {\n    var state = {\n      source: null,\n      complete: false,\n      progress: 0,\n      size: null,\n      timestamp: null,\n      duration: 0,\n      request: null\n    };\n    var getProgress = function getProgress() {\n      return state.progress;\n    };\n    var abort = function abort() {\n      if (state.request && state.request.abort) {\n        state.request.abort();\n      }\n    };\n\n    // load source\n    var load = function load() {\n      // get quick reference\n      var source = state.source;\n      api.fire('init', source);\n\n      // Load Files\n      if (source instanceof File) {\n        api.fire('load', source);\n      } else if (source instanceof Blob) {\n        // Load blobs, set default name to current date\n        api.fire('load', getFileFromBlob(source, source.name));\n      } else if (isBase64DataURI(source)) {\n        // Load base 64, set default name to current date\n        api.fire('load', getFileFromBase64DataURI(source));\n      } else {\n        // Deal as if is external URL, let's load it!\n        loadURL(source);\n      }\n    };\n\n    // loads a url\n    var loadURL = function loadURL(url) {\n      // is remote url and no fetch method supplied\n      if (!fetchFn) {\n        api.fire('error', {\n          type: 'error',\n          body: \"Can't load URL\",\n          code: 400\n        });\n        return;\n      }\n\n      // set request start\n      state.timestamp = Date.now();\n\n      // load file\n      state.request = fetchFn(url, function (response) {\n        // update duration\n        state.duration = Date.now() - state.timestamp;\n\n        // done!\n        state.complete = true;\n\n        // turn blob response into a file\n        if (response instanceof Blob) {\n          response = getFileFromBlob(response, response.name || getFilenameFromURL(url));\n        }\n        api.fire('load',\n        // if has received blob, we go with blob, if no response, we return null\n        response instanceof Blob ? response : response ? response.body : null);\n      }, function (error) {\n        api.fire('error', typeof error === 'string' ? {\n          type: 'error',\n          code: 0,\n          body: error\n        } : error);\n      }, function (computable, current, total) {\n        // collected some meta data already\n        if (total) {\n          state.size = total;\n        }\n\n        // update duration\n        state.duration = Date.now() - state.timestamp;\n\n        // if we can't compute progress, we're not going to fire progress events\n        if (!computable) {\n          state.progress = null;\n          return;\n        }\n\n        // update progress percentage\n        state.progress = current / total;\n\n        // expose\n        api.fire('progress', state.progress);\n      }, function () {\n        api.fire('abort');\n      }, function (response) {\n        var fileinfo = getFileInfoFromHeaders(typeof response === 'string' ? response : response.headers);\n        api.fire('meta', {\n          size: state.size || fileinfo.size,\n          filename: fileinfo.name,\n          source: fileinfo.source\n        });\n      });\n    };\n    var api = Object.assign({}, on(), {\n      setSource: function setSource(source) {\n        return state.source = source;\n      },\n      getProgress: getProgress,\n      // file load progress\n      abort: abort,\n      // abort file load\n      load: load // start load\n    });\n\n    return api;\n  };\n  var isGet = function isGet(method) {\n    return /GET|HEAD/.test(method);\n  };\n  var sendRequest = function sendRequest(data, url, options) {\n    var api = {\n      onheaders: function onheaders() {},\n      onprogress: function onprogress() {},\n      onload: function onload() {},\n      ontimeout: function ontimeout() {},\n      onerror: function onerror() {},\n      onabort: function onabort() {},\n      abort: function abort() {\n        aborted = true;\n        xhr.abort();\n      }\n    };\n\n    // timeout identifier, only used when timeout is defined\n    var aborted = false;\n    var headersReceived = false;\n\n    // set default options\n    options = Object.assign({\n      method: 'POST',\n      headers: {},\n      withCredentials: false\n    }, options);\n\n    // encode url\n    url = encodeURI(url);\n\n    // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n      url = '' + url + encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data));\n    }\n\n    // create request\n    var xhr = new XMLHttpRequest();\n\n    // progress of load\n    var process = isGet(options.method) ? xhr : xhr.upload;\n    process.onprogress = function (e) {\n      // no progress event when aborted ( onprogress is called once after abort() )\n      if (aborted) {\n        return;\n      }\n      api.onprogress(e.lengthComputable, e.loaded, e.total);\n    };\n\n    // tries to get header info to the app as fast as possible\n    xhr.onreadystatechange = function () {\n      // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n      if (xhr.readyState < 2) {\n        return;\n      }\n\n      // no server response\n      if (xhr.readyState === 4 && xhr.status === 0) {\n        return;\n      }\n      if (headersReceived) {\n        return;\n      }\n      headersReceived = true;\n\n      // we've probably received some useful data in response headers\n      api.onheaders(xhr);\n    };\n\n    // load successful\n    xhr.onload = function () {\n      // is classified as valid response\n      if (xhr.status >= 200 && xhr.status < 300) {\n        api.onload(xhr);\n      } else {\n        api.onerror(xhr);\n      }\n    };\n\n    // error during load\n    xhr.onerror = function () {\n      return api.onerror(xhr);\n    };\n\n    // request aborted\n    xhr.onabort = function () {\n      aborted = true;\n      api.onabort();\n    };\n\n    // request timeout\n    xhr.ontimeout = function () {\n      return api.ontimeout(xhr);\n    };\n\n    // open up open up!\n    xhr.open(options.method, url, true);\n\n    // set timeout if defined (do it after open so IE11 plays ball)\n    if (isInt(options.timeout)) {\n      xhr.timeout = options.timeout;\n    }\n\n    // add headers\n    Object.keys(options.headers).forEach(function (key) {\n      var value = unescape(encodeURIComponent(options.headers[key]));\n      xhr.setRequestHeader(key, value);\n    });\n\n    // set type of response\n    if (options.responseType) {\n      xhr.responseType = options.responseType;\n    }\n\n    // set credentials\n    if (options.withCredentials) {\n      xhr.withCredentials = true;\n    }\n\n    // let's send our data\n    xhr.send(data);\n    return api;\n  };\n  var createResponse = function createResponse(type, code, body, headers) {\n    return {\n      type: type,\n      code: code,\n      body: body,\n      headers: headers\n    };\n  };\n  var createTimeoutResponse = function createTimeoutResponse(cb) {\n    return function (xhr) {\n      cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n    };\n  };\n  var hasQS = function hasQS(str) {\n    return /\\?/.test(str);\n  };\n  var buildURL = function buildURL() {\n    var url = '';\n    for (var _len = arguments.length, parts = new Array(_len), _key = 0; _key < _len; _key++) {\n      parts[_key] = arguments[_key];\n    }\n    parts.forEach(function (part) {\n      url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\n    });\n    return url;\n  };\n  var createFetchFunction = function createFetchFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') {\n      return action;\n    }\n\n    // no action supplied\n    if (!action || !isString(action.url)) {\n      return null;\n    }\n\n    // set onload hanlder\n    var onload = action.onload || function (res) {\n      return res;\n    };\n    var onerror = action.onerror || function (res) {\n      return null;\n    };\n\n    // internal handler\n    return function (url, load, error, progress, abort, headers) {\n      // do local or remote request based on if the url is external\n      var request = sendRequest(url, buildURL(apiUrl, action.url), Object.assign({}, action, {\n        responseType: 'blob'\n      }));\n      request.onload = function (xhr) {\n        // get headers\n        var headers = xhr.getAllResponseHeaders();\n\n        // get filename\n        var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n        // create response\n        load(createResponse('load', xhr.status, action.method === 'HEAD' ? null : getFileFromBlob(onload(xhr.response), filename), headers));\n      };\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n      request.onheaders = function (xhr) {\n        headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n      };\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort;\n\n      // should return request\n      return request;\n    };\n  };\n  var ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4\n  };\n\n  /*\n                                                       function signature:\n                                                         (file, metadata, load, error, progress, abort, transfer, options) => {\n                                                           return {\n                                                           abort:() => {}\n                                                         }\n                                                       }\n                                                       */\n\n  // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\n  var processFileChunked = function processFileChunked(apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options) {\n    // all chunks\n    var chunks = [];\n    var chunkTransferId = options.chunkTransferId,\n      chunkServer = options.chunkServer,\n      chunkSize = options.chunkSize,\n      chunkRetryDelays = options.chunkRetryDelays;\n\n    // default state\n    var state = {\n      serverId: chunkTransferId,\n      aborted: false\n    };\n\n    // set onload handlers\n    var ondata = action.ondata || function (fd) {\n      return fd;\n    };\n    var onload = action.onload || function (xhr, method) {\n      return method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response;\n    };\n    var onerror = action.onerror || function (res) {\n      return null;\n    };\n\n    // create server hook\n    var requestTransferId = function requestTransferId(cb) {\n      var formData = new FormData();\n\n      // add metadata under same name\n      if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n      var headers = typeof action.headers === 'function' ? action.headers(file, metadata) : Object.assign({}, action.headers, {\n        'Upload-Length': file.size\n      });\n      var requestParams = Object.assign({}, action, {\n        headers: headers\n      });\n\n      // send request object\n      var request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\n      request.onload = function (xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n      request.onerror = function (xhr) {\n        return error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n      request.ontimeout = createTimeoutResponse(error);\n    };\n    var requestTransferOffset = function requestTransferOffset(cb) {\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n      var headers = typeof action.headers === 'function' ? action.headers(state.serverId) : Object.assign({}, action.headers);\n      var requestParams = {\n        headers: headers,\n        method: 'HEAD'\n      };\n      var request = sendRequest(null, requestUrl, requestParams);\n      request.onload = function (xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n      request.onerror = function (xhr) {\n        return error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    // create chunks\n    var lastChunkIndex = Math.floor(file.size / chunkSize);\n    for (var i = 0; i <= lastChunkIndex; i++) {\n      var offset = i * chunkSize;\n      var data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');\n      chunks[i] = {\n        index: i,\n        size: data.size,\n        offset: offset,\n        data: data,\n        file: file,\n        progress: 0,\n        retries: _toConsumableArray(chunkRetryDelays),\n        status: ChunkStatus.QUEUED,\n        error: null,\n        request: null,\n        timeout: null\n      };\n    }\n    var completeProcessingChunks = function completeProcessingChunks() {\n      return load(state.serverId);\n    };\n    var canProcessChunk = function canProcessChunk(chunk) {\n      return chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;\n    };\n    var processChunk = function processChunk(chunk) {\n      // processing is paused, wait here\n      if (state.aborted) return;\n\n      // get next chunk to process\n      chunk = chunk || chunks.find(canProcessChunk);\n\n      // no more chunks to process\n      if (!chunk) {\n        // all done?\n        if (chunks.every(function (chunk) {\n          return chunk.status === ChunkStatus.COMPLETE;\n        })) {\n          completeProcessingChunks();\n        }\n\n        // no chunk to handle\n        return;\n      }\n\n      // now processing this chunk\n      chunk.status = ChunkStatus.PROCESSING;\n      chunk.progress = null;\n\n      // allow parsing of formdata\n      var ondata = chunkServer.ondata || function (fd) {\n        return fd;\n      };\n      var onerror = chunkServer.onerror || function (res) {\n        return null;\n      };\n\n      // send request object\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n      var headers = typeof chunkServer.headers === 'function' ? chunkServer.headers(chunk) : Object.assign({}, chunkServer.headers, {\n        'Content-Type': 'application/offset+octet-stream',\n        'Upload-Offset': chunk.offset,\n        'Upload-Length': file.size,\n        'Upload-Name': file.name\n      });\n      var request = chunk.request = sendRequest(ondata(chunk.data), requestUrl, Object.assign({}, chunkServer, {\n        headers: headers\n      }));\n      request.onload = function () {\n        // done!\n        chunk.status = ChunkStatus.COMPLETE;\n\n        // remove request reference\n        chunk.request = null;\n\n        // start processing more chunks\n        processChunks();\n      };\n      request.onprogress = function (lengthComputable, loaded, total) {\n        chunk.progress = lengthComputable ? loaded : null;\n        updateTotalProgress();\n      };\n      request.onerror = function (xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        chunk.error = onerror(xhr.response) || xhr.statusText;\n        if (!retryProcessChunk(chunk)) {\n          error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n        }\n      };\n      request.ontimeout = function (xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        if (!retryProcessChunk(chunk)) {\n          createTimeoutResponse(error)(xhr);\n        }\n      };\n      request.onabort = function () {\n        chunk.status = ChunkStatus.QUEUED;\n        chunk.request = null;\n        abort();\n      };\n    };\n    var retryProcessChunk = function retryProcessChunk(chunk) {\n      // no more retries left\n      if (chunk.retries.length === 0) return false;\n\n      // new retry\n      chunk.status = ChunkStatus.WAITING;\n      clearTimeout(chunk.timeout);\n      chunk.timeout = setTimeout(function () {\n        processChunk(chunk);\n      }, chunk.retries.shift());\n\n      // we're going to retry\n      return true;\n    };\n    var updateTotalProgress = function updateTotalProgress() {\n      // calculate total progress fraction\n      var totalBytesTransfered = chunks.reduce(function (p, chunk) {\n        if (p === null || chunk.progress === null) return null;\n        return p + chunk.progress;\n      }, 0);\n\n      // can't compute progress\n      if (totalBytesTransfered === null) return progress(false, 0, 0);\n\n      // calculate progress values\n      var totalSize = chunks.reduce(function (total, chunk) {\n        return total + chunk.size;\n      }, 0);\n\n      // can update progress indicator\n      progress(true, totalBytesTransfered, totalSize);\n    };\n\n    // process new chunks\n    var processChunks = function processChunks() {\n      var totalProcessing = chunks.filter(function (chunk) {\n        return chunk.status === ChunkStatus.PROCESSING;\n      }).length;\n      if (totalProcessing >= 1) return;\n      processChunk();\n    };\n    var abortChunks = function abortChunks() {\n      chunks.forEach(function (chunk) {\n        clearTimeout(chunk.timeout);\n        if (chunk.request) {\n          chunk.request.abort();\n        }\n      });\n    };\n\n    // let's go!\n    if (!state.serverId) {\n      requestTransferId(function (serverId) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return;\n\n        // pass back to item so we can use it if something goes wrong\n        transfer(serverId);\n\n        // store internally\n        state.serverId = serverId;\n        processChunks();\n      });\n    } else {\n      requestTransferOffset(function (offset) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return;\n\n        // mark chunks with lower offset as complete\n        chunks.filter(function (chunk) {\n          return chunk.offset < offset;\n        }).forEach(function (chunk) {\n          chunk.status = ChunkStatus.COMPLETE;\n          chunk.progress = chunk.size;\n        });\n\n        // continue processing\n        processChunks();\n      });\n    }\n    return {\n      abort: function abort() {\n        state.aborted = true;\n        abortChunks();\n      }\n    };\n  };\n\n  /*\n                                                               function signature:\n                                                                 (file, metadata, load, error, progress, abort) => {\n                                                                   return {\n                                                                   abort:() => {}\n                                                                 }\n                                                               }\n                                                               */\n  var createFileProcessorFunction = function createFileProcessorFunction(apiUrl, action, name, options) {\n    return function (file, metadata, load, error, progress, abort, transfer) {\n      // no file received\n      if (!file) return;\n\n      // if was passed a file, and we can chunk it, exit here\n      var canChunkUpload = options.chunkUploads;\n      var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n      var willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);\n      if (file instanceof Blob && willChunkUpload) return processFileChunked(apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options);\n\n      // set handlers\n      var ondata = action.ondata || function (fd) {\n        return fd;\n      };\n      var onload = action.onload || function (res) {\n        return res;\n      };\n      var onerror = action.onerror || function (res) {\n        return null;\n      };\n\n      // create formdata object\n      var formData = new FormData();\n\n      // add metadata under same name\n      if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n      }\n\n      // Turn into an array of objects so no matter what the input, we can handle it the same way\n      (file instanceof Blob ? [{\n        name: null,\n        file: file\n      }] : file).forEach(function (item) {\n        formData.append(name, item.file, item.name === null ? item.file.name : '' + item.name + item.file.name);\n      });\n\n      // send request object\n      var request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), action);\n      request.onload = function (xhr) {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n      };\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort;\n\n      // should return request\n      return request;\n    };\n  };\n  var createProcessorFunction = function createProcessorFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    var name = arguments.length > 2 ? arguments[2] : undefined;\n    var options = arguments.length > 3 ? arguments[3] : undefined;\n\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') return function () {\n      for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n        params[_key] = arguments[_key];\n      }\n      return action.apply(void 0, [name].concat(params, [options]));\n    };\n\n    // no action supplied\n    if (!action || !isString(action.url)) return null;\n\n    // internal handler\n    return createFileProcessorFunction(apiUrl, action, name, options);\n  };\n\n  /*\n                                                      function signature:\n                                                      (uniqueFileId, load, error) => { }\n                                                      */\n  var createRevertFunction = function createRevertFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    // is custom implementation\n    if (typeof action === 'function') {\n      return action;\n    }\n\n    // no action supplied, return stub function, interface will work, but file won't be removed\n    if (!action || !isString(action.url)) {\n      return function (uniqueFileId, load) {\n        return load();\n      };\n    }\n\n    // set onload hanlder\n    var onload = action.onload || function (res) {\n      return res;\n    };\n    var onerror = action.onerror || function (res) {\n      return null;\n    };\n\n    // internal implementation\n    return function (uniqueFileId, load, error) {\n      var request = sendRequest(uniqueFileId, apiUrl + action.url, action // contains method, headers and withCredentials properties\n      );\n\n      request.onload = function (xhr) {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n      };\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n      request.ontimeout = createTimeoutResponse(error);\n      return request;\n    };\n  };\n  var getRandomNumber = function getRandomNumber() {\n    var min = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var max = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return min + Math.random() * (max - min);\n  };\n  var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(cb) {\n    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var tickMin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;\n    var tickMax = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n    var timeout = null;\n    var start = Date.now();\n    var tick = function tick() {\n      var runtime = Date.now() - start;\n      var delay = getRandomNumber(tickMin, tickMax);\n      if (runtime + delay > duration) {\n        delay = runtime + delay - duration;\n      }\n      var progress = runtime / duration;\n      if (progress >= 1 || document.hidden) {\n        cb(1);\n        return;\n      }\n      cb(progress);\n      timeout = setTimeout(tick, delay);\n    };\n    tick();\n    return {\n      clear: function clear() {\n        clearTimeout(timeout);\n      }\n    };\n  };\n  var createFileProcessor = function createFileProcessor(processFn) {\n    var state = {\n      complete: false,\n      perceivedProgress: 0,\n      perceivedPerformanceUpdater: null,\n      progress: null,\n      timestamp: null,\n      perceivedDuration: 0,\n      duration: 0,\n      request: null,\n      response: null\n    };\n    var process = function process(file, metadata) {\n      var progressFn = function progressFn() {\n        // we've not yet started the real download, stop here\n        // the request might not go through, for instance, there might be some server trouble\n        // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n        if (state.duration === 0 || state.progress === null) return;\n\n        // as we're now processing, fire the progress event\n        api.fire('progress', api.getProgress());\n      };\n      var completeFn = function completeFn() {\n        state.complete = true;\n        api.fire('load-perceived', state.response.body);\n      };\n\n      // let's start processing\n      api.fire('start');\n\n      // set request start\n      state.timestamp = Date.now();\n\n      // create perceived performance progress indicator\n      state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(function (progress) {\n        state.perceivedProgress = progress;\n        state.perceivedDuration = Date.now() - state.timestamp;\n        progressFn();\n\n        // if fake progress is done, and a response has been received,\n        // and we've not yet called the complete method\n        if (state.response && state.perceivedProgress === 1 && !state.complete) {\n          // we done!\n          completeFn();\n        }\n      },\n      // random delay as in a list of files you start noticing\n      // files uploading at the exact same speed\n      getRandomNumber(750, 1500));\n\n      // remember request so we can abort it later\n      state.request = processFn(\n      // the file to process\n      file,\n      // the metadata to send along\n      metadata,\n      // callbacks (load, error, progress, abort, transfer)\n      // load expects the body to be a server id if\n      // you want to make use of revert\n      function (response) {\n        // we put the response in state so we can access\n        // it outside of this method\n        state.response = isObject(response) ? response : {\n          type: 'load',\n          code: 200,\n          body: '' + response,\n          headers: {}\n        };\n\n        // update duration\n        state.duration = Date.now() - state.timestamp;\n\n        // force progress to 1 as we're now done\n        state.progress = 1;\n\n        // actual load is done let's share results\n        api.fire('load', state.response.body);\n\n        // we are really done\n        // if perceived progress is 1 ( wait for perceived progress to complete )\n        // or if server does not support progress ( null )\n        if (state.perceivedProgress === 1) {\n          completeFn();\n        }\n      },\n      // error is expected to be an object with type, code, body\n      function (error) {\n        // cancel updater\n        state.perceivedPerformanceUpdater.clear();\n\n        // update others about this error\n        api.fire('error', isObject(error) ? error : {\n          type: 'error',\n          code: 0,\n          body: '' + error\n        });\n      },\n      // actual processing progress\n      function (computable, current, total) {\n        // update actual duration\n        state.duration = Date.now() - state.timestamp;\n\n        // update actual progress\n        state.progress = computable ? current / total : null;\n        progressFn();\n      },\n      // abort does not expect a value\n      function () {\n        // stop updater\n        state.perceivedPerformanceUpdater.clear();\n\n        // fire the abort event so we can switch visuals\n        api.fire('abort', state.response ? state.response.body : null);\n      },\n      // register the id for this transfer\n      function (transferId) {\n        api.fire('transfer', transferId);\n      });\n    };\n    var abort = function abort() {\n      // no request running, can't abort\n      if (!state.request) return;\n\n      // stop updater\n      state.perceivedPerformanceUpdater.clear();\n\n      // abort actual request\n      if (state.request.abort) state.request.abort();\n\n      // if has response object, we've completed the request\n      state.complete = true;\n    };\n    var reset = function reset() {\n      abort();\n      state.complete = false;\n      state.perceivedProgress = 0;\n      state.progress = 0;\n      state.timestamp = null;\n      state.perceivedDuration = 0;\n      state.duration = 0;\n      state.request = null;\n      state.response = null;\n    };\n    var getProgress = function getProgress() {\n      return state.progress ? Math.min(state.progress, state.perceivedProgress) : null;\n    };\n    var getDuration = function getDuration() {\n      return Math.min(state.duration, state.perceivedDuration);\n    };\n    var api = Object.assign({}, on(), {\n      process: process,\n      // start processing file\n      abort: abort,\n      // abort active process request\n      getProgress: getProgress,\n      getDuration: getDuration,\n      reset: reset\n    });\n    return api;\n  };\n  var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n    return name.substr(0, name.lastIndexOf('.')) || name;\n  };\n  var createFileStub = function createFileStub(source) {\n    var data = [source.name, source.size, source.type];\n\n    // is blob or base64, then we need to set the name\n    if (source instanceof Blob || isBase64DataURI(source)) {\n      data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n      // if is base64 data uri we need to determine the average size and type\n      data[1] = source.length;\n      data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n      // url\n      data[0] = getFilenameFromURL(source);\n      data[1] = 0;\n      data[2] = 'application/octet-stream';\n    }\n    return {\n      name: data[0],\n      size: data[1],\n      type: data[2]\n    };\n  };\n  var isFile = function isFile(value) {\n    return !!(value instanceof File || value instanceof Blob && value.name);\n  };\n  var deepCloneObject = function deepCloneObject(src) {\n    if (!isObject(src)) return src;\n    var target = isArray(src) ? [] : {};\n    for (var key in src) {\n      if (!src.hasOwnProperty(key)) continue;\n      var v = src[key];\n      target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n    return target;\n  };\n  var createItem = function createItem() {\n    var origin = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var serverFileReference = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var file = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    // unique id for this item, is used to identify the item across views\n    var id = getUniqueId();\n\n    /**\n     * Internal item state\n     */\n    var state = {\n      // is archived\n      archived: false,\n      // if is frozen, no longer fires events\n      frozen: false,\n      // removed from view\n      released: false,\n      // original source\n      source: null,\n      // file model reference\n      file: file,\n      // id of file on server\n      serverFileReference: serverFileReference,\n      // id of file transfer on server\n      transferId: null,\n      // is aborted\n      processingAborted: false,\n      // current item status\n      status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,\n      // active processes\n      activeLoader: null,\n      activeProcessor: null\n    };\n\n    // callback used when abort processing is called to link back to the resolve method\n    var abortProcessingRequestComplete = null;\n\n    /**\n     * Externally added item metadata\n     */\n    var metadata = {};\n\n    // item data\n    var setStatus = function setStatus(status) {\n      return state.status = status;\n    };\n\n    // fire event unless the item has been archived\n    var fire = function fire(event) {\n      if (state.released || state.frozen) return;\n      for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        params[_key - 1] = arguments[_key];\n      }\n      api.fire.apply(api, [event].concat(params));\n    };\n\n    // file data\n    var getFileExtension = function getFileExtension() {\n      return getExtensionFromFilename(state.file.name);\n    };\n    var getFileType = function getFileType() {\n      return state.file.type;\n    };\n    var getFileSize = function getFileSize() {\n      return state.file.size;\n    };\n    var getFile = function getFile() {\n      return state.file;\n    };\n\n    //\n    // logic to load a file\n    //\n    var load = function load(source, loader, onload) {\n      // remember the original item source\n      state.source = source;\n\n      // source is known\n      api.fireSync('init');\n\n      // file stub is already there\n      if (state.file) {\n        api.fireSync('load-skip');\n        return;\n      }\n\n      // set a stub file object while loading the actual data\n      state.file = createFileStub(source);\n\n      // starts loading\n      loader.on('init', function () {\n        fire('load-init');\n      });\n\n      // we'eve received a size indication, let's update the stub\n      loader.on('meta', function (meta) {\n        // set size of file stub\n        state.file.size = meta.size;\n\n        // set name of file stub\n        state.file.filename = meta.filename;\n\n        // if has received source, we done\n        if (meta.source) {\n          origin = FileOrigin.LIMBO;\n          state.serverFileReference = meta.source;\n          state.status = ItemStatus.PROCESSING_COMPLETE;\n        }\n\n        // size has been updated\n        fire('load-meta');\n      });\n\n      // the file is now loading we need to update the progress indicators\n      loader.on('progress', function (progress) {\n        setStatus(ItemStatus.LOADING);\n        fire('load-progress', progress);\n      });\n\n      // an error was thrown while loading the file, we need to switch to error state\n      loader.on('error', function (error) {\n        setStatus(ItemStatus.LOAD_ERROR);\n        fire('load-request-error', error);\n      });\n\n      // user or another process aborted the file load (cannot retry)\n      loader.on('abort', function () {\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n      });\n\n      // done loading\n      loader.on('load', function (file) {\n        // as we've now loaded the file the loader is no longer required\n        state.activeLoader = null;\n\n        // called when file has loaded succesfully\n        var success = function success(result) {\n          // set (possibly) transformed file\n          state.file = isFile(result) ? result : state.file;\n\n          // file received\n          if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n          } else {\n            setStatus(ItemStatus.IDLE);\n          }\n          fire('load');\n        };\n        var error = function error(result) {\n          // set original file\n          state.file = file;\n          fire('load-meta');\n          setStatus(ItemStatus.LOAD_ERROR);\n          fire('load-file-error', result);\n        };\n\n        // if we already have a server file reference, we don't need to call the onload method\n        if (state.serverFileReference) {\n          success(file);\n          return;\n        }\n\n        // no server id, let's give this file the full treatment\n        onload(file, success, error);\n      });\n\n      // set loader source data\n      loader.setSource(source);\n\n      // set as active loader\n      state.activeLoader = loader;\n\n      // load the source data\n      loader.load();\n    };\n    var retryLoad = function retryLoad() {\n      if (!state.activeLoader) {\n        return;\n      }\n      state.activeLoader.load();\n    };\n    var abortLoad = function abortLoad() {\n      if (state.activeLoader) {\n        state.activeLoader.abort();\n        return;\n      }\n      setStatus(ItemStatus.INIT);\n      fire('load-abort');\n    };\n\n    //\n    // logic to process a file\n    //\n    var process = function process(processor, onprocess) {\n      // processing was aborted\n      if (state.processingAborted) {\n        state.processingAborted = false;\n        return;\n      }\n\n      // now processing\n      setStatus(ItemStatus.PROCESSING);\n\n      // reset abort callback\n      abortProcessingRequestComplete = null;\n\n      // if no file loaded we'll wait for the load event\n      if (!(state.file instanceof Blob)) {\n        api.on('load', function () {\n          process(processor, onprocess);\n        });\n        return;\n      }\n\n      // setup processor\n      processor.on('load', function (serverFileReference) {\n        // need this id to be able to revert the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n      });\n\n      // register transfer id\n      processor.on('transfer', function (transferId) {\n        // need this id to be able to revert the upload\n        state.transferId = transferId;\n      });\n      processor.on('load-perceived', function (serverFileReference) {\n        // no longer required\n        state.activeProcessor = null;\n\n        // need this id to be able to rever the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n        setStatus(ItemStatus.PROCESSING_COMPLETE);\n        fire('process-complete', serverFileReference);\n      });\n      processor.on('start', function () {\n        fire('process-start');\n      });\n      processor.on('error', function (error) {\n        state.activeProcessor = null;\n        setStatus(ItemStatus.PROCESSING_ERROR);\n        fire('process-error', error);\n      });\n      processor.on('abort', function (serverFileReference) {\n        state.activeProcessor = null;\n\n        // if file was uploaded but processing was cancelled during perceived processor time store file reference\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n        setStatus(ItemStatus.IDLE);\n        fire('process-abort');\n\n        // has timeout so doesn't interfere with remove action\n        if (abortProcessingRequestComplete) {\n          abortProcessingRequestComplete();\n        }\n      });\n      processor.on('progress', function (progress) {\n        fire('process-progress', progress);\n      });\n\n      // when successfully transformed\n      var success = function success(file) {\n        // if was archived in the mean time, don't process\n        if (state.archived) return;\n\n        // process file!\n        processor.process(file, Object.assign({}, metadata));\n      };\n\n      // something went wrong during transform phase\n      var error = console.error;\n\n      // start processing the file\n      onprocess(state.file, success, error);\n\n      // set as active processor\n      state.activeProcessor = processor;\n    };\n    var requestProcessing = function requestProcessing() {\n      state.processingAborted = false;\n      setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n    var abortProcessing = function abortProcessing() {\n      return new Promise(function (resolve) {\n        if (!state.activeProcessor) {\n          state.processingAborted = true;\n          setStatus(ItemStatus.IDLE);\n          fire('process-abort');\n          resolve();\n          return;\n        }\n        abortProcessingRequestComplete = function abortProcessingRequestComplete() {\n          resolve();\n        };\n        state.activeProcessor.abort();\n      });\n    };\n\n    //\n    // logic to revert a processed file\n    //\n    var revert = function revert(revertFileUpload, forceRevert) {\n      return new Promise(function (resolve, reject) {\n        // cannot revert without a server id for this process\n        if (state.serverFileReference === null) {\n          resolve();\n          return;\n        }\n\n        // revert the upload (fire and forget)\n        revertFileUpload(state.serverFileReference, function () {\n          // reset file server id as now it's no available on the server\n          state.serverFileReference = null;\n          resolve();\n        }, function (error) {\n          // don't set error state when reverting is optional, it will always resolve\n          if (!forceRevert) {\n            resolve();\n            return;\n          }\n\n          // oh no errors\n          setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n          fire('process-revert-error');\n          reject(error);\n        });\n\n        // fire event\n        setStatus(ItemStatus.IDLE);\n        fire('process-revert');\n      });\n    };\n\n    // exposed methods\n    var _setMetadata = function setMetadata(key, value, silent) {\n      var keys = key.split('.');\n      var root = keys[0];\n      var last = keys.pop();\n      var data = metadata;\n      keys.forEach(function (key) {\n        return data = data[key];\n      });\n\n      // compare old value against new value, if they're the same, we're not updating\n      if (JSON.stringify(data[last]) === JSON.stringify(value)) return;\n\n      // update value\n      data[last] = value;\n\n      // don't fire update\n      if (silent) return;\n\n      // fire update\n      fire('metadata-update', {\n        key: root,\n        value: metadata[root]\n      });\n    };\n    var getMetadata = function getMetadata(key) {\n      return deepCloneObject(key ? metadata[key] : metadata);\n    };\n    var api = Object.assign({\n      id: {\n        get: function get() {\n          return id;\n        }\n      },\n      origin: {\n        get: function get() {\n          return origin;\n        }\n      },\n      serverId: {\n        get: function get() {\n          return state.serverFileReference;\n        }\n      },\n      transferId: {\n        get: function get() {\n          return state.transferId;\n        }\n      },\n      status: {\n        get: function get() {\n          return state.status;\n        }\n      },\n      filename: {\n        get: function get() {\n          return state.file.name;\n        }\n      },\n      filenameWithoutExtension: {\n        get: function get() {\n          return getFilenameWithoutExtension(state.file.name);\n        }\n      },\n      fileExtension: {\n        get: getFileExtension\n      },\n      fileType: {\n        get: getFileType\n      },\n      fileSize: {\n        get: getFileSize\n      },\n      file: {\n        get: getFile\n      },\n      relativePath: {\n        get: function get() {\n          return state.file._relativePath;\n        }\n      },\n      source: {\n        get: function get() {\n          return state.source;\n        }\n      },\n      getMetadata: getMetadata,\n      setMetadata: function setMetadata(key, value, silent) {\n        if (isObject(key)) {\n          var data = key;\n          Object.keys(data).forEach(function (key) {\n            _setMetadata(key, data[key], value);\n          });\n          return key;\n        }\n        _setMetadata(key, value, silent);\n        return value;\n      },\n      extend: function extend(name, handler) {\n        return itemAPI[name] = handler;\n      },\n      abortLoad: abortLoad,\n      retryLoad: retryLoad,\n      requestProcessing: requestProcessing,\n      abortProcessing: abortProcessing,\n      load: load,\n      process: process,\n      revert: revert\n    }, on(), {\n      freeze: function freeze() {\n        return state.frozen = true;\n      },\n      release: function release() {\n        return state.released = true;\n      },\n      released: {\n        get: function get() {\n          return state.released;\n        }\n      },\n      archive: function archive() {\n        return state.archived = true;\n      },\n      archived: {\n        get: function get() {\n          return state.archived;\n        }\n      }\n    });\n\n    // create it here instead of returning it instantly so we can extend it later\n    var itemAPI = createObject(api);\n    return itemAPI;\n  };\n  var getItemIndexByQuery = function getItemIndexByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return 0;\n    }\n\n    // invalid queries\n    if (!isString(query)) {\n      return -1;\n    }\n\n    // return item by id (or -1 if not found)\n    return items.findIndex(function (item) {\n      return item.id === query;\n    });\n  };\n  var getItemById = function getItemById(items, itemId) {\n    var index = getItemIndexByQuery(items, itemId);\n    if (index < 0) {\n      return;\n    }\n    return items[index] || null;\n  };\n  var fetchBlob = function fetchBlob(url, load, error, progress, abort, headers) {\n    var request = sendRequest(null, url, {\n      method: 'GET',\n      responseType: 'blob'\n    });\n    request.onload = function (xhr) {\n      // get headers\n      var headers = xhr.getAllResponseHeaders();\n\n      // get filename\n      var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n      // create response\n      load(createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers));\n    };\n    request.onerror = function (xhr) {\n      error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));\n    };\n    request.onheaders = function (xhr) {\n      headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n    };\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort;\n\n    // should return request\n    return request;\n  };\n  var getDomainFromURL = function getDomainFromURL(url) {\n    if (url.indexOf('//') === 0) {\n      url = location.protocol + url;\n    }\n    return url.toLowerCase().replace('blob:', '').replace(/([a-z])?:\\/\\//, '$1').split('/')[0];\n  };\n  var isExternalURL = function isExternalURL(url) {\n    return (url.indexOf(':') > -1 || url.indexOf('//') > -1) && getDomainFromURL(location.href) !== getDomainFromURL(url);\n  };\n  var dynamicLabel = function dynamicLabel(label) {\n    return function () {\n      return isFunction(label) ? label.apply(void 0, arguments) : label;\n    };\n  };\n  var isMockItem = function isMockItem(item) {\n    return !isFile(item.file);\n  };\n  var listUpdated = function listUpdated(dispatch, state) {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(function () {\n      dispatch('DID_UPDATE_ITEMS', {\n        items: getActiveItems(state.items)\n      });\n    }, 0);\n  };\n  var optionalPromise = function optionalPromise(fn) {\n    for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      params[_key - 1] = arguments[_key];\n    }\n    return new Promise(function (resolve) {\n      if (!fn) {\n        return resolve(true);\n      }\n      var result = fn.apply(void 0, params);\n      if (result == null) {\n        return resolve(true);\n      }\n      if (typeof result === 'boolean') {\n        return resolve(result);\n      }\n      if (typeof result.then === 'function') {\n        result.then(resolve);\n      }\n    });\n  };\n  var sortItems = function sortItems(state, compare) {\n    state.items.sort(function (a, b) {\n      return compare(createItemAPI(a), createItemAPI(b));\n    });\n  };\n\n  // returns item based on state\n  var getItemByQueryFromState = function getItemByQueryFromState(state, itemHandler) {\n    return function () {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var query = _ref.query,\n        _ref$success = _ref.success,\n        success = _ref$success === void 0 ? function () {} : _ref$success,\n        _ref$failure = _ref.failure,\n        failure = _ref$failure === void 0 ? function () {} : _ref$failure,\n        options = _objectWithoutProperties(_ref, ['query', 'success', 'failure']);\n      var item = getItemByQuery(state.items, query);\n      if (!item) {\n        failure({\n          error: createResponse('error', 0, 'Item not found'),\n          file: null\n        });\n        return;\n      }\n      itemHandler(item, success, failure, options || {});\n    };\n  };\n  var actions = function actions(dispatch, query, state) {\n    return {\n      /**\n       * Aborts all ongoing processes\n       */\n      ABORT_ALL: function ABORT_ALL() {\n        getActiveItems(state.items).forEach(function (item) {\n          item.freeze();\n          item.abortLoad();\n          item.abortProcessing();\n        });\n      },\n      /**\n       * Sets initial files\n       */\n      DID_SET_FILES: function DID_SET_FILES(_ref2) {\n        var _ref2$value = _ref2.value,\n          value = _ref2$value === void 0 ? [] : _ref2$value;\n\n        // map values to file objects\n        var files = value.map(function (file) {\n          return {\n            source: file.source ? file.source : file,\n            options: file.options\n          };\n        });\n\n        // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n        var activeItems = getActiveItems(state.items);\n        activeItems.forEach(function (item) {\n          // if item not is in new value, remove\n          if (!files.find(function (file) {\n            return file.source === item.source || file.source === item.file;\n          })) {\n            dispatch('REMOVE_ITEM', {\n              query: item,\n              remove: false\n            });\n          }\n        });\n\n        // add new files\n        activeItems = getActiveItems(state.items);\n        files.forEach(function (file, index) {\n          // if file is already in list\n          if (activeItems.find(function (item) {\n            return item.source === file.source || item.file === file.source;\n          })) return;\n\n          // not in list, add\n          dispatch('ADD_ITEM', Object.assign({}, file, {\n            interactionMethod: InteractionMethod.NONE,\n            index: index\n          }));\n        });\n      },\n      DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {\n        var id = _ref3.id,\n          action = _ref3.action;\n\n        // if is called multiple times in close succession we combined all calls together to save resources\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(function () {\n          var item = getItemById(state.items, id);\n\n          // only revert and attempt to upload when we're uploading to a server\n          if (!query('IS_ASYNC')) {\n            // should we update the output data\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query,\n              action: action\n            }).then(function (shouldPrepareOutput) {\n              // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n              var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n              if (beforePrepareFile) shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n              if (!shouldPrepareOutput) return;\n              dispatch('REQUEST_PREPARE_OUTPUT', {\n                query: id,\n                item: item,\n                success: function success(file) {\n                  dispatch('DID_PREPARE_OUTPUT', {\n                    id: id,\n                    file: file\n                  });\n                }\n              }, true);\n            });\n            return;\n          }\n\n          // for async scenarios\n          var upload = function upload() {\n            // we push this forward a bit so the interface is updated correctly\n            setTimeout(function () {\n              dispatch('REQUEST_ITEM_PROCESSING', {\n                query: id\n              });\n            }, 32);\n          };\n          var revert = function revert(doUpload) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(doUpload ? upload : function () {}).catch(function () {});\n          };\n          var abort = function abort(doUpload) {\n            item.abortProcessing().then(doUpload ? upload : function () {});\n          };\n\n          // if we should re-upload the file immediately\n          if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n            return revert(state.options.instantUpload);\n          }\n\n          // if currently uploading, cancel upload\n          if (item.status === ItemStatus.PROCESSING) {\n            return abort(state.options.instantUpload);\n          }\n          if (state.options.instantUpload) {\n            upload();\n          }\n        }, 0);\n      },\n      MOVE_ITEM: function MOVE_ITEM(_ref4) {\n        var query = _ref4.query,\n          index = _ref4.index;\n        var item = getItemByQuery(state.items, query);\n        if (!item) return;\n        var currentIndex = state.items.indexOf(item);\n        index = limit(index, 0, state.items.length - 1);\n        if (currentIndex === index) return;\n        state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\n      },\n      SORT: function SORT(_ref5) {\n        var compare = _ref5.compare;\n        sortItems(state, compare);\n        dispatch('DID_SORT_ITEMS', {\n          items: query('GET_ACTIVE_ITEMS')\n        });\n      },\n      ADD_ITEMS: function ADD_ITEMS(_ref6) {\n        var items = _ref6.items,\n          index = _ref6.index,\n          interactionMethod = _ref6.interactionMethod,\n          _ref6$success = _ref6.success,\n          success = _ref6$success === void 0 ? function () {} : _ref6$success,\n          _ref6$failure = _ref6.failure,\n          failure = _ref6$failure === void 0 ? function () {} : _ref6$failure;\n        var currentIndex = index;\n        if (index === -1 || typeof index === 'undefined') {\n          var insertLocation = query('GET_ITEM_INSERT_LOCATION');\n          var totalItems = query('GET_TOTAL_ITEMS');\n          currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n        var ignoredFiles = query('GET_IGNORED_FILES');\n        var isValidFile = function isValidFile(source) {\n          return isFile(source) ? !ignoredFiles.includes(source.name.toLowerCase()) : !isEmpty(source);\n        };\n        var validItems = items.filter(isValidFile);\n        var promises = validItems.map(function (source) {\n          return new Promise(function (resolve, reject) {\n            dispatch('ADD_ITEM', {\n              interactionMethod: interactionMethod,\n              source: source.source || source,\n              success: resolve,\n              failure: reject,\n              index: currentIndex++,\n              options: source.options || {}\n            });\n          });\n        });\n        Promise.all(promises).then(success).catch(failure);\n      },\n      /**\n       * @param source\n       * @param index\n       * @param interactionMethod\n       */\n      ADD_ITEM: function ADD_ITEM(_ref7) {\n        var source = _ref7.source,\n          _ref7$index = _ref7.index,\n          index = _ref7$index === void 0 ? -1 : _ref7$index,\n          interactionMethod = _ref7.interactionMethod,\n          _ref7$success = _ref7.success,\n          success = _ref7$success === void 0 ? function () {} : _ref7$success,\n          _ref7$failure = _ref7.failure,\n          failure = _ref7$failure === void 0 ? function () {} : _ref7$failure,\n          _ref7$options = _ref7.options,\n          options = _ref7$options === void 0 ? {} : _ref7$options;\n\n        // if no source supplied\n        if (isEmpty(source)) {\n          failure({\n            error: createResponse('error', 0, 'No source'),\n            file: null\n          });\n          return;\n        }\n\n        // filter out invalid file items, used to filter dropped directory contents\n        if (isFile(source) && state.options.ignoredFiles.includes(source.name.toLowerCase())) {\n          // fail silently\n          return;\n        }\n\n        // test if there's still room in the list of files\n        if (!hasRoomForItem(state)) {\n          // if multiple allowed, we can't replace\n          // or if only a single item is allowed but we're not allowed to replace it we exit\n          if (state.options.allowMultiple || !state.options.allowMultiple && !state.options.allowReplace) {\n            var error = createResponse('warning', 0, 'Max files');\n            dispatch('DID_THROW_MAX_FILES', {\n              source: source,\n              error: error\n            });\n            failure({\n              error: error,\n              file: null\n            });\n            return;\n          }\n\n          // let's replace the item\n          // id of first item we're about to remove\n          var _item = getActiveItems(state.items)[0];\n\n          // if has been processed remove it from the server as well\n          if (_item.status === ItemStatus.PROCESSING_COMPLETE || _item.status === ItemStatus.PROCESSING_REVERT_ERROR) {\n            var forceRevert = query('GET_FORCE_REVERT');\n            _item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), forceRevert).then(function () {\n              if (!forceRevert) return;\n\n              // try to add now\n              dispatch('ADD_ITEM', {\n                source: source,\n                index: index,\n                interactionMethod: interactionMethod,\n                success: success,\n                failure: failure,\n                options: options\n              });\n            }).catch(function () {}); // no need to handle this catch state for now\n\n            if (forceRevert) return;\n          }\n\n          // remove first item as it will be replaced by this item\n          dispatch('REMOVE_ITEM', {\n            query: _item.id\n          });\n        }\n\n        // where did the file originate\n        var origin = options.type === 'local' ? FileOrigin.LOCAL : options.type === 'limbo' ? FileOrigin.LIMBO : FileOrigin.INPUT;\n\n        // create a new blank item\n        var item = createItem(\n        // where did this file come from\n        origin,\n        // an input file never has a server file reference\n        origin === FileOrigin.INPUT ? null : source,\n        // file mock data, if defined\n        options.file);\n\n        // set initial meta data\n        Object.keys(options.metadata || {}).forEach(function (key) {\n          item.setMetadata(key, options.metadata[key]);\n        });\n\n        // created the item, let plugins add methods\n        applyFilters('DID_CREATE_ITEM', item, {\n          query: query,\n          dispatch: dispatch\n        });\n\n        // where to insert new items\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        // adjust index if is not allowed to pick location\n        if (!state.options.itemInsertLocationFreedom) {\n          index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        }\n\n        // add item to list\n        insertItem(state.items, item, index);\n\n        // sort items in list\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        }\n\n        // get a quick reference to the item id\n        var id = item.id;\n\n        // observe item events\n        item.on('init', function () {\n          dispatch('DID_INIT_ITEM', {\n            id: id\n          });\n        });\n        item.on('load-init', function () {\n          dispatch('DID_START_ITEM_LOAD', {\n            id: id\n          });\n        });\n        item.on('load-meta', function () {\n          dispatch('DID_UPDATE_ITEM_META', {\n            id: id\n          });\n        });\n        item.on('load-progress', function (progress) {\n          dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n        item.on('load-request-error', function (error) {\n          var mainStatus = dynamicLabel(state.options.labelFileLoadError)(error);\n\n          // is client error, no way to recover\n          if (error.code >= 400 && error.code < 500) {\n            dispatch('DID_THROW_ITEM_INVALID', {\n              id: id,\n              error: error,\n              status: {\n                main: mainStatus,\n                sub: error.code + ' (' + error.body + ')'\n              }\n            });\n\n            // reject the file so can be dealt with through API\n            failure({\n              error: error,\n              file: createItemAPI(item)\n            });\n            return;\n          }\n\n          // is possible server error, so might be possible to retry\n          dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: mainStatus,\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('load-file-error', function (error) {\n          dispatch('DID_THROW_ITEM_INVALID', {\n            id: id,\n            error: error.status,\n            status: error.status\n          });\n          failure({\n            error: error.status,\n            file: createItemAPI(item)\n          });\n        });\n        item.on('load-abort', function () {\n          dispatch('REMOVE_ITEM', {\n            query: id\n          });\n        });\n        item.on('load-skip', function () {\n          dispatch('COMPLETE_LOAD_ITEM', {\n            query: id,\n            item: item,\n            data: {\n              source: source,\n              success: success\n            }\n          });\n        });\n        item.on('load', function () {\n          var handleAdd = function handleAdd(shouldAdd) {\n            // no should not add this file\n            if (!shouldAdd) {\n              dispatch('REMOVE_ITEM', {\n                query: id\n              });\n              return;\n            }\n\n            // now interested in metadata updates\n            item.on('metadata-update', function (change) {\n              dispatch('DID_UPDATE_ITEM_METADATA', {\n                id: id,\n                change: change\n              });\n            });\n\n            // let plugins decide if the output data should be prepared at this point\n            // means we'll do this and wait for idle state\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function (shouldPrepareOutput) {\n              // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n              var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n              if (beforePrepareFile) shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n              var loadComplete = function loadComplete() {\n                dispatch('COMPLETE_LOAD_ITEM', {\n                  query: id,\n                  item: item,\n                  data: {\n                    source: source,\n                    success: success\n                  }\n                });\n                listUpdated(dispatch, state);\n              };\n\n              // exit\n              if (shouldPrepareOutput) {\n                // wait for idle state and then run PREPARE_OUTPUT\n                dispatch('REQUEST_PREPARE_OUTPUT', {\n                  query: id,\n                  item: item,\n                  success: function success(file) {\n                    dispatch('DID_PREPARE_OUTPUT', {\n                      id: id,\n                      file: file\n                    });\n                    loadComplete();\n                  }\n                }, true);\n                return;\n              }\n              loadComplete();\n            });\n          };\n\n          // item loaded, allow plugins to\n          // - read data (quickly)\n          // - add metadata\n          applyFilterChain('DID_LOAD_ITEM', item, {\n            query: query,\n            dispatch: dispatch\n          }).then(function () {\n            optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(handleAdd);\n          }).catch(function () {\n            handleAdd(false);\n          });\n        });\n        item.on('process-start', function () {\n          dispatch('DID_START_ITEM_PROCESSING', {\n            id: id\n          });\n        });\n        item.on('process-progress', function (progress) {\n          dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n        item.on('process-error', function (error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('process-revert-error', function (error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('process-complete', function (serverFileReference) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: id,\n            error: null,\n            serverFileReference: serverFileReference\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: id,\n            value: serverFileReference\n          });\n        });\n        item.on('process-abort', function () {\n          dispatch('DID_ABORT_ITEM_PROCESSING', {\n            id: id\n          });\n        });\n        item.on('process-revert', function () {\n          dispatch('DID_REVERT_ITEM_PROCESSING', {\n            id: id\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: id,\n            value: null\n          });\n        });\n\n        // let view know the item has been inserted\n        dispatch('DID_ADD_ITEM', {\n          id: id,\n          index: index,\n          interactionMethod: interactionMethod\n        });\n        listUpdated(dispatch, state);\n\n        // start loading the source\n        var _ref8 = state.options.server || {},\n          url = _ref8.url,\n          load = _ref8.load,\n          restore = _ref8.restore,\n          fetch = _ref8.fetch;\n        item.load(source,\n        // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n        createFileLoader(origin === FileOrigin.INPUT ?\n        // input, if is remote, see if should use custom fetch, else use default fetchBlob\n        isString(source) && isExternalURL(source) ? fetch ? createFetchFunction(url, fetch) : fetchBlob // remote url\n        : fetchBlob // try to fetch url\n        :\n        // limbo or local\n        origin === FileOrigin.LIMBO ? createFetchFunction(url, restore) // limbo\n        : createFetchFunction(url, load) // local\n        ),\n        // called when the file is loaded so it can be piped through the filters\n        function (file, success, error) {\n          // let's process the file\n          applyFilterChain('LOAD_FILE', file, {\n            query: query\n          }).then(success).catch(error);\n        });\n      },\n      REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref9) {\n        var item = _ref9.item,\n          success = _ref9.success,\n          _ref9$failure = _ref9.failure,\n          failure = _ref9$failure === void 0 ? function () {} : _ref9$failure;\n\n        // error response if item archived\n        var err = {\n          error: createResponse('error', 0, 'Item not found'),\n          file: null\n        };\n\n        // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n        if (item.archived) return failure(err);\n\n        // allow plugins to alter the file data\n        applyFilterChain('PREPARE_OUTPUT', item.file, {\n          query: query,\n          item: item\n        }).then(function (result) {\n          applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {\n            query: query,\n            item: item\n          }).then(function (result) {\n            // don't handle archived items, an item could have been archived (load aborted) while being prepared\n            if (item.archived) return failure(err);\n\n            // we done!\n            success(result);\n          });\n        });\n      },\n      COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref10) {\n        var item = _ref10.item,\n          data = _ref10.data;\n        var success = data.success,\n          source = data.source;\n\n        // sort items in list\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        }\n\n        // let interface know the item has loaded\n        dispatch('DID_LOAD_ITEM', {\n          id: item.id,\n          error: null,\n          serverFileReference: item.origin === FileOrigin.INPUT ? null : source\n        });\n\n        // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n        success(createItemAPI(item));\n\n        // if this is a local server file we need to show a different state\n        if (item.origin === FileOrigin.LOCAL) {\n          dispatch('DID_LOAD_LOCAL_ITEM', {\n            id: item.id\n          });\n          return;\n        }\n\n        // if is a temp server file we prevent async upload call here (as the file is already on the server)\n        if (item.origin === FileOrigin.LIMBO) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: item.id,\n            error: null,\n            serverFileReference: source\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: item.id,\n            value: source\n          });\n          return;\n        }\n\n        // id we are allowed to upload the file immediately, lets do it\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n          dispatch('REQUEST_ITEM_PROCESSING', {\n            query: item.id\n          });\n        }\n      },\n      RETRY_ITEM_LOAD: getItemByQueryFromState(state, function (item) {\n        // try loading the source one more time\n        item.retryLoad();\n      }),\n      REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, function (item, _success, failure) {\n        dispatch('REQUEST_PREPARE_OUTPUT', {\n          query: item.id,\n          item: item,\n          success: function success(file) {\n            dispatch('DID_PREPARE_OUTPUT', {\n              id: item.id,\n              file: file\n            });\n            _success({\n              file: item,\n              output: file\n            });\n          },\n          failure: failure\n        }, true);\n      }),\n      REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function (item, success, failure) {\n        // cannot be queued (or is already queued)\n        var itemCanBeQueuedForProcessing =\n        // waiting for something\n        item.status === ItemStatus.IDLE ||\n        // processing went wrong earlier\n        item.status === ItemStatus.PROCESSING_ERROR;\n\n        // not ready to be processed\n        if (!itemCanBeQueuedForProcessing) {\n          var processNow = function processNow() {\n            return dispatch('REQUEST_ITEM_PROCESSING', {\n              query: item,\n              success: success,\n              failure: failure\n            });\n          };\n          var process = function process() {\n            return document.hidden ? processNow() : setTimeout(processNow, 32);\n          };\n\n          // if already done processing or tried to revert but didn't work, try again\n          if (item.status === ItemStatus.PROCESSING_COMPLETE || item.status === ItemStatus.PROCESSING_REVERT_ERROR) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(process).catch(function () {}); // don't continue with processing if something went wrong\n          } else if (item.status === ItemStatus.PROCESSING) {\n            item.abortProcessing().then(process);\n          }\n          return;\n        }\n\n        // already queued for processing\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n        item.requestProcessing();\n        dispatch('DID_REQUEST_ITEM_PROCESSING', {\n          id: item.id\n        });\n        dispatch('PROCESS_ITEM', {\n          query: item,\n          success: success,\n          failure: failure\n        }, true);\n      }),\n      PROCESS_ITEM: getItemByQueryFromState(state, function (item, success, failure) {\n        var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        var totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING).length;\n\n        // queue and wait till queue is freed up\n        if (totalCurrentUploads === maxParallelUploads) {\n          // queue for later processing\n          state.processingQueue.push({\n            id: item.id,\n            success: success,\n            failure: failure\n          });\n\n          // stop it!\n          return;\n        }\n\n        // if was not queued or is already processing exit here\n        if (item.status === ItemStatus.PROCESSING) return;\n        var processNext = function processNext() {\n          // process queueud items\n          var queueEntry = state.processingQueue.shift();\n\n          // no items left\n          if (!queueEntry) return;\n\n          // get item reference\n          var id = queueEntry.id,\n            success = queueEntry.success,\n            failure = queueEntry.failure;\n          var itemReference = getItemByQuery(state.items, id);\n\n          // if item was archived while in queue, jump to next\n          if (!itemReference || itemReference.archived) {\n            processNext();\n            return;\n          }\n\n          // process queued item\n          dispatch('PROCESS_ITEM', {\n            query: id,\n            success: success,\n            failure: failure\n          }, true);\n        };\n\n        // we done function\n        item.onOnce('process-complete', function () {\n          success(createItemAPI(item));\n          processNext();\n\n          // All items processed? No errors?\n          var allItemsProcessed = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length === state.items.length;\n          if (allItemsProcessed) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n          }\n        });\n\n        // we error function\n        item.onOnce('process-error', function (error) {\n          failure({\n            error: error,\n            file: createItemAPI(item)\n          });\n          processNext();\n        });\n\n        // start file processing\n        var options = state.options;\n        item.process(createFileProcessor(createProcessorFunction(options.server.url, options.server.process, options.name, {\n          chunkTransferId: item.transferId,\n          chunkServer: options.server.patch,\n          chunkUploads: options.chunkUploads,\n          chunkForce: options.chunkForce,\n          chunkSize: options.chunkSize,\n          chunkRetryDelays: options.chunkRetryDelays\n        })),\n        // called when the file is about to be processed so it can be piped through the transform filters\n        function (file, success, error) {\n          // allow plugins to alter the file data\n          applyFilterChain('PREPARE_OUTPUT', file, {\n            query: query,\n            item: item\n          }).then(function (file) {\n            dispatch('DID_PREPARE_OUTPUT', {\n              id: item.id,\n              file: file\n            });\n            success(file);\n          }).catch(error);\n        });\n      }),\n      RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        dispatch('REQUEST_ITEM_PROCESSING', {\n          query: item\n        });\n      }),\n      REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function (item) {\n        optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(function (shouldRemove) {\n          if (!shouldRemove) {\n            return;\n          }\n          dispatch('REMOVE_ITEM', {\n            query: item\n          });\n        });\n      }),\n      RELEASE_ITEM: getItemByQueryFromState(state, function (item) {\n        item.release();\n      }),\n      REMOVE_ITEM: getItemByQueryFromState(state, function (item, success, failure, options) {\n        var removeFromView = function removeFromView() {\n          // get id reference\n          var id = item.id;\n\n          // archive the item, this does not remove it from the list\n          getItemById(state.items, id).archive();\n\n          // tell the view the item has been removed\n          dispatch('DID_REMOVE_ITEM', {\n            error: null,\n            id: id,\n            item: item\n          });\n\n          // now the list has been modified\n          listUpdated(dispatch, state);\n\n          // correctly removed\n          success(createItemAPI(item));\n        };\n\n        // if this is a local file and the server.remove function has been configured, send source there so dev can remove file from server\n        var server = state.options.server;\n        if (item.origin === FileOrigin.LOCAL && server && isFunction(server.remove) && options.remove !== false) {\n          dispatch('DID_START_ITEM_REMOVE', {\n            id: item.id\n          });\n          server.remove(item.source, function () {\n            return removeFromView();\n          }, function (status) {\n            dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n              id: item.id,\n              error: createResponse('error', 0, status, null),\n              status: {\n                main: dynamicLabel(state.options.labelFileRemoveError)(status),\n                sub: state.options.labelTapToRetry\n              }\n            });\n          });\n        } else {\n          // if is requesting revert and can revert need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\n          if (options.revert && item.origin !== FileOrigin.LOCAL && item.serverId !== null) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT'));\n          }\n\n          // can now safely remove from view\n          removeFromView();\n        }\n      }),\n      ABORT_ITEM_LOAD: getItemByQueryFromState(state, function (item) {\n        item.abortLoad();\n      }),\n      ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        // test if is already processed\n        if (item.serverId) {\n          dispatch('REVERT_ITEM_PROCESSING', {\n            id: item.id\n          });\n          return;\n        }\n\n        // abort\n        item.abortProcessing().then(function () {\n          var shouldRemove = state.options.instantUpload;\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', {\n              query: item.id\n            });\n          }\n        });\n      }),\n      REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        // not instant uploading, revert immediately\n        if (!state.options.instantUpload) {\n          dispatch('REVERT_ITEM_PROCESSING', {\n            query: item\n          });\n          return;\n        }\n\n        // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n        var handleRevert = function handleRevert(shouldRevert) {\n          if (!shouldRevert) return;\n          dispatch('REVERT_ITEM_PROCESSING', {\n            query: item\n          });\n        };\n        var fn = query('GET_BEFORE_REMOVE_FILE');\n        if (!fn) {\n          return handleRevert(true);\n        }\n        var requestRemoveResult = fn(createItemAPI(item));\n        if (requestRemoveResult == null) {\n          // undefined or null\n          return handleRevert(true);\n        }\n        if (typeof requestRemoveResult === 'boolean') {\n          return handleRevert(requestRemoveResult);\n        }\n        if (typeof requestRemoveResult.then === 'function') {\n          requestRemoveResult.then(handleRevert);\n        }\n      }),\n      REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(function () {\n          var shouldRemove = state.options.instantUpload || isMockItem(item);\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', {\n              query: item.id\n            });\n          }\n        }).catch(function () {});\n      }),\n      SET_OPTIONS: function SET_OPTIONS(_ref11) {\n        var options = _ref11.options;\n        forin(options, function (key, value) {\n          dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        });\n      }\n    };\n  };\n  var formatFilename = function formatFilename(name) {\n    return name;\n  };\n  var createElement$1 = function createElement(tagName) {\n    return document.createElement(tagName);\n  };\n  var text = function text(node, value) {\n    var textNode = node.childNodes[0];\n    if (!textNode) {\n      textNode = document.createTextNode(value);\n      node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n      textNode.nodeValue = value;\n    }\n  };\n  var polarToCartesian = function polarToCartesian(centerX, centerY, radius, angleInDegrees) {\n    var angleInRadians = (angleInDegrees % 360 - 90) * Math.PI / 180.0;\n    return {\n      x: centerX + radius * Math.cos(angleInRadians),\n      y: centerY + radius * Math.sin(angleInRadians)\n    };\n  };\n  var describeArc = function describeArc(x, y, radius, startAngle, endAngle, arcSweep) {\n    var start = polarToCartesian(x, y, radius, endAngle);\n    var end = polarToCartesian(x, y, radius, startAngle);\n    return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\n  };\n  var percentageArc = function percentageArc(x, y, radius, from, to) {\n    var arcSweep = 1;\n    if (to > from && to - from <= 0.5) {\n      arcSweep = 0;\n    }\n    if (from > to && from - to >= 0.5) {\n      arcSweep = 0;\n    }\n    return describeArc(x, y, radius, Math.min(0.9999, from) * 360, Math.min(0.9999, to) * 360, arcSweep);\n  };\n  var create = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // start at 0\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0;\n\n    // svg\n    var svg = createElement('svg');\n    root.ref.path = createElement('path', {\n      'stroke-width': 2,\n      'stroke-linecap': 'round'\n    });\n    svg.appendChild(root.ref.path);\n    root.ref.svg = svg;\n    root.appendChild(svg);\n  };\n  var write = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    if (props.opacity === 0) {\n      return;\n    }\n    if (props.align) {\n      root.element.dataset.align = props.align;\n    }\n\n    // get width of stroke\n    var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);\n\n    // calculate size of ring\n    var size = root.rect.element.width * 0.5;\n\n    // ring state\n    var ringFrom = 0;\n    var ringTo = 0;\n\n    // now in busy mode\n    if (props.spin) {\n      ringFrom = 0;\n      ringTo = 0.5;\n    } else {\n      ringFrom = 0;\n      ringTo = props.progress;\n    }\n\n    // get arc path\n    var coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo);\n\n    // update progress bar\n    attr(root.ref.path, 'd', coordinates);\n\n    // hide while contains 0 value\n    attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);\n  };\n  var progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create: create,\n    write: write,\n    mixins: {\n      apis: ['progress', 'spin', 'align'],\n      styles: ['opacity'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 500\n        },\n        progress: {\n          type: 'spring',\n          stiffness: 0.95,\n          damping: 0.65,\n          mass: 10\n        }\n      }\n    }\n  });\n  var create$1 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.element.innerHTML = (props.icon || '') + ('<span>' + props.label + '</span>');\n    props.isDisabled = false;\n  };\n  var write$1 = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    var isDisabled = props.isDisabled;\n    var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n    if (shouldDisable && !isDisabled) {\n      props.isDisabled = true;\n      attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n      props.isDisabled = false;\n      root.element.removeAttribute('disabled');\n    }\n  };\n  var fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n      type: 'button'\n    },\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n      apis: ['label'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      },\n      listeners: true\n    },\n    create: create$1,\n    write: write$1\n  });\n  var toNaturalFileSize = function toNaturalFileSize(bytes) {\n    var decimalSeparator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.';\n    var base = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1000;\n    // no negative byte sizes\n    bytes = Math.round(Math.abs(bytes));\n    var KB = base;\n    var MB = base * base;\n    var GB = base * base * base;\n\n    // just bytes\n    if (bytes < KB) {\n      return bytes + ' bytes';\n    }\n\n    // kilobytes\n    if (bytes < MB) {\n      return Math.floor(bytes / KB) + ' KB';\n    }\n\n    // megabytes\n    if (bytes < GB) {\n      return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' MB';\n    }\n\n    // gigabytes\n    return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' GB';\n  };\n  var removeDecimalsWhenZero = function removeDecimalsWhenZero(value, decimalCount, separator) {\n    return value.toFixed(decimalCount).split('.').filter(function (part) {\n      return part !== '0';\n    }).join(separator);\n  };\n  var create$2 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // filename\n    var fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main';\n    // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName;\n\n    // filesize\n    var fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize;\n\n    // set initial values\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n  var updateFile = function updateFile(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    text(root.ref.fileSize, toNaturalFileSize(root.query('GET_ITEM_SIZE', props.id), '.', root.query('GET_FILE_SIZE_BASE')));\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n  var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {\n    var root = _ref3.root,\n      props = _ref3.props;\n    // if size is available don't fallback to unknown size message\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n      return;\n    }\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n  };\n  var fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: updateFile,\n      DID_UPDATE_ITEM_META: updateFile,\n      DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n      DID_THROW_ITEM_INVALID: updateFileSizeOnError\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    create: create$2,\n    mixins: {\n      styles: ['translateX', 'translateY'],\n      animations: {\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n  var toPercentage = function toPercentage(value) {\n    return Math.round(value * 100);\n  };\n  var create$3 = function create(_ref) {\n    var root = _ref.root;\n\n    // main status\n    var main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main;\n\n    // sub status\n    var sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n    didSetItemLoadProgress({\n      root: root,\n      action: {\n        progress: null\n      }\n    });\n  };\n  var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    var title = action.progress === null ? root.query('GET_LABEL_FILE_LOADING') : root.query('GET_LABEL_FILE_LOADING') + ' ' + toPercentage(action.progress) + '%';\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n  var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var title = action.progress === null ? root.query('GET_LABEL_FILE_PROCESSING') : root.query('GET_LABEL_FILE_PROCESSING') + ' ' + toPercentage(action.progress) + '%';\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n  var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {\n    var root = _ref4.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n  var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {\n    var root = _ref5.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n  };\n  var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {\n    var root = _ref6.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n  };\n  var clear = function clear(_ref7) {\n    var root = _ref7.root;\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n  };\n  var error = function error(_ref8) {\n    var root = _ref8.root,\n      action = _ref8.action;\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n  };\n  var fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: clear,\n      DID_REVERT_ITEM_PROCESSING: clear,\n      DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n      DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n      DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n      DID_THROW_ITEM_LOAD_ERROR: error,\n      DID_THROW_ITEM_INVALID: error,\n      DID_THROW_ITEM_PROCESSING_ERROR: error,\n      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n      DID_THROW_ITEM_REMOVE_ERROR: error\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    create: create$3,\n    mixins: {\n      styles: ['translateX', 'translateY', 'opacity'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 250\n        },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  /**\n   * Button definitions for the file view\n   */\n\n  var Buttons = {\n    AbortItemLoad: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n      action: 'ABORT_ITEM_LOAD',\n      className: 'filepond--action-abort-item-load',\n      align: 'LOAD_INDICATOR_POSITION' // right\n    },\n\n    RetryItemLoad: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n      action: 'RETRY_ITEM_LOAD',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-load',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n\n    RemoveItem: {\n      label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n      action: 'REQUEST_REMOVE_ITEM',\n      icon: 'GET_ICON_REMOVE',\n      className: 'filepond--action-remove-item',\n      align: 'BUTTON_REMOVE_ITEM_POSITION' // left\n    },\n\n    ProcessItem: {\n      label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n      action: 'REQUEST_ITEM_PROCESSING',\n      icon: 'GET_ICON_PROCESS',\n      className: 'filepond--action-process-item',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n\n    AbortItemProcessing: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n      action: 'ABORT_ITEM_PROCESSING',\n      className: 'filepond--action-abort-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n\n    RetryItemProcessing: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n      action: 'RETRY_ITEM_PROCESSING',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n\n    RevertItemProcessing: {\n      label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n      action: 'REQUEST_REVERT_ITEM_PROCESSING',\n      icon: 'GET_ICON_UNDO',\n      className: 'filepond--action-revert-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    }\n  };\n\n  // make a list of buttons, we can then remove buttons from this list if they're disabled\n  var ButtonKeys = [];\n  forin(Buttons, function (key) {\n    ButtonKeys.push(key);\n  });\n  var calculateFileInfoOffset = function calculateFileInfoOffset(root) {\n    var buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n  };\n  var calculateButtonWidth = function calculateButtonWidth(root) {\n    var buttonRect = root.ref.buttonAbortItemLoad.rect.element;\n    return buttonRect.width;\n  };\n\n  // Force on full pixels so text stays crips\n  var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(root) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\n  };\n  var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(root) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n  };\n  var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {\n    return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\n  };\n  var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(root) {\n    return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\n  };\n  var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {\n    return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n  };\n  var DefaultStyle = {\n    buttonAbortItemLoad: {\n      opacity: 0\n    },\n    buttonRetryItemLoad: {\n      opacity: 0\n    },\n    buttonRemoveItem: {\n      opacity: 0\n    },\n    buttonProcessItem: {\n      opacity: 0\n    },\n    buttonAbortItemProcessing: {\n      opacity: 0\n    },\n    buttonRetryItemProcessing: {\n      opacity: 0\n    },\n    buttonRevertItemProcessing: {\n      opacity: 0\n    },\n    loadProgressIndicator: {\n      opacity: 0,\n      align: getLoadIndicatorAlignment\n    },\n    processProgressIndicator: {\n      opacity: 0,\n      align: getProcessIndicatorAlignment\n    },\n    processingCompleteIndicator: {\n      opacity: 0,\n      scaleX: 0.75,\n      scaleY: 0.75\n    },\n    info: {\n      translateX: 0,\n      translateY: 0,\n      opacity: 0\n    },\n    status: {\n      translateX: 0,\n      translateY: 0,\n      opacity: 0\n    }\n  };\n  var IdleStyle = {\n    buttonRemoveItem: {\n      opacity: 1\n    },\n    buttonProcessItem: {\n      opacity: 1\n    },\n    info: {\n      translateX: calculateFileInfoOffset\n    },\n    status: {\n      translateX: calculateFileInfoOffset\n    }\n  };\n  var ProcessingStyle = {\n    buttonAbortItemProcessing: {\n      opacity: 1\n    },\n    processProgressIndicator: {\n      opacity: 1\n    },\n    status: {\n      opacity: 1\n    }\n  };\n  var StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        translateX: calculateFileInfoOffset,\n        opacity: 1\n      }\n    },\n    DID_START_ITEM_LOAD: {\n      buttonAbortItemLoad: {\n        opacity: 1\n      },\n      loadProgressIndicator: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_THROW_ITEM_LOAD_ERROR: {\n      buttonRetryItemLoad: {\n        opacity: 1\n      },\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_START_ITEM_REMOVE: {\n      processProgressIndicator: {\n        opacity: 1,\n        align: getRemoveIndicatorAligment\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 0\n      }\n    },\n    DID_THROW_ITEM_REMOVE_ERROR: {\n      processProgressIndicator: {\n        opacity: 0,\n        align: getRemoveIndicatorAligment\n      },\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1,\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n      buttonRevertItemProcessing: {\n        opacity: 1\n      },\n      info: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      buttonRetryItemProcessing: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n      buttonRevertItemProcessing: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      },\n      info: {\n        opacity: 1\n      }\n    },\n    DID_ABORT_ITEM_PROCESSING: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      buttonProcessItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_REVERT_ITEM_PROCESSING: IdleStyle\n  };\n\n  // complete indicator view\n  var processingCompleteIndicatorView = createView({\n    create: function create(_ref) {\n      var root = _ref.root;\n      root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n      styles: ['scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      }\n    }\n  });\n\n  /**\n   * Creates the file view\n   */\n  var create$4 = function create(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    var id = props.id;\n\n    // allow reverting upload\n    var allowRevert = root.query('GET_ALLOW_REVERT');\n\n    // allow remove file\n    var allowRemove = root.query('GET_ALLOW_REMOVE');\n\n    // allow processing upload\n    var allowProcess = root.query('GET_ALLOW_PROCESS');\n\n    // is instant uploading, need this to determine the icon of the undo button\n    var instantUpload = root.query('GET_INSTANT_UPLOAD');\n\n    // is async set up\n    var isAsync = root.query('IS_ASYNC');\n\n    // should align remove item buttons\n    var alignRemoveItemButton = root.query('GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN');\n\n    // enabled buttons array\n    var buttonFilter;\n    if (isAsync) {\n      if (allowProcess && !allowRevert) {\n        // only remove revert button\n        buttonFilter = function buttonFilter(key) {\n          return !/RevertItemProcessing/.test(key);\n        };\n      } else if (!allowProcess && allowRevert) {\n        // only remove process button\n        buttonFilter = function buttonFilter(key) {\n          return !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);\n        };\n      } else if (!allowProcess && !allowRevert) {\n        // remove all process buttons\n        buttonFilter = function buttonFilter(key) {\n          return !/Process/.test(key);\n        };\n      }\n    } else {\n      // no process controls available\n      buttonFilter = function buttonFilter(key) {\n        return !/Process/.test(key);\n      };\n    }\n    var enabledButtons = buttonFilter ? ButtonKeys.filter(buttonFilter) : ButtonKeys.concat();\n\n    // update icon and label for revert button when instant uploading\n    if (instantUpload && allowRevert) {\n      Buttons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n      Buttons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    }\n\n    // remove last button (revert) if not allowed\n    if (isAsync && !allowRevert) {\n      var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      map.info.translateX = calculateFileHorizontalCenterOffset;\n      map.info.translateY = calculateFileVerticalCenterOffset;\n      map.status.translateY = calculateFileVerticalCenterOffset;\n      map.processingCompleteIndicator = {\n        opacity: 1,\n        scaleX: 1,\n        scaleY: 1\n      };\n    }\n\n    // should align center\n    if (isAsync && !allowProcess) {\n      ['DID_START_ITEM_PROCESSING', 'DID_REQUEST_ITEM_PROCESSING', 'DID_UPDATE_ITEM_PROCESS_PROGRESS', 'DID_THROW_ITEM_PROCESSING_ERROR'].forEach(function (key) {\n        StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;\n      });\n      StyleMap['DID_THROW_ITEM_PROCESSING_ERROR'].status.translateX = calculateButtonWidth;\n    }\n\n    // move remove button to right\n    if (alignRemoveItemButton && allowRevert) {\n      Buttons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\n      var _map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      _map.info.translateX = calculateFileInfoOffset;\n      _map.status.translateY = calculateFileVerticalCenterOffset;\n      _map.processingCompleteIndicator = {\n        opacity: 1,\n        scaleX: 1,\n        scaleY: 1\n      };\n    }\n    if (!allowRemove) {\n      Buttons['RemoveItem'].disabled = true;\n    }\n\n    // create the button views\n    forin(Buttons, function (key, definition) {\n      // create button\n      var buttonView = root.createChildView(fileActionButton, {\n        label: root.query(definition.label),\n        icon: root.query(definition.icon),\n        opacity: 0\n      });\n\n      // should be appended?\n      if (enabledButtons.includes(key)) {\n        root.appendChildView(buttonView);\n      }\n\n      // toggle\n      if (definition.disabled) {\n        buttonView.element.setAttribute('disabled', 'disabled');\n        buttonView.element.setAttribute('hidden', 'hidden');\n      }\n\n      // add position attribute\n      buttonView.element.dataset.align = root.query('GET_STYLE_' + definition.align);\n\n      // add class\n      buttonView.element.classList.add(definition.className);\n\n      // handle interactions\n      buttonView.on('click', function (e) {\n        e.stopPropagation();\n        if (definition.disabled) return;\n        root.dispatch(definition.action, {\n          query: id\n        });\n      });\n\n      // set reference\n      root.ref['button' + key] = buttonView;\n    });\n\n    // checkmark\n    root.ref.processingCompleteIndicator = root.appendChildView(root.createChildView(processingCompleteIndicatorView));\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query('GET_STYLE_BUTTON_PROCESS_ITEM_POSITION');\n\n    // create file info view\n    root.ref.info = root.appendChildView(root.createChildView(fileInfo, {\n      id: id\n    }));\n\n    // create file status view\n    root.ref.status = root.appendChildView(root.createChildView(fileStatus, {\n      id: id\n    }));\n\n    // add progress indicators\n    var loadIndicatorView = root.appendChildView(root.createChildView(progressIndicator, {\n      opacity: 0,\n      align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION')\n    }));\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n    var progressIndicatorView = root.appendChildView(root.createChildView(progressIndicator, {\n      opacity: 0,\n      align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION')\n    }));\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView;\n\n    // current active styles\n    root.ref.activeStyles = [];\n  };\n  var write$2 = function write(_ref3) {\n    var root = _ref3.root,\n      actions = _ref3.actions,\n      props = _ref3.props;\n\n    // route actions\n    route({\n      root: root,\n      actions: actions,\n      props: props\n    });\n\n    // select last state change action\n    var action = actions.concat().filter(function (action) {\n      return /^DID_/.test(action.type);\n    }).reverse().find(function (action) {\n      return StyleMap[action.type];\n    });\n\n    // a new action happened, let's get the matching styles\n    if (action) {\n      // define new active styles\n      root.ref.activeStyles = [];\n      var stylesToApply = StyleMap[action.type];\n      forin(DefaultStyle, function (name, defaultStyles) {\n        // get reference to control\n        var control = root.ref[name];\n\n        // loop over all styles for this control\n        forin(defaultStyles, function (key, defaultValue) {\n          var value = stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined' ? stylesToApply[name][key] : defaultValue;\n          root.ref.activeStyles.push({\n            control: control,\n            key: key,\n            value: value\n          });\n        });\n      });\n    }\n\n    // apply active styles to element\n    root.ref.activeStyles.forEach(function (_ref4) {\n      var control = _ref4.control,\n        key = _ref4.key,\n        value = _ref4.value;\n      control[key] = typeof value === 'function' ? value(root) : value;\n    });\n  };\n  var route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(_ref5) {\n      var root = _ref5.root,\n        action = _ref5.action;\n      root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(_ref6) {\n      var root = _ref6.root,\n        action = _ref6.action;\n      root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(_ref7) {\n      var root = _ref7.root,\n        action = _ref7.action;\n      root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {\n      var root = _ref8.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {\n      var root = _ref9.root;\n      root.ref.loadProgressIndicator.spin = true;\n      root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {\n      var root = _ref10.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(_ref11) {\n      var root = _ref11.root,\n        action = _ref11.action;\n      root.ref.loadProgressIndicator.spin = false;\n      root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(_ref12) {\n      var root = _ref12.root,\n        action = _ref12.action;\n      root.ref.processProgressIndicator.spin = false;\n      root.ref.processProgressIndicator.progress = action.progress;\n    }\n  });\n  var file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    name: 'file'\n  });\n\n  /**\n   * Creates the file view\n   */\n  var create$5 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // filename\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName);\n\n    // file appended\n    root.ref.file = root.appendChildView(root.createChildView(file, {\n      id: props.id\n    }));\n\n    // data has moved to data.js\n    root.ref.data = false;\n  };\n\n  /**\n   * Data storage\n   */\n  var didLoadItem = function didLoadItem(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    // updates the legend of the fieldset so screenreaders can better group buttons\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n  var fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n      DID_LOAD_ITEM: didLoadItem\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper'\n  });\n  var PANEL_SPRING_PROPS = {\n    type: 'spring',\n    damping: 0.6,\n    mass: 7\n  };\n  var create$6 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    [{\n      name: 'top'\n    }, {\n      name: 'center',\n      props: {\n        translateY: null,\n        scaleY: null\n      },\n      mixins: {\n        animations: {\n          scaleY: PANEL_SPRING_PROPS\n        },\n        styles: ['translateY', 'scaleY']\n      }\n    }, {\n      name: 'bottom',\n      props: {\n        translateY: null\n      },\n      mixins: {\n        animations: {\n          translateY: PANEL_SPRING_PROPS\n        },\n        styles: ['translateY']\n      }\n    }].forEach(function (section) {\n      createSection(root, section, props.name);\n    });\n    root.element.classList.add('filepond--' + props.name);\n    root.ref.scalable = null;\n  };\n  var createSection = function createSection(root, section, className) {\n    var viewConstructor = createView({\n      name: 'panel-' + section.name + ' filepond--' + className,\n      mixins: section.mixins,\n      ignoreRectUpdate: true\n    });\n    var view = root.createChildView(viewConstructor, section.props);\n    root.ref[section.name] = root.appendChildView(view);\n  };\n  var write$3 = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n\n    // update scalable state\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n      root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n      root.element.dataset.scalable = root.ref.scalable;\n    }\n\n    // no height, can't set\n    if (!props.height) return;\n\n    // get child rects\n    var topRect = root.ref.top.rect.element;\n    var bottomRect = root.ref.bottom.rect.element;\n\n    // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n    var height = Math.max(topRect.height + bottomRect.height, props.height);\n\n    // offset center part\n    root.ref.center.translateY = topRect.height;\n\n    // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n    root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100;\n\n    // offset bottom part\n    root.ref.bottom.translateY = height - bottomRect.height;\n  };\n  var panel = createView({\n    name: 'panel',\n    read: function read(_ref3) {\n      var root = _ref3.root,\n        props = _ref3.props;\n      return props.heightCurrent = root.ref.bottom.translateY;\n    },\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n      apis: ['height', 'heightCurrent', 'scalable']\n    }\n  });\n  var createDragHelper = function createDragHelper(items) {\n    var itemIds = items.map(function (item) {\n      return item.id;\n    });\n    var prevIndex = undefined;\n    return {\n      setIndex: function setIndex(index) {\n        prevIndex = index;\n      },\n      getIndex: function getIndex() {\n        return prevIndex;\n      },\n      getItemIndex: function getItemIndex(item) {\n        return itemIds.indexOf(item.id);\n      }\n    };\n  };\n  var ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10\n  };\n  var ITEM_SCALE_SPRING = 'spring';\n  var StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy processing',\n    DID_REQUEST_ITEM_PROCESSING: 'busy processing',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle'\n  };\n\n  /**\n   * Creates the file view\n   */\n  var create$7 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // select\n    root.ref.handleClick = function (e) {\n      return root.dispatch('DID_ACTIVATE_ITEM', {\n        id: props.id\n      });\n    };\n\n    // set id\n    root.element.id = 'filepond--item-' + props.id;\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // file view\n    root.ref.container = root.appendChildView(root.createChildView(fileWrapper, {\n      id: props.id\n    }));\n\n    // file panel\n    root.ref.panel = root.appendChildView(root.createChildView(panel, {\n      name: 'item-panel'\n    }));\n\n    // default start height\n    root.ref.panel.height = null;\n\n    // by default not marked for removal\n    props.markedForRemoval = false;\n\n    // if not allowed to reorder file items, exit here\n    if (!root.query('GET_ALLOW_REORDER')) return;\n\n    // set to idle so shows grab cursor\n    root.element.dataset.dragState = 'idle';\n    var grab = function grab(e) {\n      if (!e.isPrimary) return;\n      var removedActivateListener = false;\n      var origin = {\n        x: e.pageX,\n        y: e.pageY\n      };\n      props.dragOrigin = {\n        x: root.translateX,\n        y: root.translateY\n      };\n      props.dragCenter = {\n        x: e.offsetX,\n        y: e.offsetY\n      };\n      var dragState = createDragHelper(root.query('GET_ACTIVE_ITEMS'));\n      root.dispatch('DID_GRAB_ITEM', {\n        id: props.id,\n        dragState: dragState\n      });\n      var drag = function drag(e) {\n        if (!e.isPrimary) return;\n        e.stopPropagation();\n        e.preventDefault();\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        };\n\n        // if dragged stop listening to clicks, will re-add when done dragging\n        var dist = props.dragOffset.x * props.dragOffset.x + props.dragOffset.y * props.dragOffset.y;\n        if (dist > 16 && !removedActivateListener) {\n          removedActivateListener = true;\n          root.element.removeEventListener('click', root.ref.handleClick);\n        }\n        root.dispatch('DID_DRAG_ITEM', {\n          id: props.id,\n          dragState: dragState\n        });\n      };\n      var drop = function drop(e) {\n        if (!e.isPrimary) return;\n        document.removeEventListener('pointermove', drag);\n        document.removeEventListener('pointerup', drop);\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        };\n        root.dispatch('DID_DROP_ITEM', {\n          id: props.id,\n          dragState: dragState\n        });\n\n        // start listening to clicks again\n        if (removedActivateListener) {\n          setTimeout(function () {\n            return root.element.addEventListener('click', root.ref.handleClick);\n          }, 0);\n        }\n      };\n      document.addEventListener('pointermove', drag);\n      document.addEventListener('pointerup', drop);\n    };\n    root.element.addEventListener('pointerdown', grab);\n  };\n  var route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {\n      var root = _ref2.root,\n        action = _ref2.action;\n      root.height = action.height;\n    }\n  });\n  var write$4 = createRoute({\n    DID_GRAB_ITEM: function DID_GRAB_ITEM(_ref3) {\n      var root = _ref3.root,\n        props = _ref3.props;\n      props.dragOrigin = {\n        x: root.translateX,\n        y: root.translateY\n      };\n    },\n    DID_DRAG_ITEM: function DID_DRAG_ITEM(_ref4) {\n      var root = _ref4.root;\n      root.element.dataset.dragState = 'drag';\n    },\n    DID_DROP_ITEM: function DID_DROP_ITEM(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      props.dragOffset = null;\n      props.dragOrigin = null;\n      root.element.dataset.dragState = 'drop';\n    }\n  }, function (_ref6) {\n    var root = _ref6.root,\n      actions = _ref6.actions,\n      props = _ref6.props,\n      shouldOptimize = _ref6.shouldOptimize;\n    if (root.element.dataset.dragState === 'drop') {\n      if (root.scaleX <= 1) {\n        root.element.dataset.dragState = 'idle';\n      }\n    }\n\n    // select last state change action\n    var action = actions.concat().filter(function (action) {\n      return /^DID_/.test(action.type);\n    }).reverse().find(function (action) {\n      return StateMap[action.type];\n    });\n\n    // no need to set same state twice\n    if (action && action.type !== props.currentState) {\n      // set current state\n      props.currentState = action.type;\n\n      // set state\n      root.element.dataset.filepondItemState = StateMap[props.currentState] || '';\n    }\n\n    // route actions\n    var aspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');\n    if (!aspectRatio) {\n      route$1({\n        root: root,\n        actions: actions,\n        props: props\n      });\n      if (!root.height && root.ref.container.rect.element.height > 0) {\n        root.height = root.ref.container.rect.element.height;\n      }\n    } else if (!shouldOptimize) {\n      root.height = root.rect.element.width * aspectRatio;\n    }\n\n    // sync panel height with item height\n    if (shouldOptimize) {\n      root.ref.panel.height = null;\n    }\n    root.ref.panel.height = root.height;\n  });\n  var item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: function destroy(_ref7) {\n      var root = _ref7.root,\n        props = _ref7.props;\n      root.element.removeEventListener('click', root.ref.handleClick);\n      root.dispatch('RELEASE_ITEM', {\n        query: props.id\n      });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n      apis: ['id', 'interactionMethod', 'markedForRemoval', 'spawnDate', 'dragCenter', 'dragOrigin', 'dragOffset'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],\n      animations: {\n        scaleX: ITEM_SCALE_SPRING,\n        scaleY: ITEM_SCALE_SPRING,\n        translateX: ITEM_TRANSLATE_SPRING,\n        translateY: ITEM_TRANSLATE_SPRING,\n        opacity: {\n          type: 'tween',\n          duration: 150\n        }\n      }\n    }\n  });\n  var getItemIndexByPosition = function getItemIndexByPosition(view, children, positionInView) {\n    if (!positionInView) return;\n    var horizontalSpace = view.rect.element.width;\n    // const children = view.childViews;\n    var l = children.length;\n    var last = null;\n\n    // -1, don't move items to accomodate (either add to top or bottom)\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;\n\n    // let's get the item width\n    var item = children[0];\n    var itemRect = item.rect.element;\n    var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    var itemWidth = itemRect.width + itemHorizontalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      for (var index = 0; index < l; index++) {\n        var child = children[index];\n        var childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n        if (positionInView.top < childMid) {\n          return index;\n        }\n      }\n      return l;\n    }\n\n    // grid\n    var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    var itemHeight = itemRect.height + itemVerticalMargin;\n    for (var _index = 0; _index < l; _index++) {\n      var indexX = _index % itemsPerRow;\n      var indexY = Math.floor(_index / itemsPerRow);\n      var offsetX = indexX * itemWidth;\n      var offsetY = indexY * itemHeight;\n      var itemTop = offsetY - itemRect.marginTop;\n      var itemRight = offsetX + itemWidth;\n      var itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n      if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n        if (positionInView.left < itemRight) {\n          return _index;\n        } else if (_index !== l - 1) {\n          last = _index;\n        } else {\n          last = null;\n        }\n      }\n    }\n    if (last !== null) {\n      return last;\n    }\n    return l;\n  };\n  var dropAreaDimensions = {\n    height: 0,\n    width: 0,\n    get getHeight() {\n      return this.height;\n    },\n    set setHeight(val) {\n      if (this.height === 0 || val === 0) this.height = val;\n    },\n    get getWidth() {\n      return this.width;\n    },\n    set setWidth(val) {\n      if (this.width === 0 || val === 0) this.width = val;\n    },\n    setDimensions: function setDimensions(height, width) {\n      if (this.height === 0 || height === 0) this.height = height;\n      if (this.width === 0 || width === 0) this.width = width;\n    }\n  };\n  var create$8 = function create(_ref) {\n    var root = _ref.root;\n    // need to set role to list as otherwise it won't be read as a list by VoiceOver\n    attr(root.element, 'role', 'list');\n    root.ref.lastItemSpanwDate = Date.now();\n  };\n\n  /**\n   * Inserts a new item\n   * @param root\n   * @param action\n   */\n  var addItemView = function addItemView(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    var id = action.id,\n      index = action.index,\n      interactionMethod = action.interactionMethod;\n    root.ref.addIndex = index;\n    var now = Date.now();\n    var spawnDate = now;\n    var opacity = 1;\n    if (interactionMethod !== InteractionMethod.NONE) {\n      opacity = 0;\n      var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n      var dist = now - root.ref.lastItemSpanwDate;\n      spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n    root.ref.lastItemSpanwDate = spawnDate;\n    root.appendChildView(root.createChildView(\n    // view type\n    item,\n    // props\n    {\n      spawnDate: spawnDate,\n      id: id,\n      opacity: opacity,\n      interactionMethod: interactionMethod\n    }), index);\n  };\n  var moveItem = function moveItem(item, x, y) {\n    var vx = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var vy = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n\n    // set to null to remove animation while dragging\n    if (item.dragOffset) {\n      item.translateX = null;\n      item.translateY = null;\n      item.translateX = item.dragOrigin.x + item.dragOffset.x;\n      item.translateY = item.dragOrigin.y + item.dragOffset.y;\n      item.scaleX = 1.025;\n      item.scaleY = 1.025;\n    } else {\n      item.translateX = x;\n      item.translateY = y;\n      if (Date.now() > item.spawnDate) {\n        // reveal element\n        if (item.opacity === 0) {\n          introItemView(item, x, y, vx, vy);\n        }\n\n        // make sure is default scale every frame\n        item.scaleX = 1;\n        item.scaleY = 1;\n        item.opacity = 1;\n      }\n    }\n  };\n  var introItemView = function introItemView(item, x, y, vx, vy) {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n      item.translateX = null;\n      item.translateX = x;\n      item.translateY = null;\n      item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n      item.translateX = null;\n      item.translateX = x - vx * 20;\n      item.translateY = null;\n      item.translateY = y - vy * 10;\n      item.scaleX = 0.8;\n      item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n      item.translateY = null;\n      item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n      item.translateX = null;\n      item.translateX = x - 30;\n      item.translateY = null;\n    }\n  };\n\n  /**\n   * Removes an existing item\n   * @param root\n   * @param action\n   */\n  var removeItemView = function removeItemView(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var id = action.id;\n\n    // get the view matching the given id\n    var view = root.childViews.find(function (child) {\n      return child.id === id;\n    });\n\n    // if no view found, exit\n    if (!view) {\n      return;\n    }\n\n    // animate view out of view\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0;\n\n    // mark for removal\n    view.markedForRemoval = true;\n  };\n  var getItemHeight = function getItemHeight(child) {\n    return child.rect.element.height + child.rect.element.marginBottom * 0.5 + child.rect.element.marginTop * 0.5;\n  };\n  var getItemWidth = function getItemWidth(child) {\n    return child.rect.element.width + child.rect.element.marginLeft * 0.5 + child.rect.element.marginRight * 0.5;\n  };\n  var dragItem = function dragItem(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    var id = action.id,\n      dragState = action.dragState;\n\n    // reference to item\n    var item = root.query('GET_ITEM', {\n      id: id\n    });\n\n    // get the view matching the given id\n    var view = root.childViews.find(function (child) {\n      return child.id === id;\n    });\n    var numItems = root.childViews.length;\n    var oldIndex = dragState.getItemIndex(item);\n\n    // if no view found, exit\n    if (!view) return;\n    var dragPosition = {\n      x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,\n      y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y\n\n      // get drag area dimensions\n    };\n\n    var dragHeight = getItemHeight(view);\n    var dragWidth = getItemWidth(view);\n\n    // get rows and columns (There will always be at least one row and one column if a file is present)\n    var cols = Math.floor(root.rect.outer.width / dragWidth);\n    if (cols > numItems) cols = numItems;\n\n    // rows are used to find when we have left the preview area bounding box\n    var rows = Math.floor(numItems / cols + 1);\n    dropAreaDimensions.setHeight = dragHeight * rows;\n    dropAreaDimensions.setWidth = dragWidth * cols;\n\n    // get new index of dragged item\n    var location = {\n      y: Math.floor(dragPosition.y / dragHeight),\n      x: Math.floor(dragPosition.x / dragWidth),\n      getGridIndex: function getGridIndex() {\n        if (dragPosition.y > dropAreaDimensions.getHeight || dragPosition.y < 0 || dragPosition.x > dropAreaDimensions.getWidth || dragPosition.x < 0) return oldIndex;\n        return this.y * cols + this.x;\n      },\n      getColIndex: function getColIndex() {\n        var items = root.query('GET_ACTIVE_ITEMS');\n        var visibleChildren = root.childViews.filter(function (child) {\n          return child.rect.element.height;\n        });\n        var children = items.map(function (item) {\n          return visibleChildren.find(function (childView) {\n            return childView.id === item.id;\n          });\n        });\n        var currentIndex = children.findIndex(function (child) {\n          return child === view;\n        });\n        var dragHeight = getItemHeight(view);\n        var l = children.length;\n        var idx = l;\n        var childHeight = 0;\n        var childBottom = 0;\n        var childTop = 0;\n        for (var i = 0; i < l; i++) {\n          childHeight = getItemHeight(children[i]);\n          childTop = childBottom;\n          childBottom = childTop + childHeight;\n          if (dragPosition.y < childBottom) {\n            if (currentIndex > i) {\n              if (dragPosition.y < childTop + dragHeight) {\n                idx = i;\n                break;\n              }\n              continue;\n            }\n            idx = i;\n            break;\n          }\n        }\n        return idx;\n      }\n\n      // get new index\n    };\n\n    var index = cols > 1 ? location.getGridIndex() : location.getColIndex();\n    root.dispatch('MOVE_ITEM', {\n      query: view,\n      index: index\n    });\n\n    // if the index of the item changed, dispatch reorder action\n    var currentIndex = dragState.getIndex();\n    if (currentIndex === undefined || currentIndex !== index) {\n      dragState.setIndex(index);\n      if (currentIndex === undefined) return;\n      root.dispatch('DID_REORDER_ITEMS', {\n        items: root.query('GET_ACTIVE_ITEMS'),\n        origin: oldIndex,\n        target: index\n      });\n    }\n  };\n\n  /**\n   * Setup action routes\n   */\n  var route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView,\n    DID_DRAG_ITEM: dragItem\n  });\n\n  /**\n   * Write to view\n   * @param root\n   * @param actions\n   * @param props\n   */\n  var write$5 = function write(_ref5) {\n    var root = _ref5.root,\n      props = _ref5.props,\n      actions = _ref5.actions,\n      shouldOptimize = _ref5.shouldOptimize;\n\n    // route actions\n    route$2({\n      root: root,\n      props: props,\n      actions: actions\n    });\n    var dragCoordinates = props.dragCoordinates;\n\n    // available space on horizontal axis\n    var horizontalSpace = root.rect.element.width;\n\n    // only draw children that have dimensions\n    var visibleChildren = root.childViews.filter(function (child) {\n      return child.rect.element.height;\n    });\n\n    // sort based on current active items\n    var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n      return visibleChildren.find(function (child) {\n        return child.id === item.id;\n      });\n    }).filter(function (item) {\n      return item;\n    });\n\n    // get index\n    var dragIndex = dragCoordinates ? getItemIndexByPosition(root, children, dragCoordinates) : null;\n\n    // add index is used to reserve the dropped/added item index till the actual item is rendered\n    var addIndex = root.ref.addIndex || null;\n\n    // add index no longer needed till possibly next draw\n    root.ref.addIndex = null;\n    var dragIndexOffset = 0;\n    var removeIndexOffset = 0;\n    var addIndexOffset = 0;\n    if (children.length === 0) return;\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      var offsetY = 0;\n      var dragOffset = 0;\n      children.forEach(function (child, index) {\n        if (dragIndex) {\n          var dist = index - dragIndex;\n          if (dist === -2) {\n            dragOffset = -itemVerticalMargin * 0.25;\n          } else if (dist === -1) {\n            dragOffset = -itemVerticalMargin * 0.75;\n          } else if (dist === 0) {\n            dragOffset = itemVerticalMargin * 0.75;\n          } else if (dist === 1) {\n            dragOffset = itemVerticalMargin * 0.25;\n          } else {\n            dragOffset = 0;\n          }\n        }\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n        if (!child.markedForRemoval) {\n          moveItem(child, 0, offsetY + dragOffset);\n        }\n        var itemHeight = child.rect.element.height + itemVerticalMargin;\n        var visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);\n        offsetY += visualHeight;\n      });\n    }\n    // grid\n    else {\n      var prevX = 0;\n      var prevY = 0;\n      children.forEach(function (child, index) {\n        if (index === dragIndex) {\n          dragIndexOffset = 1;\n        }\n        if (index === addIndex) {\n          addIndexOffset += 1;\n        }\n        if (child.markedForRemoval && child.opacity < 0.5) {\n          removeIndexOffset -= 1;\n        }\n        var visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n        var indexX = visualIndex % itemsPerRow;\n        var indexY = Math.floor(visualIndex / itemsPerRow);\n        var offsetX = indexX * itemWidth;\n        var offsetY = indexY * itemHeight;\n        var vectorX = Math.sign(offsetX - prevX);\n        var vectorY = Math.sign(offsetY - prevY);\n        prevX = offsetX;\n        prevY = offsetY;\n        if (child.markedForRemoval) return;\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n        moveItem(child, offsetX, offsetY, vectorX, vectorY);\n      });\n    }\n  };\n\n  /**\n   * Filters actions that are meant specifically for a certain child of the list\n   * @param child\n   * @param actions\n   */\n  var filterSetItemActions = function filterSetItemActions(child, actions) {\n    return actions.filter(function (action) {\n      // if action has an id, filter out actions that don't have this child id\n      if (action.data && action.data.id) {\n        return child.id === action.data.id;\n      }\n\n      // allow all other actions\n      return true;\n    });\n  };\n  var list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: function didWriteView(_ref6) {\n      var root = _ref6.root;\n      root.childViews.filter(function (view) {\n        return view.markedForRemoval && view.opacity === 0 && view.resting;\n      }).forEach(function (view) {\n        view._destroy();\n        root.removeChildView(view);\n      });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n      apis: ['dragCoordinates']\n    }\n  });\n  var create$9 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n  };\n  var storeDragCoordinates = function storeDragCoordinates(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props,\n      action = _ref2.action;\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n      left: action.position.scopeLeft - root.ref.list.rect.element.left,\n      top: action.position.scopeTop - (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop)\n    };\n  };\n  var clearDragCoordinates = function clearDragCoordinates(_ref3) {\n    var props = _ref3.props;\n    props.dragCoordinates = null;\n  };\n  var route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates\n  });\n  var write$6 = function write(_ref4) {\n    var root = _ref4.root,\n      props = _ref4.props,\n      actions = _ref4.actions;\n\n    // route actions\n    route$3({\n      root: root,\n      props: props,\n      actions: actions\n    });\n\n    // current drag position\n    root.ref.list.dragCoordinates = props.dragCoordinates;\n\n    // if currently overflowing but no longer received overflow\n    if (props.overflowing && !props.overflow) {\n      props.overflowing = false;\n\n      // reset overflow state\n      root.element.dataset.state = '';\n      root.height = null;\n    }\n\n    // if is not overflowing currently but does receive overflow value\n    if (props.overflow) {\n      var newHeight = Math.round(props.overflow);\n      if (newHeight !== root.height) {\n        props.overflowing = true;\n        root.element.dataset.state = 'overflow';\n        root.height = newHeight;\n      }\n    }\n  };\n  var listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n      apis: ['overflow', 'dragCoordinates'],\n      styles: ['height', 'translateY'],\n      animations: {\n        translateY: 'spring'\n      }\n    }\n  });\n  var attrToggle = function attrToggle(element, name, state) {\n    var enabledValue = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n    if (state) {\n      attr(element, name, enabledValue);\n    } else {\n      element.removeAttribute(name);\n    }\n  };\n  var resetFileInput = function resetFileInput(input) {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n      return;\n    }\n    try {\n      // for modern browsers\n      input.value = '';\n    } catch (err) {}\n\n    // for IE10\n    if (input.value) {\n      // quickly append input to temp form and reset form\n      var form = createElement$1('form');\n      var parentNode = input.parentNode;\n      var ref = input.nextSibling;\n      form.appendChild(input);\n      form.reset();\n\n      // re-inject input where it originally was\n      if (ref) {\n        parentNode.insertBefore(input, ref);\n      } else {\n        parentNode.appendChild(input);\n      }\n    }\n  };\n  var create$a = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // set id so can be referenced from outside labels\n    root.element.id = 'filepond--browser-' + props.id;\n\n    // set name of element (is removed when a value is set)\n    attr(root.element, 'name', root.query('GET_NAME'));\n\n    // we have to link this element to the status element\n    attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id);\n\n    // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n    attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id);\n\n    // set configurable props\n    setAcceptedFileTypes({\n      root: root,\n      action: {\n        value: root.query('GET_ACCEPTED_FILE_TYPES')\n      }\n    });\n    toggleAllowMultiple({\n      root: root,\n      action: {\n        value: root.query('GET_ALLOW_MULTIPLE')\n      }\n    });\n    toggleDirectoryFilter({\n      root: root,\n      action: {\n        value: root.query('GET_ALLOW_DIRECTORIES_ONLY')\n      }\n    });\n    toggleDisabled({\n      root: root\n    });\n    toggleRequired({\n      root: root,\n      action: {\n        value: root.query('GET_REQUIRED')\n      }\n    });\n    setCaptureMethod({\n      root: root,\n      action: {\n        value: root.query('GET_CAPTURE_METHOD')\n      }\n    });\n\n    // handle changes to the input field\n    root.ref.handleChange = function (e) {\n      if (!root.element.value) {\n        return;\n      }\n\n      // extract files and move value of webkitRelativePath path to _relativePath\n      var files = Array.from(root.element.files).map(function (file) {\n        file._relativePath = file.webkitRelativePath;\n        return file;\n      });\n\n      // we add a little delay so the OS file select window can move out of the way before we add our file\n      setTimeout(function () {\n        // load files\n        props.onload(files);\n\n        // reset input, it's just for exposing a method to drop files, should not retain any state\n        resetFileInput(root.element);\n      }, 250);\n    };\n    root.element.addEventListener('change', root.ref.handleChange);\n  };\n  var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!root.query('GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE')) return;\n    attrToggle(root.element, 'accept', !!action.value, action.value ? action.value.join(',') : '');\n  };\n  var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    attrToggle(root.element, 'multiple', action.value);\n  };\n  var toggleDirectoryFilter = function toggleDirectoryFilter(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    attrToggle(root.element, 'webkitdirectory', action.value);\n  };\n  var toggleDisabled = function toggleDisabled(_ref5) {\n    var root = _ref5.root;\n    var isDisabled = root.query('GET_DISABLED');\n    var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    var disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n  };\n  var toggleRequired = function toggleRequired(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    // want to remove required, always possible\n    if (!action.value) {\n      attrToggle(root.element, 'required', false);\n    }\n    // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n      attrToggle(root.element, 'required', true);\n    }\n  };\n  var setCaptureMethod = function setCaptureMethod(_ref7) {\n    var root = _ref7.root,\n      action = _ref7.action;\n    attrToggle(root.element, 'capture', !!action.value, action.value === true ? '' : action.value);\n  };\n  var updateRequiredStatus = function updateRequiredStatus(_ref8) {\n    var root = _ref8.root;\n    var element = root.element;\n    // always remove the required attribute when more than zero items\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n      attrToggle(element, 'required', false);\n      attrToggle(element, 'name', false);\n    } else {\n      // add name attribute\n      attrToggle(element, 'name', true, root.query('GET_NAME'));\n\n      // remove any validation messages\n      var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n      if (shouldCheckValidity) {\n        element.setCustomValidity('');\n      }\n\n      // we only add required if the field has been deemed required\n      if (root.query('GET_REQUIRED')) {\n        attrToggle(element, 'required', true);\n      }\n    }\n  };\n  var updateFieldValidityStatus = function updateFieldValidityStatus(_ref9) {\n    var root = _ref9.root;\n    var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n  };\n  var browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n      type: 'file'\n    },\n    create: create$a,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n      DID_LOAD_ITEM: updateRequiredStatus,\n      DID_REMOVE_ITEM: updateRequiredStatus,\n      DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n      DID_SET_DISABLED: toggleDisabled,\n      DID_SET_ALLOW_BROWSE: toggleDisabled,\n      DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\n      DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n      DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n      DID_SET_CAPTURE_METHOD: setCaptureMethod,\n      DID_SET_REQUIRED: toggleRequired\n    })\n  });\n  var Key = {\n    ENTER: 13,\n    SPACE: 32\n  };\n  var create$b = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // create the label and link it to the file browser\n    var label = createElement$1('label');\n    attr(label, 'for', 'filepond--browser-' + props.id);\n\n    // use for labeling file input (aria-labelledby on file input)\n    attr(label, 'id', 'filepond--drop-label-' + props.id);\n\n    // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.\n    attr(label, 'aria-hidden', 'true');\n\n    // handle keys\n    root.ref.handleKeyDown = function (e) {\n      var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n      if (!isActivationKey) return;\n      // stops from triggering the element a second time\n      e.preventDefault();\n\n      // click link (will then in turn activate file input)\n      root.ref.label.click();\n    };\n    root.ref.handleClick = function (e) {\n      var isLabelClick = e.target === label || label.contains(e.target);\n\n      // don't want to click twice\n      if (isLabelClick) return;\n\n      // click link (will then in turn activate file input)\n      root.ref.label.click();\n    };\n\n    // attach events\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // update\n    updateLabelValue(label, props.caption);\n\n    // add!\n    root.appendChild(label);\n    root.ref.label = label;\n  };\n  var updateLabelValue = function updateLabelValue(label, value) {\n    label.innerHTML = value;\n    var clickable = label.querySelector('.filepond--label-action');\n    if (clickable) {\n      attr(clickable, 'tabindex', '0');\n    }\n    return value;\n  };\n  var dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: function destroy(_ref2) {\n      var root = _ref2.root;\n      root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n      root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n      DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {\n        var root = _ref3.root,\n          action = _ref3.action;\n        updateLabelValue(root.ref.label, action.value);\n      }\n    }),\n    mixins: {\n      styles: ['opacity', 'translateX', 'translateY'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 150\n        },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n  var blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      }\n    }\n  });\n  var addBlob = function addBlob(_ref) {\n    var root = _ref.root;\n    var centerX = root.rect.element.width * 0.5;\n    var centerY = root.rect.element.height * 0.5;\n    root.ref.blob = root.appendChildView(root.createChildView(blob, {\n      opacity: 0,\n      scaleX: 2.5,\n      scaleY: 2.5,\n      translateX: centerX,\n      translateY: centerY\n    }));\n  };\n  var moveBlob = function moveBlob(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!root.ref.blob) {\n      addBlob({\n        root: root\n      });\n      return;\n    }\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n  };\n  var hideBlob = function hideBlob(_ref3) {\n    var root = _ref3.root;\n    if (!root.ref.blob) {\n      return;\n    }\n    root.ref.blob.opacity = 0;\n  };\n  var explodeBlob = function explodeBlob(_ref4) {\n    var root = _ref4.root;\n    if (!root.ref.blob) {\n      return;\n    }\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n  };\n  var write$7 = function write(_ref5) {\n    var root = _ref5.root,\n      props = _ref5.props,\n      actions = _ref5.actions;\n    route$4({\n      root: root,\n      props: props,\n      actions: actions\n    });\n    var blob = root.ref.blob;\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n      root.removeChildView(blob);\n      root.ref.blob = null;\n    }\n  };\n  var route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob\n  });\n  var drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7\n  });\n  var create$c = function create(_ref) {\n    var root = _ref.root;\n    return root.ref.fields = {};\n  };\n  var getField = function getField(root, id) {\n    return root.ref.fields[id];\n  };\n  var syncFieldPositionsWithItems = function syncFieldPositionsWithItems(root) {\n    root.query('GET_ACTIVE_ITEMS').forEach(function (item) {\n      if (!root.ref.fields[item.id]) return;\n      root.element.appendChild(root.ref.fields[item.id]);\n    });\n  };\n  var didReorderItems = function didReorderItems(_ref2) {\n    var root = _ref2.root;\n    return syncFieldPositionsWithItems(root);\n  };\n  var didAddItem = function didAddItem(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var dataContainer = createElement$1('input');\n    dataContainer.type = 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    dataContainer.disabled = root.query('GET_DISABLED');\n    root.ref.fields[action.id] = dataContainer;\n    syncFieldPositionsWithItems(root);\n  };\n  var didLoadItem$1 = function didLoadItem(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    var field = getField(root, action.id);\n    if (!field || action.serverFileReference === null) return;\n    field.value = action.serverFileReference;\n  };\n  var didSetDisabled = function didSetDisabled(_ref5) {\n    var root = _ref5.root;\n    root.element.disabled = root.query('GET_DISABLED');\n  };\n  var didRemoveItem = function didRemoveItem(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n    if (field.parentNode) field.parentNode.removeChild(field);\n    delete root.ref.fields[action.id];\n  };\n  var didDefineValue = function didDefineValue(_ref7) {\n    var root = _ref7.root,\n      action = _ref7.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n    if (action.value === null) {\n      field.removeAttribute('value');\n    } else {\n      field.value = action.value;\n    }\n    syncFieldPositionsWithItems(root);\n  };\n  var write$8 = createRoute({\n    DID_SET_DISABLED: didSetDisabled,\n    DID_ADD_ITEM: didAddItem,\n    DID_LOAD_ITEM: didLoadItem$1,\n    DID_REMOVE_ITEM: didRemoveItem,\n    DID_DEFINE_VALUE: didDefineValue,\n    DID_REORDER_ITEMS: didReorderItems,\n    DID_SORT_ITEMS: didReorderItems\n  });\n  var data = createView({\n    tag: 'fieldset',\n    name: 'data',\n    create: create$c,\n    write: write$8,\n    ignoreRect: true\n  });\n  var getRootNode = function getRootNode(element) {\n    return 'getRootNode' in element ? element.getRootNode() : document;\n  };\n  var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n  var text$1 = ['css', 'csv', 'html', 'txt'];\n  var map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip'\n  };\n  var guesstimateMimeType = function guesstimateMimeType() {\n    var extension = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    extension = extension.toLowerCase();\n    if (images.includes(extension)) {\n      return 'image/' + (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension);\n    }\n    if (text$1.includes(extension)) {\n      return 'text/' + extension;\n    }\n    return map[extension] || '';\n  };\n  var requestDataTransferItems = function requestDataTransferItems(dataTransfer) {\n    return new Promise(function (resolve, reject) {\n      // try to get links from transfer, if found we'll exit immediately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n      var links = getLinks(dataTransfer);\n      if (links.length && !hasFiles(dataTransfer)) {\n        return resolve(links);\n      }\n      // try to get files from the transfer\n      getFiles(dataTransfer).then(resolve);\n    });\n  };\n\n  /**\n   * Test if datatransfer has files\n   */\n  var hasFiles = function hasFiles(dataTransfer) {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n  };\n\n  /**\n   * Extracts files from a DataTransfer object\n   */\n  var getFiles = function getFiles(dataTransfer) {\n    return new Promise(function (resolve, reject) {\n      // get the transfer items as promises\n      var promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : []\n\n      // only keep file system items (files and directories)\n      ).filter(function (item) {\n        return isFileSystemItem(item);\n      })\n\n      // map each item to promise\n      .map(function (item) {\n        return getFilesFromItem(item);\n      });\n\n      // if is empty, see if we can extract some info from the files property as a fallback\n      if (!promisedFiles.length) {\n        // TODO: test for directories (should not be allowed)\n        // Use FileReader, problem is that the files property gets lost in the process\n        resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n        return;\n      }\n\n      // done!\n      Promise.all(promisedFiles).then(function (returnedFileGroups) {\n        // flatten groups\n        var files = [];\n        returnedFileGroups.forEach(function (group) {\n          files.push.apply(files, group);\n        });\n\n        // done (filter out empty files)!\n        resolve(files.filter(function (file) {\n          return file;\n        }).map(function (file) {\n          if (!file._relativePath) file._relativePath = file.webkitRelativePath;\n          return file;\n        }));\n      }).catch(console.error);\n    });\n  };\n  var isFileSystemItem = function isFileSystemItem(item) {\n    if (isEntry(item)) {\n      var entry = getAsEntry(item);\n      if (entry) {\n        return entry.isFile || entry.isDirectory;\n      }\n    }\n    return item.kind === 'file';\n  };\n  var getFilesFromItem = function getFilesFromItem(item) {\n    return new Promise(function (resolve, reject) {\n      if (isDirectoryEntry(item)) {\n        getFilesInDirectory(getAsEntry(item)).then(resolve).catch(reject);\n        return;\n      }\n      resolve([item.getAsFile()]);\n    });\n  };\n  var getFilesInDirectory = function getFilesInDirectory(entry) {\n    return new Promise(function (resolve, reject) {\n      var files = [];\n\n      // the total entries to read\n      var dirCounter = 0;\n      var fileCounter = 0;\n      var resolveIfDone = function resolveIfDone() {\n        if (fileCounter === 0 && dirCounter === 0) {\n          resolve(files);\n        }\n      };\n\n      // the recursive function\n      var readEntries = function readEntries(dirEntry) {\n        dirCounter++;\n        var directoryReader = dirEntry.createReader();\n\n        // directories are returned in batches, we need to process all batches before we're done\n        var readBatch = function readBatch() {\n          directoryReader.readEntries(function (entries) {\n            if (entries.length === 0) {\n              dirCounter--;\n              resolveIfDone();\n              return;\n            }\n            entries.forEach(function (entry) {\n              // recursively read more directories\n              if (entry.isDirectory) {\n                readEntries(entry);\n              } else {\n                // read as file\n                fileCounter++;\n                entry.file(function (file) {\n                  var correctedFile = correctMissingFileType(file);\n                  if (entry.fullPath) correctedFile._relativePath = entry.fullPath;\n                  files.push(correctedFile);\n                  fileCounter--;\n                  resolveIfDone();\n                });\n              }\n            });\n\n            // try to get next batch of files\n            readBatch();\n          }, reject);\n        };\n\n        // read first batch of files\n        readBatch();\n      };\n\n      // go!\n      readEntries(entry);\n    });\n  };\n  var correctMissingFileType = function correctMissingFileType(file) {\n    if (file.type.length) return file;\n    var date = file.lastModifiedDate;\n    var name = file.name;\n    var type = guesstimateMimeType(getExtensionFromFilename(file.name));\n    if (!type.length) return file;\n    file = file.slice(0, file.size, type);\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n  };\n  var isDirectoryEntry = function isDirectoryEntry(item) {\n    return isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n  };\n  var isEntry = function isEntry(item) {\n    return 'webkitGetAsEntry' in item;\n  };\n  var getAsEntry = function getAsEntry(item) {\n    return item.webkitGetAsEntry();\n  };\n\n  /**\n   * Extracts links from a DataTransfer object\n   */\n  var getLinks = function getLinks(dataTransfer) {\n    var links = [];\n    try {\n      // look in meta data property\n      links = getLinksFromTransferMetaData(dataTransfer);\n      if (links.length) {\n        return links;\n      }\n      links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {\n      // nope nope nope (probably IE trouble)\n    }\n    return links;\n  };\n  var getLinksFromTransferURLData = function getLinksFromTransferURLData(dataTransfer) {\n    var data = dataTransfer.getData('url');\n    if (typeof data === 'string' && data.length) {\n      return [data];\n    }\n    return [];\n  };\n  var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(dataTransfer) {\n    var data = dataTransfer.getData('text/html');\n    if (typeof data === 'string' && data.length) {\n      var matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n      if (matches) {\n        return [matches[1]];\n      }\n    }\n    return [];\n  };\n  var dragNDropObservers = [];\n  var eventPosition = function eventPosition(e) {\n    return {\n      pageLeft: e.pageX,\n      pageTop: e.pageY,\n      scopeLeft: e.offsetX || e.layerX,\n      scopeTop: e.offsetY || e.layerY\n    };\n  };\n  var createDragNDropClient = function createDragNDropClient(element, scopeToObserve, filterElement) {\n    var observer = getDragNDropObserver(scopeToObserve);\n    var client = {\n      element: element,\n      filterElement: filterElement,\n      state: null,\n      ondrop: function ondrop() {},\n      onenter: function onenter() {},\n      ondrag: function ondrag() {},\n      onexit: function onexit() {},\n      onload: function onload() {},\n      allowdrop: function allowdrop() {}\n    };\n    client.destroy = observer.addListener(client);\n    return client;\n  };\n  var getDragNDropObserver = function getDragNDropObserver(element) {\n    // see if already exists, if so, return\n    var observer = dragNDropObservers.find(function (item) {\n      return item.element === element;\n    });\n    if (observer) {\n      return observer;\n    }\n\n    // create new observer, does not yet exist for this element\n    var newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n  };\n  var createDragNDropObserver = function createDragNDropObserver(element) {\n    var clients = [];\n    var routes = {\n      dragenter: dragenter,\n      dragover: dragover,\n      dragleave: dragleave,\n      drop: drop\n    };\n    var handlers = {};\n    forin(routes, function (event, createHandler) {\n      handlers[event] = createHandler(element, clients);\n      element.addEventListener(event, handlers[event], false);\n    });\n    var observer = {\n      element: element,\n      addListener: function addListener(client) {\n        // add as client\n        clients.push(client);\n\n        // return removeListener function\n        return function () {\n          // remove client\n          clients.splice(clients.indexOf(client), 1);\n\n          // if no more clients, clean up observer\n          if (clients.length === 0) {\n            dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n            forin(routes, function (event) {\n              element.removeEventListener(event, handlers[event], false);\n            });\n          }\n        };\n      }\n    };\n    return observer;\n  };\n  var elementFromPoint = function elementFromPoint(root, point) {\n    if (!('elementFromPoint' in root)) {\n      root = document;\n    }\n    return root.elementFromPoint(point.x, point.y);\n  };\n  var isEventTarget = function isEventTarget(e, target) {\n    // get root\n    var root = getRootNode(target);\n\n    // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n    var elementAtPosition = elementFromPoint(root, {\n      x: e.pageX - window.pageXOffset,\n      y: e.pageY - window.pageYOffset\n    });\n\n    // test if target is the element or if one of its children is\n    return elementAtPosition === target || target.contains(elementAtPosition);\n  };\n  var initialTarget = null;\n  var setDropEffect = function setDropEffect(dataTransfer, effect) {\n    // is in try catch as IE11 will throw error if not\n    try {\n      dataTransfer.dropEffect = effect;\n    } catch (e) {}\n  };\n  var dragenter = function dragenter(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      initialTarget = e.target;\n      clients.forEach(function (client) {\n        var element = client.element,\n          onenter = client.onenter;\n        if (isEventTarget(e, element)) {\n          client.state = 'enter';\n\n          // fire enter event\n          onenter(eventPosition(e));\n        }\n      });\n    };\n  };\n  var dragover = function dragover(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      var dataTransfer = e.dataTransfer;\n      requestDataTransferItems(dataTransfer).then(function (items) {\n        var overDropTarget = false;\n        clients.some(function (client) {\n          var filterElement = client.filterElement,\n            element = client.element,\n            onenter = client.onenter,\n            onexit = client.onexit,\n            ondrag = client.ondrag,\n            allowdrop = client.allowdrop;\n\n          // by default we can drop\n          setDropEffect(dataTransfer, 'copy');\n\n          // allow transfer of these items\n          var allowsTransfer = allowdrop(items);\n\n          // only used when can be dropped on page\n          if (!allowsTransfer) {\n            setDropEffect(dataTransfer, 'none');\n            return;\n          }\n\n          // targetting this client\n          if (isEventTarget(e, element)) {\n            overDropTarget = true;\n\n            // had no previous state, means we are entering this client\n            if (client.state === null) {\n              client.state = 'enter';\n              onenter(eventPosition(e));\n              return;\n            }\n\n            // now over element (no matter if it allows the drop or not)\n            client.state = 'over';\n\n            // needs to allow transfer\n            if (filterElement && !allowsTransfer) {\n              setDropEffect(dataTransfer, 'none');\n              return;\n            }\n\n            // dragging\n            ondrag(eventPosition(e));\n          } else {\n            // should be over an element to drop\n            if (filterElement && !overDropTarget) {\n              setDropEffect(dataTransfer, 'none');\n            }\n\n            // might have just left this client?\n            if (client.state) {\n              client.state = null;\n              onexit(eventPosition(e));\n            }\n          }\n        });\n      });\n    };\n  };\n  var drop = function drop(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      var dataTransfer = e.dataTransfer;\n      requestDataTransferItems(dataTransfer).then(function (items) {\n        clients.forEach(function (client) {\n          var filterElement = client.filterElement,\n            element = client.element,\n            ondrop = client.ondrop,\n            onexit = client.onexit,\n            allowdrop = client.allowdrop;\n          client.state = null;\n\n          // if we're filtering on element we need to be over the element to drop\n          if (filterElement && !isEventTarget(e, element)) return;\n\n          // no transfer for this client\n          if (!allowdrop(items)) return onexit(eventPosition(e));\n\n          // we can drop these items on this client\n          ondrop(eventPosition(e), items);\n        });\n      });\n    };\n  };\n  var dragleave = function dragleave(root, clients) {\n    return function (e) {\n      if (initialTarget !== e.target) {\n        return;\n      }\n      clients.forEach(function (client) {\n        var onexit = client.onexit;\n        client.state = null;\n        onexit(eventPosition(e));\n      });\n    };\n  };\n  var createHopper = function createHopper(scope, validateItems, options) {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper');\n\n    // shortcuts\n    var catchesDropsOnPage = options.catchesDropsOnPage,\n      requiresDropOnElement = options.requiresDropOnElement,\n      _options$filterItems = options.filterItems,\n      filterItems = _options$filterItems === void 0 ? function (items) {\n        return items;\n      } : _options$filterItems;\n\n    // create a dnd client\n    var client = createDragNDropClient(scope, catchesDropsOnPage ? document.documentElement : scope, requiresDropOnElement);\n\n    // current client state\n    var lastState = '';\n    var currentState = '';\n\n    // determines if a file may be dropped\n    client.allowdrop = function (items) {\n      // TODO: if we can, throw error to indicate the items cannot by dropped\n\n      return validateItems(filterItems(items));\n    };\n    client.ondrop = function (position, items) {\n      var filteredItems = filterItems(items);\n      if (!validateItems(filteredItems)) {\n        api.ondragend(position);\n        return;\n      }\n      currentState = 'drag-drop';\n      api.onload(filteredItems, position);\n    };\n    client.ondrag = function (position) {\n      api.ondrag(position);\n    };\n    client.onenter = function (position) {\n      currentState = 'drag-over';\n      api.ondragstart(position);\n    };\n    client.onexit = function (position) {\n      currentState = 'drag-exit';\n      api.ondragend(position);\n    };\n    var api = {\n      updateHopperState: function updateHopperState() {\n        if (lastState !== currentState) {\n          scope.dataset.hopperState = currentState;\n          lastState = currentState;\n        }\n      },\n      onload: function onload() {},\n      ondragstart: function ondragstart() {},\n      ondrag: function ondrag() {},\n      ondragend: function ondragend() {},\n      destroy: function destroy() {\n        // destroy client\n        client.destroy();\n      }\n    };\n    return api;\n  };\n  var listening = false;\n  var listeners$1 = [];\n  var handlePaste = function handlePaste(e) {\n    // if is pasting in input or textarea and the target is outside of a filepond scope, ignore\n    var activeEl = document.activeElement;\n    if (activeEl && /textarea|input/i.test(activeEl.nodeName)) {\n      // test textarea or input is contained in filepond root\n      var inScope = false;\n      var element = activeEl;\n      while (element !== document.body) {\n        if (element.classList.contains('filepond--root')) {\n          inScope = true;\n          break;\n        }\n        element = element.parentNode;\n      }\n      if (!inScope) return;\n    }\n    requestDataTransferItems(e.clipboardData).then(function (files) {\n      // no files received\n      if (!files.length) {\n        return;\n      }\n\n      // notify listeners of received files\n      listeners$1.forEach(function (listener) {\n        return listener(files);\n      });\n    });\n  };\n  var listen = function listen(cb) {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n      return;\n    }\n\n    // add initial listener\n    listeners$1.push(cb);\n\n    // setup paste listener for entire page\n    if (listening) {\n      return;\n    }\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n  };\n  var unlisten = function unlisten(listener) {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener));\n\n    // clean up\n    if (listeners$1.length === 0) {\n      document.removeEventListener('paste', handlePaste);\n      listening = false;\n    }\n  };\n  var createPaster = function createPaster() {\n    var cb = function cb(files) {\n      api.onload(files);\n    };\n    var api = {\n      destroy: function destroy() {\n        unlisten(cb);\n      },\n      onload: function onload() {}\n    };\n    listen(cb);\n    return api;\n  };\n\n  /**\n   * Creates the file view\n   */\n  var create$d = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.element.id = 'filepond--assistant-' + props.id;\n    attr(root.element, 'role', 'status');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n  };\n  var addFilesNotificationTimeout = null;\n  var notificationClearTimeout = null;\n  var filenames = [];\n  var assist = function assist(root, message) {\n    root.element.textContent = message;\n  };\n  var clear$1 = function clear(root) {\n    root.element.textContent = '';\n  };\n  var listModified = function listModified(root, filename, label) {\n    var total = root.query('GET_TOTAL_ITEMS');\n    assist(root, label + ' ' + filename + ', ' + total + ' ' + (total === 1 ? root.query('GET_LABEL_FILE_COUNT_SINGULAR') : root.query('GET_LABEL_FILE_COUNT_PLURAL')));\n\n    // clear group after set amount of time so the status is not read twice\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(function () {\n      clear$1(root);\n    }, 1500);\n  };\n  var isUsingFilePond = function isUsingFilePond(root) {\n    return root.element.parentNode.contains(document.activeElement);\n  };\n  var itemAdded = function itemAdded(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n    root.element.textContent = '';\n    var item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(function () {\n      listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));\n      filenames.length = 0;\n    }, 750);\n  };\n  var itemRemoved = function itemRemoved(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n    var item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n  };\n  var itemProcessed = function itemProcessed(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n    assist(root, filename + ' ' + label);\n  };\n  var itemProcessedUndo = function itemProcessedUndo(_ref5) {\n    var root = _ref5.root,\n      action = _ref5.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n    assist(root, filename + ' ' + label);\n  };\n  var itemError = function itemError(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);\n  };\n  var assistant = createView({\n    create: create$d,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: itemAdded,\n      DID_REMOVE_ITEM: itemRemoved,\n      DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n      DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_THROW_ITEM_REMOVE_ERROR: itemError,\n      DID_THROW_ITEM_LOAD_ERROR: itemError,\n      DID_THROW_ITEM_INVALID: itemError,\n      DID_THROW_ITEM_PROCESSING_ERROR: itemError\n    }),\n    tag: 'span',\n    name: 'assistant'\n  });\n  var toCamels = function toCamels(string) {\n    var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.replace(new RegExp(separator + '.', 'g'), function (sub) {\n      return sub.charAt(1).toUpperCase();\n    });\n  };\n  var debounce = function debounce(func) {\n    var interval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n    var immidiateOnly = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var last = Date.now();\n    var timeout = null;\n    return function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      clearTimeout(timeout);\n      var dist = Date.now() - last;\n      var fn = function fn() {\n        last = Date.now();\n        func.apply(void 0, args);\n      };\n      if (dist < interval) {\n        // we need to delay by the difference between interval and dist\n        // for example: if distance is 10 ms and interval is 16 ms,\n        // we need to wait an additional 6ms before calling the function)\n        if (!immidiateOnly) {\n          timeout = setTimeout(fn, interval - dist);\n        }\n      } else {\n        // go!\n        fn();\n      }\n    };\n  };\n  var MAX_FILES_LIMIT = 1000000;\n  var prevent = function prevent(e) {\n    return e.preventDefault();\n  };\n  var create$e = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // Add id\n    var id = root.query('GET_ID');\n    if (id) {\n      root.element.id = id;\n    }\n\n    // Add className\n    var className = root.query('GET_CLASS_NAME');\n    if (className) {\n      className.split(' ').filter(function (name) {\n        return name.length;\n      }).forEach(function (name) {\n        root.element.classList.add(name);\n      });\n    }\n\n    // Field label\n    root.ref.label = root.appendChildView(root.createChildView(dropLabel, Object.assign({}, props, {\n      translateY: null,\n      caption: root.query('GET_LABEL_IDLE')\n    })));\n\n    // List of items\n    root.ref.list = root.appendChildView(root.createChildView(listScroller, {\n      translateY: null\n    }));\n\n    // Background panel\n    root.ref.panel = root.appendChildView(root.createChildView(panel, {\n      name: 'panel-root'\n    }));\n\n    // Assistant notifies assistive tech when content changes\n    root.ref.assistant = root.appendChildView(root.createChildView(assistant, Object.assign({}, props)));\n\n    // Data\n    root.ref.data = root.appendChildView(root.createChildView(data, Object.assign({}, props)));\n\n    // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure);\n\n    // information on the root height or fixed height status\n    root.ref.bounds = null;\n\n    // apply initial style properties\n    root.query('GET_STYLES').filter(function (style) {\n      return !isEmpty(style.value);\n    }).map(function (_ref2) {\n      var name = _ref2.name,\n        value = _ref2.value;\n      root.element.dataset[name] = value;\n    });\n\n    // determine if width changed\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(function () {\n      root.ref.updateHistory = [];\n      root.dispatch('DID_RESIZE_ROOT');\n    }, 250);\n\n    // history of updates\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = [];\n\n    // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\n    var canHover = window.matchMedia('(pointer: fine) and (hover: hover)').matches;\n    var hasPointerEvents = ('PointerEvent' in window);\n    if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\n      root.element.addEventListener('touchmove', prevent, {\n        passive: false\n      });\n      root.element.addEventListener('gesturestart', prevent);\n    }\n\n    // add credits\n    var credits = root.query('GET_CREDITS');\n    var hasCredits = credits.length === 2;\n    if (hasCredits) {\n      var frag = document.createElement('a');\n      frag.className = 'filepond--credits';\n      frag.setAttribute('aria-hidden', 'true');\n      frag.href = credits[0];\n      frag.tabindex = -1;\n      frag.target = '_blank';\n      frag.rel = 'noopener noreferrer';\n      frag.textContent = credits[1];\n      root.element.appendChild(frag);\n      root.ref.credits = frag;\n    }\n  };\n  var write$9 = function write(_ref3) {\n    var root = _ref3.root,\n      props = _ref3.props,\n      actions = _ref3.actions;\n\n    // route actions\n    route$5({\n      root: root,\n      props: props,\n      actions: actions\n    });\n\n    // apply style properties\n    actions.filter(function (action) {\n      return /^DID_SET_STYLE_/.test(action.type);\n    }).filter(function (action) {\n      return !isEmpty(action.data.value);\n    }).map(function (_ref4) {\n      var type = _ref4.type,\n        data = _ref4.data;\n      var name = toCamels(type.substr(8).toLowerCase(), '_');\n      root.element.dataset[name] = data.value;\n      root.invalidateLayout();\n    });\n    if (root.rect.element.hidden) return;\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n      root.ref.widthPrevious = root.rect.element.width;\n      root.ref.widthUpdated();\n    }\n\n    // get box bounds, we do this only once\n    var bounds = root.ref.bounds;\n    if (!bounds) {\n      bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);\n\n      // destroy measure element\n      root.element.removeChild(root.ref.measure);\n      root.ref.measure = null;\n    }\n\n    // get quick references to various high level parts of the upload tool\n    var _root$ref = root.ref,\n      hopper = _root$ref.hopper,\n      label = _root$ref.label,\n      list = _root$ref.list,\n      panel = _root$ref.panel;\n\n    // sets correct state to hopper scope\n    if (hopper) {\n      hopper.updateHopperState();\n    }\n\n    // bool to indicate if we're full or not\n    var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    var isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;\n    var atMaxCapacity = totalItems === maxItems;\n\n    // action used to add item\n    var addAction = actions.find(function (action) {\n      return action.type === 'DID_ADD_ITEM';\n    });\n\n    // if reached max capacity and we've just reached it\n    if (atMaxCapacity && addAction) {\n      // get interaction type\n      var interactionMethod = addAction.data.interactionMethod;\n\n      // hide label\n      label.opacity = 0;\n      if (isMultiItem) {\n        label.translateY = -40;\n      } else {\n        if (interactionMethod === InteractionMethod.API) {\n          label.translateX = 40;\n        } else if (interactionMethod === InteractionMethod.BROWSE) {\n          label.translateY = 40;\n        } else {\n          label.translateY = 30;\n        }\n      }\n    } else if (!atMaxCapacity) {\n      label.opacity = 1;\n      label.translateX = 0;\n      label.translateY = 0;\n    }\n    var listItemMargin = calculateListItemMargin(root);\n    var listHeight = calculateListHeight(root);\n    var labelHeight = label.rect.element.height;\n    var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n    var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    var listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;\n    var visualHeight = currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    var boundsHeight = currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;\n\n    // link list to label bottom position\n    list.translateY = Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;\n    if (aspectRatio) {\n      // fixed aspect ratio\n\n      // calculate height based on width\n      var width = root.rect.element.width;\n      var height = width * aspectRatio;\n\n      // clear history if aspect ratio has changed\n      if (aspectRatio !== root.ref.previousAspectRatio) {\n        root.ref.previousAspectRatio = aspectRatio;\n        root.ref.updateHistory = [];\n      }\n\n      // remember this width\n      var history = root.ref.updateHistory;\n      history.push(width);\n      var MAX_BOUNCES = 2;\n      if (history.length > MAX_BOUNCES * 2) {\n        var l = history.length;\n        var bottom = l - 10;\n        var bounces = 0;\n        for (var i = l; i >= bottom; i--) {\n          if (history[i] === history[i - 2]) {\n            bounces++;\n          }\n          if (bounces >= MAX_BOUNCES) {\n            // dont adjust height\n            return;\n          }\n        }\n      }\n\n      // fix height of panel so it adheres to aspect ratio\n      panel.scalable = false;\n      panel.height = height;\n\n      // available height for list\n      var listAvailableHeight =\n      // the height of the panel minus the label height\n      height - currentLabelHeight - (\n      // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - (\n      // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0);\n      if (listHeight.visual > listAvailableHeight) {\n        list.overflow = listAvailableHeight;\n      } else {\n        list.overflow = null;\n      }\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = height;\n    } else if (bounds.fixedHeight) {\n      // fixed height\n\n      // fix height of panel\n      panel.scalable = false;\n\n      // available height for list\n      var _listAvailableHeight =\n      // the height of the panel minus the label height\n      bounds.fixedHeight - currentLabelHeight - (\n      // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - (\n      // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0);\n\n      // set list height\n      if (listHeight.visual > _listAvailableHeight) {\n        list.overflow = _listAvailableHeight;\n      } else {\n        list.overflow = null;\n      }\n\n      // no need to set container bounds as these are handles by CSS fixed height\n    } else if (bounds.cappedHeight) {\n      // max-height\n\n      // not a fixed height panel\n      var isCappedHeight = visualHeight >= bounds.cappedHeight;\n      var panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n      panel.scalable = true;\n      panel.height = isCappedHeight ? panelHeight : panelHeight - listItemMargin.top - listItemMargin.bottom;\n\n      // available height for list\n      var _listAvailableHeight2 =\n      // the height of the panel minus the label height\n      panelHeight - currentLabelHeight - (\n      // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - (\n      // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0);\n\n      // set list height (if is overflowing)\n      if (visualHeight > bounds.cappedHeight && listHeight.visual > _listAvailableHeight2) {\n        list.overflow = _listAvailableHeight2;\n      } else {\n        list.overflow = null;\n      }\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = Math.min(bounds.cappedHeight, boundsHeight - listItemMargin.top - listItemMargin.bottom);\n    } else {\n      // flexible height\n\n      // not a fixed height panel\n      var itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n      panel.scalable = true;\n      panel.height = Math.max(labelHeight, visualHeight - itemMargin);\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    }\n\n    // move credits to bottom\n    if (root.ref.credits && panel.heightCurrent) root.ref.credits.style.transform = 'translateY(' + panel.heightCurrent + 'px)';\n  };\n  var calculateListItemMargin = function calculateListItemMargin(root) {\n    var item = root.ref.list.childViews[0].childViews[0];\n    return item ? {\n      top: item.rect.element.marginTop,\n      bottom: item.rect.element.marginBottom\n    } : {\n      top: 0,\n      bottom: 0\n    };\n  };\n  var calculateListHeight = function calculateListHeight(root) {\n    var visual = 0;\n    var bounds = 0;\n\n    // get file list reference\n    var scrollList = root.ref.list;\n    var itemList = scrollList.childViews[0];\n    var visibleChildren = itemList.childViews.filter(function (child) {\n      return child.rect.element.height;\n    });\n    var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n      return visibleChildren.find(function (child) {\n        return child.id === item.id;\n      });\n    }).filter(function (item) {\n      return item;\n    });\n\n    // no children, done!\n    if (children.length === 0) return {\n      visual: visual,\n      bounds: bounds\n    };\n    var horizontalSpace = itemList.rect.element.width;\n    var dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    var removedItem = children.find(function (child) {\n      return child.markedForRemoval && child.opacity < 0.45;\n    }) ? -1 : 0;\n    var verticalItemCount = children.length + newItem + removedItem;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      children.forEach(function (item) {\n        var height = item.rect.element.height + itemVerticalMargin;\n        bounds += height;\n        visual += height * item.opacity;\n      });\n    }\n    // grid\n    else {\n      bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n      visual = bounds;\n    }\n    return {\n      visual: visual,\n      bounds: bounds\n    };\n  };\n  var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(root) {\n    var height = root.ref.measureHeight || null;\n    var cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    var fixedHeight = height === 0 ? null : height;\n    return {\n      cappedHeight: cappedHeight,\n      fixedHeight: fixedHeight\n    };\n  };\n  var exceedsMaxFiles = function exceedsMaxFiles(root, items) {\n    var allowReplace = root.query('GET_ALLOW_REPLACE');\n    var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = root.query('GET_MAX_FILES');\n\n    // total amount of items being dragged\n    var totalBrowseItems = items.length;\n\n    // if does not allow multiple items and dragging more than one item\n    if (!allowMultiple && totalBrowseItems > 1) {\n      return true;\n    }\n\n    // limit max items to one if not allowed to drop multiple items\n    maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1;\n\n    // no more room?\n    var hasMaxItems = isInt(maxItems);\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n      root.dispatch('DID_THROW_MAX_FILES', {\n        source: items,\n        error: createResponse('warning', 0, 'Max files')\n      });\n      return true;\n    }\n    return false;\n  };\n  var getDragIndex = function getDragIndex(list, children, position) {\n    var itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, children, {\n      left: position.scopeLeft - itemList.rect.element.left,\n      top: position.scopeTop - (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop)\n    });\n  };\n\n  /**\n   * Enable or disable file drop functionality\n   */\n  var toggleDrop = function toggleDrop(root) {\n    var isAllowed = root.query('GET_ALLOW_DROP');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.hopper) {\n      var hopper = createHopper(root.element, function (items) {\n        // allow quick validation of dropped items\n        var beforeDropFile = root.query('GET_BEFORE_DROP_FILE') || function () {\n          return true;\n        };\n\n        // all items should be validated by all filters as valid\n        var dropValidation = root.query('GET_DROP_VALIDATION');\n        return dropValidation ? items.every(function (item) {\n          return applyFilters('ALLOW_HOPPER_ITEM', item, {\n            query: root.query\n          }).every(function (result) {\n            return result === true;\n          }) && beforeDropFile(item);\n        }) : true;\n      }, {\n        filterItems: function filterItems(items) {\n          var ignoredFiles = root.query('GET_IGNORED_FILES');\n          return items.filter(function (item) {\n            if (isFile(item)) {\n              return !ignoredFiles.includes(item.name.toLowerCase());\n            }\n            return true;\n          });\n        },\n        catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n        requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT')\n      });\n      hopper.onload = function (items, position) {\n        // get item children elements and sort based on list sort\n        var list = root.ref.list.childViews[0];\n        var visibleChildren = list.childViews.filter(function (child) {\n          return child.rect.element.height;\n        });\n        var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n          return visibleChildren.find(function (child) {\n            return child.id === item.id;\n          });\n        }).filter(function (item) {\n          return item;\n        });\n        applyFilterChain('ADD_ITEMS', items, {\n          dispatch: root.dispatch\n        }).then(function (queue) {\n          // these files don't fit so stop here\n          if (exceedsMaxFiles(root, queue)) return false;\n\n          // go\n          root.dispatch('ADD_ITEMS', {\n            items: queue,\n            index: getDragIndex(root.ref.list, children, position),\n            interactionMethod: InteractionMethod.DROP\n          });\n        });\n        root.dispatch('DID_DROP', {\n          position: position\n        });\n        root.dispatch('DID_END_DRAG', {\n          position: position\n        });\n      };\n      hopper.ondragstart = function (position) {\n        root.dispatch('DID_START_DRAG', {\n          position: position\n        });\n      };\n      hopper.ondrag = debounce(function (position) {\n        root.dispatch('DID_DRAG', {\n          position: position\n        });\n      });\n      hopper.ondragend = function (position) {\n        root.dispatch('DID_END_DRAG', {\n          position: position\n        });\n      };\n      root.ref.hopper = hopper;\n      root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n      root.ref.hopper.destroy();\n      root.ref.hopper = null;\n      root.removeChildView(root.ref.drip);\n    }\n  };\n\n  /**\n   * Enable or disable browse functionality\n   */\n  var toggleBrowse = function toggleBrowse(root, props) {\n    var isAllowed = root.query('GET_ALLOW_BROWSE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.browser) {\n      root.ref.browser = root.appendChildView(root.createChildView(browser, Object.assign({}, props, {\n        onload: function onload(items) {\n          applyFilterChain('ADD_ITEMS', items, {\n            dispatch: root.dispatch\n          }).then(function (queue) {\n            // these files don't fit so stop here\n            if (exceedsMaxFiles(root, queue)) return false;\n\n            // add items!\n            root.dispatch('ADD_ITEMS', {\n              items: queue,\n              index: -1,\n              interactionMethod: InteractionMethod.BROWSE\n            });\n          });\n        }\n      })), 0);\n    } else if (!enabled && root.ref.browser) {\n      root.removeChildView(root.ref.browser);\n      root.ref.browser = null;\n    }\n  };\n\n  /**\n   * Enable or disable paste functionality\n   */\n  var togglePaste = function togglePaste(root) {\n    var isAllowed = root.query('GET_ALLOW_PASTE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.paster) {\n      root.ref.paster = createPaster();\n      root.ref.paster.onload = function (items) {\n        applyFilterChain('ADD_ITEMS', items, {\n          dispatch: root.dispatch\n        }).then(function (queue) {\n          // these files don't fit so stop here\n          if (exceedsMaxFiles(root, queue)) return false;\n\n          // add items!\n          root.dispatch('ADD_ITEMS', {\n            items: queue,\n            index: -1,\n            interactionMethod: InteractionMethod.PASTE\n          });\n        });\n      };\n    } else if (!enabled && root.ref.paster) {\n      root.ref.paster.destroy();\n      root.ref.paster = null;\n    }\n  };\n\n  /**\n   * Route actions\n   */\n  var route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {\n      var root = _ref6.root;\n      toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {\n      var root = _ref7.root;\n      togglePaste(root);\n    },\n    DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {\n      var root = _ref8.root,\n        props = _ref8.props;\n      toggleDrop(root);\n      togglePaste(root);\n      toggleBrowse(root, props);\n      var isDisabled = root.query('GET_DISABLED');\n      if (isDisabled) {\n        root.element.dataset.disabled = 'disabled';\n      } else {\n        // delete root.element.dataset.disabled; <= this does not work on iOS 10\n        root.element.removeAttribute('data-disabled');\n      }\n    }\n  });\n  var root = createView({\n    name: 'root',\n    read: function read(_ref9) {\n      var root = _ref9.root;\n      if (root.ref.measure) {\n        root.ref.measureHeight = root.ref.measure.offsetHeight;\n      }\n    },\n    create: create$e,\n    write: write$9,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      if (root.ref.paster) {\n        root.ref.paster.destroy();\n      }\n      if (root.ref.hopper) {\n        root.ref.hopper.destroy();\n      }\n      root.element.removeEventListener('touchmove', prevent);\n      root.element.removeEventListener('gesturestart', prevent);\n    },\n    mixins: {\n      styles: ['height']\n    }\n  });\n\n  // creates the app\n  var createApp = function createApp() {\n    var initialOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // let element\n    var originalElement = null;\n\n    // get default options\n    var defaultOptions = getOptions();\n\n    // create the data store, this will contain all our app info\n    var store = createStore(\n    // initial state (should be serializable)\n    createInitialState(defaultOptions),\n    // queries\n    [queries, createOptionQueries(defaultOptions)],\n    // action handlers\n    [actions, createOptionActions(defaultOptions)]);\n\n    // set initial options\n    store.dispatch('SET_OPTIONS', {\n      options: initialOptions\n    });\n\n    // kick thread if visibility changes\n    var visibilityHandler = function visibilityHandler() {\n      if (document.hidden) return;\n      store.dispatch('KICK');\n    };\n    document.addEventListener('visibilitychange', visibilityHandler);\n\n    // re-render on window resize start and finish\n    var resizeDoneTimer = null;\n    var isResizing = false;\n    var isResizingHorizontally = false;\n    var initialWindowWidth = null;\n    var currentWindowWidth = null;\n    var resizeHandler = function resizeHandler() {\n      if (!isResizing) {\n        isResizing = true;\n      }\n      clearTimeout(resizeDoneTimer);\n      resizeDoneTimer = setTimeout(function () {\n        isResizing = false;\n        initialWindowWidth = null;\n        currentWindowWidth = null;\n        if (isResizingHorizontally) {\n          isResizingHorizontally = false;\n          store.dispatch('DID_STOP_RESIZE');\n        }\n      }, 500);\n    };\n    window.addEventListener('resize', resizeHandler);\n\n    // render initial view\n    var view = root(store, {\n      id: getUniqueId()\n    });\n\n    //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n    var isResting = false;\n    var isHidden = false;\n    var readWriteApi = {\n      // necessary for update loop\n\n      /**\n       * Reads from dom (never call manually)\n       * @private\n       */\n      _read: function _read() {\n        // test if we're resizing horizontally\n        // TODO: see if we can optimize this by measuring root rect\n        if (isResizing) {\n          currentWindowWidth = window.innerWidth;\n          if (!initialWindowWidth) {\n            initialWindowWidth = currentWindowWidth;\n          }\n          if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {\n            store.dispatch('DID_START_RESIZE');\n            isResizingHorizontally = true;\n          }\n        }\n        if (isHidden && isResting) {\n          // test if is no longer hidden\n          isResting = view.element.offsetParent === null;\n        }\n\n        // if resting, no need to read as numbers will still all be correct\n        if (isResting) return;\n\n        // read view data\n        view._read();\n\n        // if is hidden we need to know so we exit rest mode when revealed\n        isHidden = view.rect.element.hidden;\n      },\n      /**\n       * Writes to dom (never call manually)\n       * @private\n       */\n      _write: function _write(ts) {\n        // get all actions from store\n        var actions = store.processActionQueue()\n\n        // filter out set actions (these will automatically trigger DID_SET)\n        .filter(function (action) {\n          return !/^SET_/.test(action.type);\n        });\n\n        // if was idling and no actions stop here\n        if (isResting && !actions.length) return;\n\n        // some actions might trigger events\n        routeActionsToEvents(actions);\n\n        // update the view\n        isResting = view._write(ts, actions, isResizingHorizontally);\n\n        // will clean up all archived items\n        removeReleasedItems(store.query('GET_ITEMS'));\n\n        // now idling\n        if (isResting) {\n          store.processDispatchQueue();\n        }\n      }\n    };\n\n    //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n    var createEvent = function createEvent(name) {\n      return function (data) {\n        // create default event\n        var event = {\n          type: name\n        };\n\n        // no data to add\n        if (!data) {\n          return event;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('error')) {\n          event.error = data.error ? Object.assign({}, data.error) : null;\n        }\n        if (data.status) {\n          event.status = Object.assign({}, data.status);\n        }\n        if (data.file) {\n          event.output = data.file;\n        }\n\n        // only source is available, else add item if possible\n        if (data.source) {\n          event.file = data.source;\n        } else if (data.item || data.id) {\n          var item = data.item ? data.item : store.query('GET_ITEM', data.id);\n          event.file = item ? createItemAPI(item) : null;\n        }\n\n        // map all items in a possible items array\n        if (data.items) {\n          event.items = data.items.map(createItemAPI);\n        }\n\n        // if this is a progress event add the progress amount\n        if (/progress/.test(name)) {\n          event.progress = data.progress;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('origin') && data.hasOwnProperty('target')) {\n          event.origin = data.origin;\n          event.target = data.target;\n        }\n        return event;\n      };\n    };\n    var eventRoutes = {\n      DID_DESTROY: createEvent('destroy'),\n      DID_INIT: createEvent('init'),\n      DID_THROW_MAX_FILES: createEvent('warning'),\n      DID_INIT_ITEM: createEvent('initfile'),\n      DID_START_ITEM_LOAD: createEvent('addfilestart'),\n      DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n      DID_LOAD_ITEM: createEvent('addfile'),\n      DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n      DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n      DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],\n      DID_PREPARE_OUTPUT: createEvent('preparefile'),\n      DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n      DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n      DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n      DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n      DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n      DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],\n      DID_REMOVE_ITEM: createEvent('removefile'),\n      DID_UPDATE_ITEMS: createEvent('updatefiles'),\n      DID_ACTIVATE_ITEM: createEvent('activatefile'),\n      DID_REORDER_ITEMS: createEvent('reorderfiles')\n    };\n    var exposeEvent = function exposeEvent(event) {\n      // create event object to be dispatched\n      var detail = Object.assign({\n        pond: exports\n      }, event);\n      delete detail.type;\n      view.element.dispatchEvent(new CustomEvent('FilePond:' + event.type, {\n        // event info\n        detail: detail,\n        // event behaviour\n        bubbles: true,\n        cancelable: true,\n        composed: true // triggers listeners outside of shadow root\n      }));\n\n      // event object to params used for `on()` event handlers and callbacks `oninit()`\n      var params = [];\n\n      // if is possible error event, make it the first param\n      if (event.hasOwnProperty('error')) {\n        params.push(event.error);\n      }\n\n      // file is always section\n      if (event.hasOwnProperty('file')) {\n        params.push(event.file);\n      }\n\n      // append other props\n      var filtered = ['type', 'error', 'file'];\n      Object.keys(event).filter(function (key) {\n        return !filtered.includes(key);\n      }).forEach(function (key) {\n        return params.push(event[key]);\n      });\n\n      // on(type, () => { })\n      exports.fire.apply(exports, [event.type].concat(params));\n\n      // oninit = () => {}\n      var handler = store.query('GET_ON' + event.type.toUpperCase());\n      if (handler) {\n        handler.apply(void 0, params);\n      }\n    };\n    var routeActionsToEvents = function routeActionsToEvents(actions) {\n      if (!actions.length) return;\n      actions.filter(function (action) {\n        return eventRoutes[action.type];\n      }).forEach(function (action) {\n        var routes = eventRoutes[action.type];\n        (Array.isArray(routes) ? routes : [routes]).forEach(function (route) {\n          // this isn't fantastic, but because of the stacking of settimeouts plugins can handle the did_load before the did_init\n          if (action.type === 'DID_INIT_ITEM') {\n            exposeEvent(route(action.data));\n          } else {\n            setTimeout(function () {\n              exposeEvent(route(action.data));\n            }, 0);\n          }\n        });\n      });\n    };\n\n    //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n    var setOptions = function setOptions(options) {\n      return store.dispatch('SET_OPTIONS', {\n        options: options\n      });\n    };\n    var getFile = function getFile(query) {\n      return store.query('GET_ACTIVE_ITEM', query);\n    };\n    var prepareFile = function prepareFile(query) {\n      return new Promise(function (resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PREPARE', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n    var addFile = function addFile(source) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new Promise(function (resolve, reject) {\n        addFiles([{\n          source: source,\n          options: options\n        }], {\n          index: options.index\n        }).then(function (items) {\n          return resolve(items && items[0]);\n        }).catch(reject);\n      });\n    };\n    var isFilePondFile = function isFilePondFile(obj) {\n      return obj.file && obj.id;\n    };\n    var removeFile = function removeFile(query, options) {\n      // if only passed options\n      if (typeof query === 'object' && !isFilePondFile(query) && !options) {\n        options = query;\n        query = undefined;\n      }\n\n      // request item removal\n      store.dispatch('REMOVE_ITEM', Object.assign({}, options, {\n        query: query\n      }));\n\n      // see if item has been removed\n      return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n    var addFiles = function addFiles() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      return new Promise(function (resolve, reject) {\n        var sources = [];\n        var options = {};\n\n        // user passed a sources array\n        if (isArray(args[0])) {\n          sources.push.apply(sources, args[0]);\n          Object.assign(options, args[1] || {});\n        } else {\n          // user passed sources as arguments, last one might be options object\n          var lastArgument = args[args.length - 1];\n          if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {\n            Object.assign(options, args.pop());\n          }\n\n          // add rest to sources\n          sources.push.apply(sources, args);\n        }\n        store.dispatch('ADD_ITEMS', {\n          items: sources,\n          index: options.index,\n          interactionMethod: InteractionMethod.API,\n          success: resolve,\n          failure: reject\n        });\n      });\n    };\n    var getFiles = function getFiles() {\n      return store.query('GET_ACTIVE_ITEMS');\n    };\n    var processFile = function processFile(query) {\n      return new Promise(function (resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PROCESSING', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n    var prepareFiles = function prepareFiles() {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var items = queries.length ? queries : getFiles();\n      return Promise.all(items.map(prepareFile));\n    };\n    var processFiles = function processFiles() {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      if (!queries.length) {\n        var files = getFiles().filter(function (item) {\n          return !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) && item.status !== ItemStatus.PROCESSING && item.status !== ItemStatus.PROCESSING_COMPLETE && item.status !== ItemStatus.PROCESSING_REVERT_ERROR;\n        });\n        return Promise.all(files.map(processFile));\n      }\n      return Promise.all(queries.map(processFile));\n    };\n    var removeFiles = function removeFiles() {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var options;\n      if (typeof queries[queries.length - 1] === 'object') {\n        options = queries.pop();\n      } else if (Array.isArray(args[0])) {\n        options = args[1];\n      }\n      var files = getFiles();\n      if (!queries.length) return Promise.all(files.map(function (file) {\n        return removeFile(file, options);\n      }));\n\n      // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n      var mappedQueries = queries.map(function (query) {\n        return isNumber(query) ? files[query] ? files[query].id : null : query;\n      }).filter(function (query) {\n        return query;\n      });\n      return mappedQueries.map(function (q) {\n        return removeFile(q, options);\n      });\n    };\n    var exports = Object.assign({}, on(), {}, readWriteApi, {}, createOptionAPI(store, defaultOptions), {\n      /**\n       * Override options defined in options object\n       * @param options\n       */\n      setOptions: setOptions,\n      /**\n       * Load the given file\n       * @param source - the source of the file (either a File, base64 data uri or url)\n       * @param options - object, { index: 0 }\n       */\n      addFile: addFile,\n      /**\n       * Load the given files\n       * @param sources - the sources of the files to load\n       * @param options - object, { index: 0 }\n       */\n      addFiles: addFiles,\n      /**\n       * Returns the file objects matching the given query\n       * @param query { string, number, null }\n       */\n      getFile: getFile,\n      /**\n       * Upload file with given name\n       * @param query { string, number, null  }\n       */\n      processFile: processFile,\n      /**\n       * Request prepare output for file with given name\n       * @param query { string, number, null  }\n       */\n      prepareFile: prepareFile,\n      /**\n       * Removes a file by its name\n       * @param query { string, number, null  }\n       */\n      removeFile: removeFile,\n      /**\n       * Moves a file to a new location in the files list\n       */\n      moveFile: function moveFile(query, index) {\n        return store.dispatch('MOVE_ITEM', {\n          query: query,\n          index: index\n        });\n      },\n      /**\n       * Returns all files (wrapped in public api)\n       */\n      getFiles: getFiles,\n      /**\n       * Starts uploading all files\n       */\n      processFiles: processFiles,\n      /**\n       * Clears all files from the files list\n       */\n      removeFiles: removeFiles,\n      /**\n       * Starts preparing output of all files\n       */\n      prepareFiles: prepareFiles,\n      /**\n       * Sort list of files\n       */\n      sort: function sort(compare) {\n        return store.dispatch('SORT', {\n          compare: compare\n        });\n      },\n      /**\n       * Browse the file system for a file\n       */\n      browse: function browse() {\n        // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n        var input = view.element.querySelector('input[type=file]');\n        if (input) {\n          input.click();\n        }\n      },\n      /**\n       * Destroys the app\n       */\n      destroy: function destroy() {\n        // request destruction\n        exports.fire('destroy', view.element);\n\n        // stop active processes (file uploads, fetches, stuff like that)\n        // loop over items and depending on states call abort for ongoing processes\n        store.dispatch('ABORT_ALL');\n\n        // destroy view\n        view._destroy();\n\n        // stop listening to resize\n        window.removeEventListener('resize', resizeHandler);\n\n        // stop listening to the visiblitychange event\n        document.removeEventListener('visibilitychange', visibilityHandler);\n\n        // dispatch destroy\n        store.dispatch('DID_DESTROY');\n      },\n      /**\n       * Inserts the plugin before the target element\n       */\n      insertBefore: function insertBefore$1(element) {\n        return insertBefore(view.element, element);\n      },\n      /**\n       * Inserts the plugin after the target element\n       */\n      insertAfter: function insertAfter$1(element) {\n        return insertAfter(view.element, element);\n      },\n      /**\n       * Appends the plugin to the target element\n       */\n      appendTo: function appendTo(element) {\n        return element.appendChild(view.element);\n      },\n      /**\n       * Replaces an element with the app\n       */\n      replaceElement: function replaceElement(element) {\n        // insert the app before the element\n        insertBefore(view.element, element);\n\n        // remove the original element\n        element.parentNode.removeChild(element);\n\n        // remember original element\n        originalElement = element;\n      },\n      /**\n       * Restores the original element\n       */\n      restoreElement: function restoreElement() {\n        if (!originalElement) {\n          return; // no element to restore\n        }\n\n        // restore original element\n        insertAfter(originalElement, view.element);\n\n        // remove our element\n        view.element.parentNode.removeChild(view.element);\n\n        // remove reference\n        originalElement = null;\n      },\n      /**\n       * Returns true if the app root is attached to given element\n       * @param element\n       */\n      isAttachedTo: function isAttachedTo(element) {\n        return view.element === element || originalElement === element;\n      },\n      /**\n       * Returns the root element\n       */\n      element: {\n        get: function get() {\n          return view.element;\n        }\n      },\n      /**\n       * Returns the current pond status\n       */\n      status: {\n        get: function get() {\n          return store.query('GET_STATUS');\n        }\n      }\n    });\n\n    // Done!\n    store.dispatch('DID_INIT');\n\n    // create actual api object\n    return createObject(exports);\n  };\n  var createAppObject = function createAppObject() {\n    var customOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // default options\n    var defaultOptions = {};\n    forin(getOptions(), function (key, value) {\n      defaultOptions[key] = value[0];\n    });\n\n    // set app options\n    var app = createApp(Object.assign({}, defaultOptions, {}, customOptions));\n\n    // return the plugin instance\n    return app;\n  };\n  var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {\n    return string.charAt(0).toLowerCase() + string.slice(1);\n  };\n  var attributeNameToPropertyName = function attributeNameToPropertyName(attributeName) {\n    return toCamels(attributeName.replace(/^data-/, ''));\n  };\n  var mapObject = function mapObject(object, propertyMap) {\n    // remove unwanted\n    forin(propertyMap, function (selector, mapping) {\n      forin(object, function (property, value) {\n        // create regexp shortcut\n        var selectorRegExp = new RegExp(selector);\n\n        // tests if\n        var matches = selectorRegExp.test(property);\n\n        // no match, skip\n        if (!matches) {\n          return;\n        }\n\n        // if there's a mapping, the original property is always removed\n        delete object[property];\n\n        // should only remove, we done!\n        if (mapping === false) {\n          return;\n        }\n\n        // move value to new property\n        if (isString(mapping)) {\n          object[mapping] = value;\n          return;\n        }\n\n        // move to group\n        var group = mapping.group;\n        if (isObject(mapping) && !object[group]) {\n          object[group] = {};\n        }\n        object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;\n      });\n\n      // do submapping\n      if (mapping.mapping) {\n        mapObject(object[mapping.group], mapping.mapping);\n      }\n    });\n  };\n  var getAttributesAsObject = function getAttributesAsObject(node) {\n    var attributeMapping = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    // turn attributes into object\n    var attributes = [];\n    forin(node.attributes, function (index) {\n      attributes.push(node.attributes[index]);\n    });\n    var output = attributes.filter(function (attribute) {\n      return attribute.name;\n    }).reduce(function (obj, attribute) {\n      var value = attr(node, attribute.name);\n      obj[attributeNameToPropertyName(attribute.name)] = value === attribute.name ? true : value;\n      return obj;\n    }, {});\n\n    // do mapping of object properties\n    mapObject(output, attributeMapping);\n    return output;\n  };\n  var createAppAtElement = function createAppAtElement(element) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    // how attributes of the input element are mapped to the options for the plugin\n    var attributeMapping = {\n      // translate to other name\n      '^class$': 'className',\n      '^multiple$': 'allowMultiple',\n      '^capture$': 'captureMethod',\n      '^webkitdirectory$': 'allowDirectoriesOnly',\n      // group under single property\n      '^server': {\n        group: 'server',\n        mapping: {\n          '^process': {\n            group: 'process'\n          },\n          '^revert': {\n            group: 'revert'\n          },\n          '^fetch': {\n            group: 'fetch'\n          },\n          '^restore': {\n            group: 'restore'\n          },\n          '^load': {\n            group: 'load'\n          }\n        }\n      },\n      // don't include in object\n      '^type$': false,\n      '^files$': false\n    };\n\n    // add additional option translators\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);\n\n    // create final options object by setting options object and then overriding options supplied on element\n    var mergedOptions = Object.assign({}, options);\n    var attributeOptions = getAttributesAsObject(element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element, attributeMapping);\n\n    // merge with options object\n    Object.keys(attributeOptions).forEach(function (key) {\n      if (isObject(attributeOptions[key])) {\n        if (!isObject(mergedOptions[key])) {\n          mergedOptions[key] = {};\n        }\n        Object.assign(mergedOptions[key], attributeOptions[key]);\n      } else {\n        mergedOptions[key] = attributeOptions[key];\n      }\n    });\n\n    // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n    mergedOptions.files = (options.files || []).concat(Array.from(element.querySelectorAll('input:not([type=file])')).map(function (input) {\n      return {\n        source: input.value,\n        options: {\n          type: input.dataset.type\n        }\n      };\n    }));\n\n    // build plugin\n    var app = createAppObject(mergedOptions);\n\n    // add already selected files\n    if (element.files) {\n      Array.from(element.files).forEach(function (file) {\n        app.addFile(file);\n      });\n    }\n\n    // replace the target element\n    app.replaceElement(element);\n\n    // expose\n    return app;\n  };\n\n  // if an element is passed, we create the instance at that element, if not, we just create an up object\n  var createApp$1 = function createApp() {\n    return isNode(arguments.length <= 0 ? undefined : arguments[0]) ? createAppAtElement.apply(void 0, arguments) : createAppObject.apply(void 0, arguments);\n  };\n  var PRIVATE_METHODS = ['fire', '_read', '_write'];\n  var createAppAPI = function createAppAPI(app) {\n    var api = {};\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n    return api;\n  };\n\n  /**\n   * Replaces placeholders in given string with replacements\n   * @param string - \"Foo {bar}\"\"\n   * @param replacements - { \"bar\": 10 }\n   */\n  var replaceInString = function replaceInString(string, replacements) {\n    return string.replace(/(?:{([a-zA-Z]+)})/g, function (match, group) {\n      return replacements[group];\n    });\n  };\n  var createWorker = function createWorker(fn) {\n    var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n      type: 'application/javascript'\n    });\n    var workerURL = URL.createObjectURL(workerBlob);\n    var worker = new Worker(workerURL);\n    return {\n      transfer: function transfer(message, cb) {},\n      post: function post(message, cb, transferList) {\n        var id = getUniqueId();\n        worker.onmessage = function (e) {\n          if (e.data.id === id) {\n            cb(e.data.message);\n          }\n        };\n        worker.postMessage({\n          id: id,\n          message: message\n        }, transferList);\n      },\n      terminate: function terminate() {\n        worker.terminate();\n        URL.revokeObjectURL(workerURL);\n      }\n    };\n  };\n  var loadImage = function loadImage(url) {\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n      img.onload = function () {\n        resolve(img);\n      };\n      img.onerror = function (e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n  var renameFile = function renameFile(file, name) {\n    var renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n  };\n  var copyFile = function copyFile(file) {\n    return renameFile(file, file.name);\n  };\n\n  // already registered plugins (can't register twice)\n  var registeredPlugins = [];\n\n  // pass utils to plugin\n  var createAppPlugin = function createAppPlugin(plugin) {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n      return;\n    }\n\n    // remember this plugin\n    registeredPlugins.push(plugin);\n\n    // setup!\n    var pluginOutline = plugin({\n      addFilter: addFilter,\n      utils: {\n        Type: Type,\n        forin: forin,\n        isString: isString,\n        isFile: isFile,\n        toNaturalFileSize: toNaturalFileSize,\n        replaceInString: replaceInString,\n        getExtensionFromFilename: getExtensionFromFilename,\n        getFilenameWithoutExtension: getFilenameWithoutExtension,\n        guesstimateMimeType: guesstimateMimeType,\n        getFileFromBlob: getFileFromBlob,\n        getFilenameFromURL: getFilenameFromURL,\n        createRoute: createRoute,\n        createWorker: createWorker,\n        createView: createView,\n        createItemAPI: createItemAPI,\n        loadImage: loadImage,\n        copyFile: copyFile,\n        renameFile: renameFile,\n        createBlob: createBlob,\n        applyFilterChain: applyFilterChain,\n        text: text,\n        getNumericAspectRatioFromString: getNumericAspectRatioFromString\n      },\n      views: {\n        fileActionButton: fileActionButton\n      }\n    });\n\n    // add plugin options to default options\n    extendDefaultOptions(pluginOutline.options);\n  };\n\n  // feature detection used by supported() method\n  var isOperaMini = function isOperaMini() {\n    return Object.prototype.toString.call(window.operamini) === '[object OperaMini]';\n  };\n  var hasPromises = function hasPromises() {\n    return 'Promise' in window;\n  };\n  var hasBlobSlice = function hasBlobSlice() {\n    return 'slice' in Blob.prototype;\n  };\n  var hasCreateObjectURL = function hasCreateObjectURL() {\n    return 'URL' in window && 'createObjectURL' in window.URL;\n  };\n  var hasVisibility = function hasVisibility() {\n    return 'visibilityState' in document;\n  };\n  var hasTiming = function hasTiming() {\n    return 'performance' in window;\n  }; // iOS 8.x\n  var hasCSSSupports = function hasCSSSupports() {\n    return 'supports' in (window.CSS || {});\n  }; // use to detect Safari 9+\n  var isIE11 = function isIE11() {\n    return /MSIE|Trident/.test(window.navigator.userAgent);\n  };\n  var supported = function () {\n    // Runs immediately and then remembers result for subsequent calls\n    var isSupported =\n    // Has to be a browser\n    isBrowser() &&\n    // Can't run on Opera Mini due to lack of everything\n    !isOperaMini() &&\n    // Require these APIs to feature detect a modern browser\n    hasVisibility() && hasPromises() && hasBlobSlice() && hasCreateObjectURL() && hasTiming() && (\n    // doesn't need CSSSupports but is a good way to detect Safari 9+ (we do want to support IE11 though)\n    hasCSSSupports() || isIE11());\n    return function () {\n      return isSupported;\n    };\n  }();\n\n  /**\n   * Plugin internal state (over all instances)\n   */\n  var state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: []\n  };\n\n  // plugin name\n  var name = 'filepond';\n\n  /**\n   * Public Plugin methods\n   */\n  var fn = function fn() {};\n  exports.Status = {};\n  exports.FileStatus = {};\n  exports.FileOrigin = {};\n  exports.OptionTypes = {};\n  exports.create = fn;\n  exports.destroy = fn;\n  exports.parse = fn;\n  exports.find = fn;\n  exports.registerPlugin = fn;\n  exports.getOptions = fn;\n  exports.setOptions = fn;\n\n  // if not supported, no API\n  if (supported()) {\n    // start painter and fire load event\n    createPainter(function () {\n      state.apps.forEach(function (app) {\n        return app._read();\n      });\n    }, function (ts) {\n      state.apps.forEach(function (app) {\n        return app._write(ts);\n      });\n    });\n\n    // fire loaded event so we know when FilePond is available\n    var dispatch = function dispatch() {\n      // let others know we have area ready\n      document.dispatchEvent(new CustomEvent('FilePond:loaded', {\n        detail: {\n          supported: supported,\n          create: exports.create,\n          destroy: exports.destroy,\n          parse: exports.parse,\n          find: exports.find,\n          registerPlugin: exports.registerPlugin,\n          setOptions: exports.setOptions\n        }\n      }));\n\n      // clean up event\n      document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n    if (document.readyState !== 'loading') {\n      // move to back of execution queue, FilePond should have been exported by then\n      setTimeout(function () {\n        return dispatch();\n      }, 0);\n    } else {\n      document.addEventListener('DOMContentLoaded', dispatch);\n    }\n\n    // updates the OptionTypes object based on the current options\n    var updateOptionTypes = function updateOptionTypes() {\n      return forin(getOptions(), function (key, value) {\n        exports.OptionTypes[key] = value[1];\n      });\n    };\n    exports.Status = Object.assign({}, Status);\n    exports.FileOrigin = Object.assign({}, FileOrigin);\n    exports.FileStatus = Object.assign({}, ItemStatus);\n    exports.OptionTypes = {};\n    updateOptionTypes();\n\n    // create method, creates apps and adds them to the app array\n    exports.create = function create() {\n      var app = createApp$1.apply(void 0, arguments);\n      app.on('destroy', exports.destroy);\n      state.apps.push(app);\n      return createAppAPI(app);\n    };\n\n    // destroys apps and removes them from the app array\n    exports.destroy = function destroy(hook) {\n      // returns true if the app was destroyed successfully\n      var indexToRemove = state.apps.findIndex(function (app) {\n        return app.isAttachedTo(hook);\n      });\n      if (indexToRemove >= 0) {\n        // remove from apps\n        var app = state.apps.splice(indexToRemove, 1)[0];\n\n        // restore original dom element\n        app.restoreElement();\n        return true;\n      }\n      return false;\n    };\n\n    // parses the given context for plugins (does not include the context element itself)\n    exports.parse = function parse(context) {\n      // get all possible hooks\n      var matchedHooks = Array.from(context.querySelectorAll('.' + name));\n\n      // filter out already active hooks\n      var newHooks = matchedHooks.filter(function (newHook) {\n        return !state.apps.find(function (app) {\n          return app.isAttachedTo(newHook);\n        });\n      });\n\n      // create new instance for each hook\n      return newHooks.map(function (hook) {\n        return exports.create(hook);\n      });\n    };\n\n    // returns an app based on the given element hook\n    exports.find = function find(hook) {\n      var app = state.apps.find(function (app) {\n        return app.isAttachedTo(hook);\n      });\n      if (!app) {\n        return null;\n      }\n      return createAppAPI(app);\n    };\n\n    // adds a plugin extension\n    exports.registerPlugin = function registerPlugin() {\n      for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {\n        plugins[_key] = arguments[_key];\n      }\n\n      // register plugins\n      plugins.forEach(createAppPlugin);\n\n      // update OptionTypes, each plugin might have extended the default options\n      updateOptionTypes();\n    };\n    exports.getOptions = function getOptions$1() {\n      var opts = {};\n      forin(getOptions(), function (key, value) {\n        opts[key] = value[0];\n      });\n      return opts;\n    };\n    exports.setOptions = function setOptions$1(opts) {\n      if (isObject(opts)) {\n        // update existing plugins\n        state.apps.forEach(function (app) {\n          app.setOptions(opts);\n        });\n\n        // override defaults\n        setOptions(opts);\n      }\n\n      // return new options\n      return exports.getOptions();\n    };\n  }\n  exports.supported = supported;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"names":["global","factory","exports","module","define","amd","self","FilePond","isNode","value","HTMLElement","createStore","initialState","queries","arguments","length","undefined","actions","state","Object","assign","actionQueue","dispatchQueue","getState","processActionQueue","queue","concat","processDispatchQueue","forEach","_ref","type","data","dispatch","isBlocking","document","hidden","push","actionHandlers","query","str","_queryHandles","_len","args","Array","_key","queryHandles","apply","api","action","defineProperty","obj","property","definition","forin","cb","key","hasOwnProperty","createObject","attr","node","name","getAttribute","hasAttribute","setAttribute","ns","svgElements","isSVGElement","tag","includes","createElement","className","attributes","element","createElementNS","appendChild","parent","child","index","children","insertBefore","appendChildView","childViews","view","splice","removeChildView","indexOf","parentNode","removeChild","IS_BROWSER","window","isBrowser","testElement","getChildCount","el","childNodes","getViewRect","elementRect","offset","scale","left","top","right","width","bottom","height","rect","inner","outer","filter","childView","isRectIgnored","map","childViewRect","expandRect","calculateRectSize","marginBottom","marginRight","isNumber","thereYet","position","destination","velocity","errorMargin","Math","abs","spring","_ref$stiffness","stiffness","_ref$damping","damping","_ref$mass","mass","target","resting","interpolate","ts","skipToEndState","f","onupdate","oncomplete","setTarget","set","get","easeLinear","t","easeInOutQuad","tween","_ref$duration","duration","_ref$easing","easing","_ref$delay","delay","start","p","reverse","animator","createAnimator","category","def","props","addGetSet","keys","overwrite","isArray","o","getter","setter","animations","mixinConfig","viewProps","viewInternalAPI","viewExternalAPI","initialProps","animation","prop","write","destroy","addEvent","fn","addEventListener","removeEvent","removeEventListener","listeners","viewState","events","add","remove","on","off","findIndex","event","apis","isDefined","defaults","opacity","scaleX","scaleY","translateX","translateY","rotateX","rotateY","rotateZ","originX","originY","styles","currentProps","getOffset","getScale","getRect","propsHaveChanged","applyStyles","newProps","_ref2","perspective","transforms","elementCurrentStyle","style","cssText","Mixins","updateRect","layoutCalculated","paddingTop","parseInt","marginTop","marginLeft","offsetLeft","offsetTop","offsetWidth","offsetHeight","scrollTop","offsetParent","createView","_ref$tag","_ref$name","_ref$attributes","_ref$read","read","_ref$write","_ref$create","create","_ref$destroy","_ref$filterFrameActio","filterFrameActionsForChild","_ref$didCreateView","didCreateView","_ref$didWriteView","didWriteView","_ref$ignoreRect","ignoreRect","_ref$ignoreRectUpdate","ignoreRectUpdate","_ref$mixins","mixins","store","getComputedStyle","frameRect","isResting","activeMixins","ref","writers","readers","destroyers","getElement","getChildViews","getReference","createChildView","getStyle","_read","shouldUpdate","root","internalAPI","reader","_write","frameActions","shouldOptimize","writer","writerResting","timestamp","mixin","mixinResting","childResting","_destroy","destroyer","sharedAPIDefinition","internalAPIDefinition","is","needle","linkView","unlinkView","registerWriter","registerReader","registerDestroyer","invalidateLayout","externalAPIDefinition","mixinAPIDefinition","sort","a","b","mixinAPI","childCount","createPainter","fps","painter","interval","last","id","requestTick","cancelTick","setTimerType","setTimeout","tick","performance","now","clearTimeout","requestAnimationFrame","cancelAnimationFrame","delta","pause","createRoute","routes","_ref$actions","newNode","referenceNode","insertAfter","nextSibling","isEmpty","trim","toString","toArray","splitter","split","isBoolean","toBoolean","isString","toNumber","replace","toInt","toFloat","parseFloat","isInt","isFinite","floor","toBytes","base","naturalFileSize","test","isFunction","toFunctionReference","string","levels","level","shift","methods","process","patch","revert","fetch","restore","load","createServerAPI","outline","url","timeout","headers","createAction","method","withCredentials","onload","ondata","onerror","parts","header","toServerAPI","isNull","isObject","isAPI","getType","replaceSingleQuotes","conversionTable","array","boolean","int","number","float","bytes","function","_function","serverapi","object","JSON","parse","e","convertTo","getValueByType","newValue","defaultValue","valueType","newValueType","convertedValue","option","createOption","currentValue","enumerable","createOptions","options","optionDefinition","createInitialState","items","listUpdateTimeout","itemUpdateTimeout","processingQueue","fromCamels","separator","part","toLowerCase","join","createOptionAPI","toUpperCase","createOptionActions","createOptionQueries","InteractionMethod","API","DROP","BROWSE","PASTE","NONE","getUniqueId","random","substr","_typeof","Symbol","iterator","constructor","prototype","REACT_ELEMENT_TYPE","_jsx","defaultProps","childrenLength","propName","childArray","i","$$typeof","_owner","_asyncIterator","iterable","asyncIterator","call","TypeError","_AwaitValue","wrapped","_AsyncGenerator","gen","front","back","send","arg","Promise","resolve","reject","request","next","resume","result","wrappedAwait","then","settle","done","err","_invoke","return","throw","_wrapAsyncGenerator","_awaitAsyncGenerator","_asyncGeneratorDelegate","awaitWrap","iter","waiting","pump","asyncGeneratorStep","_next","_throw","info","error","_asyncToGenerator","_classCallCheck","instance","Constructor","_defineProperties","descriptor","configurable","writable","_createClass","protoProps","staticProps","_defineEnumerableProperties","descs","desc","getOwnPropertySymbols","objectSymbols","sym","_defaults","getOwnPropertyNames","getOwnPropertyDescriptor","_defineProperty","_extends","source","_objectSpread","ownKeys","enumerableOnly","symbols","_objectSpread2","getOwnPropertyDescriptors","defineProperties","_inherits","subClass","superClass","_setPrototypeOf","_inheritsLoose","__proto__","_getPrototypeOf","setPrototypeOf","getPrototypeOf","isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","_construct","Parent","Class","Function","bind","_isNativeFunction","_wrapNativeSuper","_cache","Map","has","Wrapper","_instanceof","hasInstance","_interopRequireDefault","__esModule","default","_interopRequireWildcard","newObj","_newArrowCheck","innerThis","boundThis","_objectDestructuringEmpty","_objectWithoutPropertiesLoose","excluded","sourceKeys","_objectWithoutProperties","sourceSymbolKeys","propertyIsEnumerable","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_superPropBase","_get","receiver","_set","isStrict","s","Error","_taggedTemplateLiteral","strings","raw","slice","freeze","_taggedTemplateLiteralLoose","_temporalRef","val","_temporalUndefined","_readOnlyError","_classNameTDZError","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_slicedToArrayLoose","_iterableToArrayLimitLoose","_toArray","_iterableToArray","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","arr2","from","_arr","_n","_d","_e","_i","_s","_iterator","_step","_skipFirstGeneratorNext","it","_toPrimitive","input","hint","prim","toPrimitive","res","String","Number","_toPropertyKey","_initializerWarningHelper","context","_initializerDefineProperty","initializer","_applyDecoratedDescriptor","decorators","reduce","decorator","_classPrivateFieldLooseKey","_classPrivateFieldLooseBase","privateKey","_classPrivateFieldGet","privateMap","_classPrivateFieldSet","_classPrivateFieldDestructureSet","__destrObj","v","_classStaticPrivateFieldSpecGet","classConstructor","_classStaticPrivateFieldSpecSet","_classStaticPrivateMethodGet","_classStaticPrivateMethodSet","_decorate","_getDecoratorsApi","r","initialize","O","initializeInstanceElements","decorated","elements","decorateClass","_coalesceClassElements","d","_createElementDescriptor","initializeClassElements","F","runClassFinishers","finishers","elementsDefinitionOrder","kind","placement","defineClassElement","proto","newElements","placements","static","own","addElementPlacement","_hasDecorators","elementFinishersExtras","decorateElement","extras","decorateConstructor","silent","elementObject","fromElementDescriptor","elementFinisherExtras","toElementFinisherExtras","finisher","newExtras","j","fromClassDescriptor","elementsAndFinisher","toClassDescriptor","k","toStringTag","toElementDescriptors","elementObjects","toElementDescriptor","disallowProperty","_optionalCallableProperty","newConstructor","objectType","_coalesceGetterSetter","other","isSameElement","find","_isDataDescriptor","_classPrivateMethodGet","privateSet","_classPrivateMethodSet","_wrapRegExp","re","groups","BabelRegExp","_RegExp","RegExp","_super","_groups","WeakMap","_this","exec","buildGroups","substitution","_","g","arrayRemove","run","sync","listener","_fire","fire","fireSync","_len2","_key2","onOnce","_cb","copyObjectPropertiesToObject","src","PRIVATE","createItemAPI","item","removeReleasedItems","released","ItemStatus","INIT","IDLE","PROCESSING_QUEUED","PROCESSING","PROCESSING_COMPLETE","PROCESSING_ERROR","PROCESSING_REVERT_ERROR","LOADING","LOAD_ERROR","FileOrigin","INPUT","LIMBO","LOCAL","getNonNumeric","getDecimalSeparator","toLocaleString","getThousandsSeparator","decimalSeparator","thousandsStringWithSeparator","thousandsStringWithoutSeparator","Type","BOOLEAN","INT","NUMBER","STRING","ARRAY","OBJECT","FUNCTION","ACTION","SERVER_API","REGEX","filters","applyFilterChain","utils","matchingFilters","initialFilter","current","catch","applyFilters","addFilter","extendDefaultOptions","additionalOptions","defaultOptions","getOptions","setOptions","opts","disabled","required","captureMethod","allowSyncAcceptAttribute","allowDrop","allowBrowse","allowPaste","allowMultiple","allowReplace","allowRevert","allowRemove","allowProcess","allowReorder","allowDirectoriesOnly","forceRevert","maxFiles","checkValidity","itemInsertLocationFreedom","itemInsertLocation","itemInsertInterval","dropOnPage","dropOnElement","dropValidation","ignoredFiles","instantUpload","maxParallelUploads","chunkUploads","chunkForce","chunkSize","chunkRetryDelays","server","fileSizeBase","labelDecimalSeparator","labelThousandsSeparator","labelIdle","labelInvalidField","labelFileWaitingForSize","labelFileSizeNotAvailable","labelFileCountSingular","labelFileCountPlural","labelFileLoading","labelFileAdded","labelFileLoadError","labelFileRemoved","labelFileRemoveError","labelFileProcessing","labelFileProcessingComplete","labelFileProcessingAborted","labelFileProcessingError","labelFileProcessingRevertError","labelTapToCancel","labelTapToRetry","labelTapToUndo","labelButtonRemoveItem","labelButtonAbortItemLoad","labelButtonRetryItemLoad","labelButtonAbortItemProcessing","labelButtonUndoItemProcessing","labelButtonRetryItemProcessing","labelButtonProcessItem","iconRemove","iconProcess","iconRetry","iconUndo","iconDone","oninit","onwarning","onactivatefile","oninitfile","onaddfilestart","onaddfileprogress","onaddfile","onprocessfilestart","onprocessfileprogress","onprocessfileabort","onprocessfilerevert","onprocessfile","onprocessfiles","onremovefile","onpreparefile","onupdatefiles","onreorderfiles","beforeDropFile","beforeAddFile","beforeRemoveFile","beforePrepareFile","stylePanelLayout","stylePanelAspectRatio","styleItemPanelAspectRatio","styleButtonRemoveItemPosition","styleButtonProcessItemPosition","styleLoadIndicatorPosition","styleProgressIndicatorPosition","styleButtonRemoveItemAlign","files","credits","getItemByQuery","getNumericAspectRatioFromString","aspectRatio","getActiveItems","archived","Status","EMPTY","ERROR","BUSY","READY","ITEM_ERROR","ITEM_BUSY","ITEM_READY","isItemInErrorState","status","isItemInBusyState","isItemInReadyState","GET_STATUS","some","GET_ITEM","GET_ACTIVE_ITEM","GET_ACTIVE_ITEMS","GET_ITEMS","GET_ITEM_NAME","filename","GET_ITEM_SIZE","fileSize","GET_STYLES","GET_PANEL_ASPECT_RATIO","isShapeCircle","GET_ITEM_PANEL_ASPECT_RATIO","GET_ITEMS_BY_STATUS","GET_TOTAL_ITEMS","IS_ASYNC","hasRoomForItem","count","maxFileCount","limit","min","max","arrayInsert","insertItem","isBase64DataURI","getFilenameFromURL","pop","getExtensionFromFilename","guesstimateExtension","subtype","leftPad","padding","getDateString","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getFileFromBlob","blob","extension","file","size","lastModifiedDate","_relativePath","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","createBlob","arrayBuffer","mimeType","BB","bb","append","getBlob","Blob","getBlobFromByteStringWithMimeType","byteString","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","getMimeTypeFromBase64DataURI","dataURI","getBase64DataFromBase64DataURI","getByteStringFromBase64DataURI","atob","getBlobFromBase64DataURI","getFileFromBase64DataURI","getFileNameFromHeader","matches","decodeURI","getFileSizeFromHeader","match","getTranfserIdFromHeader","getFileInfoFromHeaders","rows","_iteratorNormalCompletion","_didIteratorError","_iteratorError","createFileLoader","fetchFn","complete","progress","getProgress","abort","File","loadURL","body","code","response","computable","total","fileinfo","setSource","isGet","sendRequest","onheaders","onprogress","ontimeout","onabort","aborted","xhr","headersReceived","encodeURI","encodeURIComponent","stringify","XMLHttpRequest","upload","lengthComputable","loaded","onreadystatechange","readyState","open","unescape","setRequestHeader","responseType","createResponse","createTimeoutResponse","getAllResponseHeaders","hasQS","buildURL","createFetchFunction","apiUrl","statusText","ChunkStatus","QUEUED","COMPLETE","WAITING","processFileChunked","metadata","transfer","chunks","chunkTransferId","chunkServer","serverId","fd","getResponseHeader","requestTransferId","formData","FormData","requestParams","requestTransferOffset","requestUrl","lastChunkIndex","retries","completeProcessingChunks","canProcessChunk","chunk","processChunk","every","processChunks","updateTotalProgress","retryProcessChunk","totalBytesTransfered","totalSize","totalProcessing","abortChunks","createFileProcessorFunction","canChunkUpload","shouldChunkUpload","willChunkUpload","createProcessorFunction","params","createRevertFunction","uniqueFileId","getRandomNumber","createPerceivedPerformanceUpdater","tickMin","tickMax","runtime","clear","createFileProcessor","processFn","perceivedProgress","perceivedPerformanceUpdater","perceivedDuration","progressFn","completeFn","transferId","reset","getDuration","getFilenameWithoutExtension","lastIndexOf","createFileStub","isFile","deepCloneObject","createItem","origin","serverFileReference","frozen","processingAborted","activeLoader","activeProcessor","abortProcessingRequestComplete","setStatus","getFileExtension","getFileType","getFileSize","getFile","loader","meta","success","retryLoad","abortLoad","processor","onprocess","console","requestProcessing","abortProcessing","revertFileUpload","_setMetadata","setMetadata","getMetadata","filenameWithoutExtension","fileExtension","fileType","relativePath","extend","handler","itemAPI","release","archive","getItemIndexByQuery","getItemById","itemId","fetchBlob","getDomainFromURL","location","protocol","isExternalURL","href","dynamicLabel","label","isMockItem","listUpdated","optionalPromise","sortItems","compare","getItemByQueryFromState","itemHandler","_ref$success","_ref$failure","failure","ABORT_ALL","DID_SET_FILES","_ref2$value","activeItems","interactionMethod","DID_UPDATE_ITEM_METADATA","_ref3","shouldPrepareOutput","doUpload","MOVE_ITEM","_ref4","currentIndex","SORT","_ref5","ADD_ITEMS","_ref6","_ref6$success","_ref6$failure","insertLocation","totalItems","isValidFile","validItems","promises","all","ADD_ITEM","_ref7","_ref7$index","_ref7$success","_ref7$failure","_ref7$options","_item","mainStatus","main","sub","handleAdd","shouldAdd","change","loadComplete","_ref8","REQUEST_PREPARE_OUTPUT","_ref9","_ref9$failure","COMPLETE_LOAD_ITEM","_ref10","RETRY_ITEM_LOAD","REQUEST_ITEM_PREPARE","_success","output","REQUEST_ITEM_PROCESSING","itemCanBeQueuedForProcessing","processNow","PROCESS_ITEM","totalCurrentUploads","processNext","queueEntry","itemReference","allItemsProcessed","RETRY_ITEM_PROCESSING","REQUEST_REMOVE_ITEM","shouldRemove","RELEASE_ITEM","REMOVE_ITEM","removeFromView","ABORT_ITEM_LOAD","ABORT_ITEM_PROCESSING","REQUEST_REVERT_ITEM_PROCESSING","handleRevert","shouldRevert","requestRemoveResult","REVERT_ITEM_PROCESSING","SET_OPTIONS","_ref11","formatFilename","createElement$1","tagName","text","textNode","createTextNode","nodeValue","polarToCartesian","centerX","centerY","radius","angleInDegrees","angleInRadians","PI","x","cos","y","sin","describeArc","startAngle","endAngle","arcSweep","end","percentageArc","to","spin","svg","path","align","dataset","ringStrokeWidth","ringFrom","ringTo","coordinates","progressIndicator","create$1","innerHTML","icon","isDisabled","write$1","shouldDisable","removeAttribute","fileActionButton","toNaturalFileSize","round","KB","MB","GB","removeDecimalsWhenZero","decimalCount","toFixed","create$2","fileName","updateFile","updateFileSizeOnError","fileInfo","DID_LOAD_ITEM","DID_UPDATE_ITEM_META","DID_THROW_ITEM_LOAD_ERROR","DID_THROW_ITEM_INVALID","toPercentage","create$3","didSetItemLoadProgress","title","didSetItemProcessProgress","didRequestItemProcessing","didAbortItemProcessing","didCompleteItemProcessing","fileStatus","DID_REVERT_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_ABORT_ITEM_PROCESSING","DID_COMPLETE_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_UPDATE_ITEM_LOAD_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR","DID_THROW_ITEM_PROCESSING_REVERT_ERROR","DID_THROW_ITEM_REMOVE_ERROR","Buttons","AbortItemLoad","RetryItemLoad","RemoveItem","ProcessItem","AbortItemProcessing","RetryItemProcessing","RevertItemProcessing","ButtonKeys","calculateFileInfoOffset","buttonRect","buttonRemoveItem","calculateButtonWidth","buttonAbortItemLoad","calculateFileVerticalCenterOffset","calculateFileHorizontalCenterOffset","getLoadIndicatorAlignment","getProcessIndicatorAlignment","getRemoveIndicatorAligment","DefaultStyle","buttonRetryItemLoad","buttonProcessItem","buttonAbortItemProcessing","buttonRetryItemProcessing","buttonRevertItemProcessing","loadProgressIndicator","processProgressIndicator","processingCompleteIndicator","IdleStyle","ProcessingStyle","StyleMap","DID_START_ITEM_LOAD","DID_START_ITEM_REMOVE","DID_LOAD_LOCAL_ITEM","DID_START_ITEM_PROCESSING","processingCompleteIndicatorView","create$4","isAsync","alignRemoveItemButton","buttonFilter","enabledButtons","_map","buttonView","classList","stopPropagation","loadIndicatorView","progressIndicatorView","activeStyles","write$2","route","stylesToApply","defaultStyles","control","DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING","DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD","DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL","buttonAbortItemRemoval","_ref12","create$5","didLoadItem","fileWrapper","PANEL_SPRING_PROPS","create$6","section","createSection","scalable","viewConstructor","write$3","topRect","bottomRect","center","panel","heightCurrent","createDragHelper","itemIds","prevIndex","setIndex","getIndex","getItemIndex","ITEM_TRANSLATE_SPRING","ITEM_SCALE_SPRING","StateMap","create$7","handleClick","container","markedForRemoval","dragState","grab","isPrimary","removedActivateListener","pageX","pageY","dragOrigin","dragCenter","offsetX","offsetY","drag","preventDefault","dragOffset","dist","drop","route$1","DID_UPDATE_PANEL_HEIGHT","write$4","DID_GRAB_ITEM","DID_DRAG_ITEM","DID_DROP_ITEM","currentState","filepondItemState","getItemIndexByPosition","positionInView","horizontalSpace","l","itemRect","itemHorizontalMargin","itemWidth","itemsPerRow","childMid","itemVerticalMargin","itemHeight","_index","indexX","indexY","itemTop","itemRight","itemBottom","dropAreaDimensions","getHeight","setHeight","getWidth","setWidth","setDimensions","create$8","lastItemSpanwDate","addItemView","addIndex","spawnDate","cooldown","moveItem","vx","vy","introItemView","removeItemView","getItemHeight","getItemWidth","dragItem","numItems","oldIndex","dragPosition","dragHeight","dragWidth","cols","getGridIndex","getColIndex","visibleChildren","idx","childHeight","childBottom","childTop","route$2","DID_ADD_ITEM","DID_REMOVE_ITEM","write$5","dragCoordinates","dragIndex","dragIndexOffset","removeIndexOffset","addIndexOffset","childRect","visualHeight","prevX","prevY","visualIndex","vectorX","sign","vectorY","filterSetItemActions","list","create$9","overflowing","storeDragCoordinates","scopeLeft","scopeTop","clearDragCoordinates","route$3","DID_DRAG","DID_END_DRAG","write$6","overflow","newHeight","listScroller","attrToggle","enabledValue","resetFileInput","form","create$a","setAcceptedFileTypes","toggleAllowMultiple","toggleDirectoryFilter","toggleDisabled","toggleRequired","setCaptureMethod","handleChange","webkitRelativePath","doesAllowBrowse","disableField","updateRequiredStatus","shouldCheckValidity","setCustomValidity","updateFieldValidityStatus","browser","DID_SET_DISABLED","DID_SET_ALLOW_BROWSE","DID_SET_ALLOW_DIRECTORIES_ONLY","DID_SET_ALLOW_MULTIPLE","DID_SET_ACCEPTED_FILE_TYPES","DID_SET_CAPTURE_METHOD","DID_SET_REQUIRED","Key","ENTER","SPACE","create$b","handleKeyDown","isActivationKey","keyCode","click","isLabelClick","contains","updateLabelValue","caption","clickable","querySelector","dropLabel","DID_SET_LABEL_IDLE","addBlob","moveBlob","hideBlob","explodeBlob","write$7","route$4","DID_DROP","drip","create$c","fields","getField","syncFieldPositionsWithItems","didReorderItems","didAddItem","dataContainer","didLoadItem$1","field","didSetDisabled","didRemoveItem","didDefineValue","write$8","DID_DEFINE_VALUE","DID_REORDER_ITEMS","DID_SORT_ITEMS","getRootNode","images","text$1","zip","epub","guesstimateMimeType","requestDataTransferItems","dataTransfer","links","getLinks","hasFiles","getFiles","promisedFiles","isFileSystemItem","getFilesFromItem","returnedFileGroups","group","isEntry","entry","getAsEntry","isDirectory","isDirectoryEntry","getFilesInDirectory","getAsFile","dirCounter","fileCounter","resolveIfDone","readEntries","dirEntry","directoryReader","createReader","readBatch","entries","correctedFile","correctMissingFileType","fullPath","webkitGetAsEntry","getLinksFromTransferMetaData","getLinksFromTransferURLData","getData","dragNDropObservers","eventPosition","pageLeft","pageTop","layerX","layerY","createDragNDropClient","scopeToObserve","filterElement","observer","getDragNDropObserver","client","ondrop","onenter","ondrag","onexit","allowdrop","addListener","newObserver","createDragNDropObserver","clients","dragenter","dragover","dragleave","handlers","createHandler","elementFromPoint","point","isEventTarget","elementAtPosition","pageXOffset","pageYOffset","initialTarget","setDropEffect","effect","dropEffect","overDropTarget","allowsTransfer","createHopper","scope","validateItems","catchesDropsOnPage","requiresDropOnElement","_options$filterItems","filterItems","documentElement","lastState","filteredItems","ondragend","ondragstart","updateHopperState","hopperState","listening","listeners$1","handlePaste","activeEl","activeElement","nodeName","inScope","clipboardData","listen","unlisten","createPaster","create$d","addFilesNotificationTimeout","notificationClearTimeout","filenames","assist","message","textContent","clear$1","listModified","isUsingFilePond","itemAdded","itemRemoved","itemProcessed","itemProcessedUndo","itemError","assistant","toCamels","charAt","debounce","func","immidiateOnly","MAX_FILES_LIMIT","prevent","create$e","measure","bounds","widthPrevious","widthUpdated","updateHistory","previousAspectRatio","canHover","matchMedia","hasPointerEvents","passive","hasCredits","frag","tabindex","rel","write$9","route$5","calculateRootBoundingBoxHeight","_root$ref","hopper","isMultiItem","maxItems","atMaxCapacity","addAction","listItemMargin","calculateListItemMargin","listHeight","calculateListHeight","labelHeight","currentLabelHeight","listMarginTop","listMarginBottom","visual","boundsHeight","history","MAX_BOUNCES","bounces","listAvailableHeight","fixedHeight","_listAvailableHeight","cappedHeight","isCappedHeight","panelHeight","_listAvailableHeight2","itemMargin","transform","scrollList","itemList","newItem","removedItem","verticalItemCount","ceil","measureHeight","maxHeight","exceedsMaxFiles","totalBrowseItems","hasMaxItems","getDragIndex","toggleDrop","isAllowed","enabled","toggleBrowse","togglePaste","paster","DID_SET_ALLOW_DROP","DID_SET_ALLOW_PASTE","createApp","initialOptions","originalElement","visibilityHandler","resizeDoneTimer","isResizing","isResizingHorizontally","initialWindowWidth","currentWindowWidth","resizeHandler","isHidden","readWriteApi","innerWidth","routeActionsToEvents","createEvent","eventRoutes","DID_DESTROY","DID_INIT","DID_THROW_MAX_FILES","DID_INIT_ITEM","DID_PREPARE_OUTPUT","DID_COMPLETE_ITEM_PROCESSING_ALL","DID_UPDATE_ITEMS","DID_ACTIVATE_ITEM","exposeEvent","detail","pond","dispatchEvent","CustomEvent","bubbles","cancelable","composed","filtered","prepareFile","addFile","addFiles","isFilePondFile","removeFile","sources","lastArgument","processFile","prepareFiles","processFiles","_len3","_key3","removeFiles","_len4","_key4","mappedQueries","q","moveFile","browse","insertBefore$1","insertAfter$1","appendTo","replaceElement","restoreElement","isAttachedTo","createAppObject","customOptions","app","lowerCaseFirstLetter","attributeNameToPropertyName","attributeName","mapObject","propertyMap","selector","mapping","selectorRegExp","getAttributesAsObject","attributeMapping","attribute","createAppAtElement","mergedOptions","attributeOptions","querySelectorAll","createApp$1","PRIVATE_METHODS","createAppAPI","replaceInString","replacements","createWorker","workerBlob","workerURL","URL","createObjectURL","worker","Worker","post","transferList","onmessage","postMessage","terminate","revokeObjectURL","loadImage","img","Image","renameFile","renamedFile","copyFile","registeredPlugins","createAppPlugin","plugin","pluginOutline","views","isOperaMini","operamini","hasPromises","hasBlobSlice","hasCreateObjectURL","hasVisibility","hasTiming","hasCSSSupports","CSS","isIE11","navigator","userAgent","supported","isSupported","apps","FileStatus","OptionTypes","registerPlugin","updateOptionTypes","hook","indexToRemove","matchedHooks","newHooks","newHook","plugins","getOptions$1","setOptions$1"],"sources":["/Users/jinsonwu/Desktop/MIRC-Code-Verification/backend/frontend/node_modules/filepond/dist/filepond.js"],"sourcesContent":["/*!\n * FilePond 4.25.1\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined'\n    ? factory(exports)\n    : typeof define === 'function' && define.amd\n    ? define(['exports'], factory)\n    : ((global = global || self), factory((global.FilePond = {})));\n})(this, function(exports) {\n  'use strict';\n\n  var isNode = function isNode(value) {\n    return value instanceof HTMLElement;\n  };\n\n  var createStore = function createStore(initialState) {\n    var queries =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var actions =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    // internal state\n    var state = Object.assign({}, initialState);\n\n    // contains all actions for next frame, is clear when actions are requested\n    var actionQueue = [];\n    var dispatchQueue = [];\n\n    // returns a duplicate of the current state\n    var getState = function getState() {\n      return Object.assign({}, state);\n    };\n\n    // returns a duplicate of the actions array and clears the actions array\n    var processActionQueue = function processActionQueue() {\n      // create copy of actions queue\n      var queue = [].concat(actionQueue);\n\n      // clear actions queue (we don't want no double actions)\n      actionQueue.length = 0;\n\n      return queue;\n    };\n\n    // processes actions that might block the main UI thread\n    var processDispatchQueue = function processDispatchQueue() {\n      // create copy of actions queue\n      var queue = [].concat(dispatchQueue);\n\n      // clear actions queue (we don't want no double actions)\n      dispatchQueue.length = 0;\n\n      // now dispatch these actions\n      queue.forEach(function(_ref) {\n        var type = _ref.type,\n          data = _ref.data;\n        dispatch(type, data);\n      });\n    };\n\n    // adds a new action, calls its handler and\n    var dispatch = function dispatch(type, data, isBlocking) {\n      // is blocking action (should never block if document is hidden)\n      if (isBlocking && !document.hidden) {\n        dispatchQueue.push({ type: type, data: data });\n        return;\n      }\n\n      // if this action has a handler, handle the action\n      if (actionHandlers[type]) {\n        actionHandlers[type](data);\n      }\n\n      // now add action\n      actionQueue.push({\n        type: type,\n        data: data\n      });\n    };\n\n    var query = function query(str) {\n      var _queryHandles;\n      for (\n        var _len = arguments.length,\n          args = new Array(_len > 1 ? _len - 1 : 0),\n          _key = 1;\n        _key < _len;\n        _key++\n      ) {\n        args[_key - 1] = arguments[_key];\n      }\n      return queryHandles[str]\n        ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args)\n        : null;\n    };\n\n    var api = {\n      getState: getState,\n      processActionQueue: processActionQueue,\n      processDispatchQueue: processDispatchQueue,\n      dispatch: dispatch,\n      query: query\n    };\n\n    var queryHandles = {};\n    queries.forEach(function(query) {\n      queryHandles = Object.assign({}, query(state), {}, queryHandles);\n    });\n\n    var actionHandlers = {};\n    actions.forEach(function(action) {\n      actionHandlers = Object.assign(\n        {},\n        action(dispatch, query, state),\n        {},\n        actionHandlers\n      );\n    });\n\n    return api;\n  };\n\n  var defineProperty = function defineProperty(obj, property, definition) {\n    if (typeof definition === 'function') {\n      obj[property] = definition;\n      return;\n    }\n    Object.defineProperty(obj, property, Object.assign({}, definition));\n  };\n\n  var forin = function forin(obj, cb) {\n    for (var key in obj) {\n      if (!obj.hasOwnProperty(key)) {\n        continue;\n      }\n\n      cb(key, obj[key]);\n    }\n  };\n\n  var createObject = function createObject(definition) {\n    var obj = {};\n    forin(definition, function(property) {\n      defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n  };\n\n  var attr = function attr(node, name) {\n    var value =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    if (value === null) {\n      return node.getAttribute(name) || node.hasAttribute(name);\n    }\n    node.setAttribute(name, value);\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svgElements = ['svg', 'path']; // only svg elements used\n\n  var isSVGElement = function isSVGElement(tag) {\n    return svgElements.includes(tag);\n  };\n\n  var createElement = function createElement(tag, className) {\n    var attributes =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    if (typeof className === 'object') {\n      attributes = className;\n      className = null;\n    }\n    var element = isSVGElement(tag)\n      ? document.createElementNS(ns, tag)\n      : document.createElement(tag);\n    if (className) {\n      if (isSVGElement(tag)) {\n        attr(element, 'class', className);\n      } else {\n        element.className = className;\n      }\n    }\n    forin(attributes, function(name, value) {\n      attr(element, name, value);\n    });\n    return element;\n  };\n\n  var appendChild = function appendChild(parent) {\n    return function(child, index) {\n      if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n      } else {\n        parent.appendChild(child);\n      }\n    };\n  };\n\n  var appendChildView = function appendChildView(parent, childViews) {\n    return function(view, index) {\n      if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n      } else {\n        childViews.push(view);\n      }\n\n      return view;\n    };\n  };\n\n  var removeChildView = function removeChildView(parent, childViews) {\n    return function(view) {\n      // remove from child views\n      childViews.splice(childViews.indexOf(view), 1);\n\n      // remove the element\n      if (view.element.parentNode) {\n        parent.removeChild(view.element);\n      }\n\n      return view;\n    };\n  };\n\n  var IS_BROWSER = (function() {\n    return (\n      typeof window !== 'undefined' && typeof window.document !== 'undefined'\n    );\n  })();\n  var isBrowser = function isBrowser() {\n    return IS_BROWSER;\n  };\n\n  var testElement = isBrowser() ? createElement('svg') : {};\n  var getChildCount =\n    'children' in testElement\n      ? function(el) {\n          return el.children.length;\n        }\n      : function(el) {\n          return el.childNodes.length;\n        };\n\n  var getViewRect = function getViewRect(\n    elementRect,\n    childViews,\n    offset,\n    scale\n  ) {\n    var left = offset[0] || elementRect.left;\n    var top = offset[1] || elementRect.top;\n    var right = left + elementRect.width;\n    var bottom = top + elementRect.height * (scale[1] || 1);\n\n    var rect = {\n      // the rectangle of the element itself\n      element: Object.assign({}, elementRect),\n\n      // the rectangle of the element expanded to contain its children, does not include any margins\n      inner: {\n        left: elementRect.left,\n        top: elementRect.top,\n        right: elementRect.right,\n        bottom: elementRect.bottom\n      },\n\n      // the rectangle of the element expanded to contain its children including own margin and child margins\n      // margins will be added after we've recalculated the size\n      outer: {\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      }\n    };\n\n    // expand rect to fit all child rectangles\n    childViews\n      .filter(function(childView) {\n        return !childView.isRectIgnored();\n      })\n      .map(function(childView) {\n        return childView.rect;\n      })\n      .forEach(function(childViewRect) {\n        expandRect(rect.inner, Object.assign({}, childViewRect.inner));\n        expandRect(rect.outer, Object.assign({}, childViewRect.outer));\n      });\n\n    // calculate inner width and height\n    calculateRectSize(rect.inner);\n\n    // append additional margin (top and left margins are included in top and left automatically)\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight;\n\n    // calculate outer width and height\n    calculateRectSize(rect.outer);\n\n    return rect;\n  };\n\n  var expandRect = function expandRect(parent, child) {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n\n    if (child.bottom > parent.bottom) {\n      parent.bottom = child.bottom;\n    }\n\n    if (child.right > parent.right) {\n      parent.right = child.right;\n    }\n  };\n\n  var calculateRectSize = function calculateRectSize(rect) {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n  };\n\n  var isNumber = function isNumber(value) {\n    return typeof value === 'number';\n  };\n\n  /**\n   * Determines if position is at destination\n   * @param position\n   * @param destination\n   * @param velocity\n   * @param errorMargin\n   * @returns {boolean}\n   */\n  var thereYet = function thereYet(position, destination, velocity) {\n    var errorMargin =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;\n    return (\n      Math.abs(position - destination) < errorMargin &&\n      Math.abs(velocity) < errorMargin\n    );\n  };\n\n  /**\n   * Spring animation\n   */\n  var spring =\n    // default options\n    function spring() // method definition\n    {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$stiffness = _ref.stiffness,\n        stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,\n        _ref$damping = _ref.damping,\n        damping = _ref$damping === void 0 ? 0.75 : _ref$damping,\n        _ref$mass = _ref.mass,\n        mass = _ref$mass === void 0 ? 10 : _ref$mass;\n      var target = null;\n      var position = null;\n      var velocity = 0;\n      var resting = false;\n\n      // updates spring state\n      var interpolate = function interpolate(ts, skipToEndState) {\n        // in rest, don't animate\n        if (resting) return;\n\n        // need at least a target or position to do springy things\n        if (!(isNumber(target) && isNumber(position))) {\n          resting = true;\n          velocity = 0;\n          return;\n        }\n\n        // calculate spring force\n        var f = -(position - target) * stiffness;\n\n        // update velocity by adding force based on mass\n        velocity += f / mass;\n\n        // update position by adding velocity\n        position += velocity;\n\n        // slow down based on amount of damping\n        velocity *= damping;\n\n        // we've arrived if we're near target and our velocity is near zero\n        if (thereYet(position, target, velocity) || skipToEndState) {\n          position = target;\n          velocity = 0;\n          resting = true;\n\n          // we done\n          api.onupdate(position);\n          api.oncomplete(position);\n        } else {\n          // progress update\n          api.onupdate(position);\n        }\n      };\n\n      /**\n       * Set new target value\n       * @param value\n       */\n      var setTarget = function setTarget(value) {\n        // if currently has no position, set target and position to this value\n        if (isNumber(value) && !isNumber(position)) {\n          position = value;\n        }\n\n        // next target value will not be animated to\n        if (target === null) {\n          target = value;\n          position = value;\n        }\n\n        // let start moving to target\n        target = value;\n\n        // already at target\n        if (position === target || typeof target === 'undefined') {\n          // now resting as target is current position, stop moving\n          resting = true;\n          velocity = 0;\n\n          // done!\n          api.onupdate(position);\n          api.oncomplete(position);\n\n          return;\n        }\n\n        resting = false;\n      };\n\n      // need 'api' to call onupdate callback\n      var api = createObject({\n        interpolate: interpolate,\n        target: {\n          set: setTarget,\n          get: function get() {\n            return target;\n          }\n        },\n\n        resting: {\n          get: function get() {\n            return resting;\n          }\n        },\n\n        onupdate: function onupdate(value) {},\n        oncomplete: function oncomplete(value) {}\n      });\n\n      return api;\n    };\n\n  var easeLinear = function easeLinear(t) {\n    return t;\n  };\n  var easeInOutQuad = function easeInOutQuad(t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n  };\n\n  var tween =\n    // default values\n    function tween() // method definition\n    {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$duration = _ref.duration,\n        duration = _ref$duration === void 0 ? 500 : _ref$duration,\n        _ref$easing = _ref.easing,\n        easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,\n        _ref$delay = _ref.delay,\n        delay = _ref$delay === void 0 ? 0 : _ref$delay;\n      var start = null;\n      var t;\n      var p;\n      var resting = true;\n      var reverse = false;\n      var target = null;\n\n      var interpolate = function interpolate(ts, skipToEndState) {\n        if (resting || target === null) return;\n\n        if (start === null) {\n          start = ts;\n        }\n\n        if (ts - start < delay) return;\n\n        t = ts - start - delay;\n\n        if (t >= duration || skipToEndState) {\n          t = 1;\n          p = reverse ? 0 : 1;\n          api.onupdate(p * target);\n          api.oncomplete(p * target);\n          resting = true;\n        } else {\n          p = t / duration;\n          api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n        }\n      };\n\n      // need 'api' to call onupdate callback\n      var api = createObject({\n        interpolate: interpolate,\n        target: {\n          get: function get() {\n            return reverse ? 0 : target;\n          },\n          set: function set(value) {\n            // is initial value\n            if (target === null) {\n              target = value;\n              api.onupdate(value);\n              api.oncomplete(value);\n              return;\n            }\n\n            // want to tween to a smaller value and have a current value\n            if (value < target) {\n              target = 1;\n              reverse = true;\n            } else {\n              // not tweening to a smaller value\n              reverse = false;\n              target = value;\n            }\n\n            // let's go!\n            resting = false;\n            start = null;\n          }\n        },\n\n        resting: {\n          get: function get() {\n            return resting;\n          }\n        },\n\n        onupdate: function onupdate(value) {},\n        oncomplete: function oncomplete(value) {}\n      });\n\n      return api;\n    };\n\n  var animator = {\n    spring: spring,\n    tween: tween\n  };\n\n  /*\n                       { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n                       { translation: { type: 'spring', ... }, ... }\n                       { translation: { x: { type: 'spring', ... } } }\n                      */\n  var createAnimator = function createAnimator(definition, category, property) {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    var def =\n      definition[category] && typeof definition[category][property] === 'object'\n        ? definition[category][property]\n        : definition[category] || definition;\n\n    var type = typeof def === 'string' ? def : def.type;\n    var props = typeof def === 'object' ? Object.assign({}, def) : {};\n\n    return animator[type] ? animator[type](props) : null;\n  };\n\n  var addGetSet = function addGetSet(keys, obj, props) {\n    var overwrite =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(function(o) {\n      keys.forEach(function(key) {\n        var name = key;\n        var getter = function getter() {\n          return props[key];\n        };\n        var setter = function setter(value) {\n          return (props[key] = value);\n        };\n\n        if (typeof key === 'object') {\n          name = key.key;\n          getter = key.getter || getter;\n          setter = key.setter || setter;\n        }\n\n        if (o[name] && !overwrite) {\n          return;\n        }\n\n        o[name] = {\n          get: getter,\n          set: setter\n        };\n      });\n    });\n  };\n\n  // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // setup animators\n\n  var animations = function animations(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI;\n    // initial properties\n    var initialProps = Object.assign({}, viewProps);\n\n    // list of all active animations\n    var animations = [];\n\n    // setup animators\n    forin(mixinConfig, function(property, animation) {\n      var animator = createAnimator(animation);\n      if (!animator) {\n        return;\n      }\n\n      // when the animator updates, update the view state value\n      animator.onupdate = function(value) {\n        viewProps[property] = value;\n      };\n\n      // set animator target\n      animator.target = initialProps[property];\n\n      // when value is set, set the animator target value\n      var prop = {\n        key: property,\n        setter: function setter(value) {\n          // if already at target, we done!\n          if (animator.target === value) {\n            return;\n          }\n\n          animator.target = value;\n        },\n        getter: function getter() {\n          return viewProps[property];\n        }\n      };\n\n      // add getters and setters\n      addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);\n\n      // add it to the list for easy updating from the _write method\n      animations.push(animator);\n    });\n\n    // expose internal write api\n    return {\n      write: function write(ts) {\n        var skipToEndState = document.hidden;\n        var resting = true;\n        animations.forEach(function(animation) {\n          if (!animation.resting) resting = false;\n          animation.interpolate(ts, skipToEndState);\n        });\n        return resting;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var addEvent = function addEvent(element) {\n    return function(type, fn) {\n      element.addEventListener(type, fn);\n    };\n  };\n\n  var removeEvent = function removeEvent(element) {\n    return function(type, fn) {\n      element.removeEventListener(type, fn);\n    };\n  };\n\n  // mixin\n  var listeners = function listeners(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      viewState = _ref.viewState,\n      view = _ref.view;\n    var events = [];\n\n    var add = addEvent(view.element);\n    var remove = removeEvent(view.element);\n\n    viewExternalAPI.on = function(type, fn) {\n      events.push({\n        type: type,\n        fn: fn\n      });\n\n      add(type, fn);\n    };\n\n    viewExternalAPI.off = function(type, fn) {\n      events.splice(\n        events.findIndex(function(event) {\n          return event.type === type && event.fn === fn;\n        }),\n        1\n      );\n\n      remove(type, fn);\n    };\n\n    return {\n      write: function write() {\n        // not busy\n        return true;\n      },\n      destroy: function destroy() {\n        events.forEach(function(event) {\n          remove(event.type, event.fn);\n        });\n      }\n    };\n  };\n\n  // add to external api and link to props\n\n  var apis = function apis(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewExternalAPI = _ref.viewExternalAPI;\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n\n  // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // set initial state based on props in viewProps\n  // apply as transforms each frame\n\n  var defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0\n  };\n\n  var styles = function styles(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      view = _ref.view;\n    // initial props\n    var initialProps = Object.assign({}, viewProps);\n\n    // current props\n    var currentProps = {};\n\n    // we will add those properties to the external API and link them to the viewState\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);\n\n    // override rect on internal and external rect getter so it takes in account transforms\n    var getOffset = function getOffset() {\n      return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    };\n\n    var getScale = function getScale() {\n      return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    };\n    var getRect = function getRect() {\n      return view.rect\n        ? getViewRect(view.rect, view.childViews, getOffset(), getScale())\n        : null;\n    };\n    viewInternalAPI.rect = { get: getRect };\n    viewExternalAPI.rect = { get: getRect };\n\n    // apply view props\n    mixinConfig.forEach(function(key) {\n      viewProps[key] =\n        typeof initialProps[key] === 'undefined'\n          ? defaults[key]\n          : initialProps[key];\n    });\n\n    // expose api\n    return {\n      write: function write() {\n        // see if props have changed\n        if (!propsHaveChanged(currentProps, viewProps)) {\n          return;\n        }\n\n        // moves element to correct position on screen\n        applyStyles(view.element, viewProps);\n\n        // store new transforms\n        Object.assign(currentProps, Object.assign({}, viewProps));\n\n        // no longer busy\n        return true;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n      return true;\n    }\n\n    // lets analyze the individual props\n    for (var prop in newProps) {\n      if (newProps[prop] !== currentProps[prop]) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var applyStyles = function applyStyles(element, _ref2) {\n    var opacity = _ref2.opacity,\n      perspective = _ref2.perspective,\n      translateX = _ref2.translateX,\n      translateY = _ref2.translateY,\n      scaleX = _ref2.scaleX,\n      scaleY = _ref2.scaleY,\n      rotateX = _ref2.rotateX,\n      rotateY = _ref2.rotateY,\n      rotateZ = _ref2.rotateZ,\n      originX = _ref2.originX,\n      originY = _ref2.originY,\n      width = _ref2.width,\n      height = _ref2.height;\n\n    var transforms = '';\n    var styles = '';\n\n    // handle transform origin\n    if (isDefined(originX) || isDefined(originY)) {\n      styles +=\n        'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';\n    }\n\n    // transform order is relevant\n    // 0. perspective\n    if (isDefined(perspective)) {\n      transforms += 'perspective(' + perspective + 'px) ';\n    }\n\n    // 1. translate\n    if (isDefined(translateX) || isDefined(translateY)) {\n      transforms +=\n        'translate3d(' +\n        (translateX || 0) +\n        'px, ' +\n        (translateY || 0) +\n        'px, 0) ';\n    }\n\n    // 2. scale\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n      transforms +=\n        'scale3d(' +\n        (isDefined(scaleX) ? scaleX : 1) +\n        ', ' +\n        (isDefined(scaleY) ? scaleY : 1) +\n        ', 1) ';\n    }\n\n    // 3. rotate\n    if (isDefined(rotateZ)) {\n      transforms += 'rotateZ(' + rotateZ + 'rad) ';\n    }\n\n    if (isDefined(rotateX)) {\n      transforms += 'rotateX(' + rotateX + 'rad) ';\n    }\n\n    if (isDefined(rotateY)) {\n      transforms += 'rotateY(' + rotateY + 'rad) ';\n    }\n\n    // add transforms\n    if (transforms.length) {\n      styles += 'transform:' + transforms + ';';\n    }\n\n    // add opacity\n    if (isDefined(opacity)) {\n      styles += 'opacity:' + opacity + ';';\n\n      // if we reach zero, we make the element inaccessible\n      if (opacity === 0) {\n        styles += 'visibility:hidden;';\n      }\n\n      // if we're below 100% opacity this element can't be clicked\n      if (opacity < 1) {\n        styles += 'pointer-events:none;';\n      }\n    }\n\n    // add height\n    if (isDefined(height)) {\n      styles += 'height:' + height + 'px;';\n    }\n\n    // add width\n    if (isDefined(width)) {\n      styles += 'width:' + width + 'px;';\n    }\n\n    // apply styles\n    var elementCurrentStyle = element.elementCurrentStyle || '';\n\n    // if new styles does not match current styles, lets update!\n    if (\n      styles.length !== elementCurrentStyle.length ||\n      styles !== elementCurrentStyle\n    ) {\n      element.style.cssText = styles;\n      // store current styles so we can compare them to new styles later on\n      // _not_ getting the style value is faster\n      element.elementCurrentStyle = styles;\n    }\n  };\n\n  var Mixins = {\n    styles: styles,\n    listeners: listeners,\n    animations: animations,\n    apis: apis\n  };\n\n  var updateRect = function updateRect() {\n    var rect =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var element =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var style =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!element.layoutCalculated) {\n      rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n      rect.marginTop = parseInt(style.marginTop, 10) || 0;\n      rect.marginRight = parseInt(style.marginRight, 10) || 0;\n      rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n      rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n      element.layoutCalculated = true;\n    }\n\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n\n    rect.scrollTop = element.scrollTop;\n\n    rect.hidden = element.offsetParent === null;\n\n    return rect;\n  };\n\n  var createView =\n    // default view definition\n    function createView() {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$tag = _ref.tag,\n        tag = _ref$tag === void 0 ? 'div' : _ref$tag,\n        _ref$name = _ref.name,\n        name = _ref$name === void 0 ? null : _ref$name,\n        _ref$attributes = _ref.attributes,\n        attributes = _ref$attributes === void 0 ? {} : _ref$attributes,\n        _ref$read = _ref.read,\n        read = _ref$read === void 0 ? function() {} : _ref$read,\n        _ref$write = _ref.write,\n        write = _ref$write === void 0 ? function() {} : _ref$write,\n        _ref$create = _ref.create,\n        create = _ref$create === void 0 ? function() {} : _ref$create,\n        _ref$destroy = _ref.destroy,\n        destroy = _ref$destroy === void 0 ? function() {} : _ref$destroy,\n        _ref$filterFrameActio = _ref.filterFrameActionsForChild,\n        filterFrameActionsForChild =\n          _ref$filterFrameActio === void 0\n            ? function(child, actions) {\n                return actions;\n              }\n            : _ref$filterFrameActio,\n        _ref$didCreateView = _ref.didCreateView,\n        didCreateView =\n          _ref$didCreateView === void 0 ? function() {} : _ref$didCreateView,\n        _ref$didWriteView = _ref.didWriteView,\n        didWriteView =\n          _ref$didWriteView === void 0 ? function() {} : _ref$didWriteView,\n        _ref$ignoreRect = _ref.ignoreRect,\n        ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,\n        _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,\n        ignoreRectUpdate =\n          _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,\n        _ref$mixins = _ref.mixins,\n        mixins = _ref$mixins === void 0 ? [] : _ref$mixins;\n      return function(\n        // each view requires reference to store\n        store\n      ) {\n        var props =\n          arguments.length > 1 && arguments[1] !== undefined\n            ? arguments[1]\n            : {};\n        // root element should not be changed\n        var element = createElement(tag, 'filepond--' + name, attributes);\n\n        // style reference should also not be changed\n        var style = window.getComputedStyle(element, null);\n\n        // element rectangle\n        var rect = updateRect();\n        var frameRect = null;\n\n        // rest state\n        var isResting = false;\n\n        // pretty self explanatory\n        var childViews = [];\n\n        // loaded mixins\n        var activeMixins = [];\n\n        // references to created children\n        var ref = {};\n\n        // state used for each instance\n        var state = {};\n\n        // list of writers that will be called to update this view\n        var writers = [\n          write // default writer\n        ];\n\n        var readers = [\n          read // default reader\n        ];\n\n        var destroyers = [\n          destroy // default destroy\n        ];\n\n        // core view methods\n        var getElement = function getElement() {\n          return element;\n        };\n        var getChildViews = function getChildViews() {\n          return childViews.concat();\n        };\n        var getReference = function getReference() {\n          return ref;\n        };\n        var createChildView = function createChildView(store) {\n          return function(view, props) {\n            return view(store, props);\n          };\n        };\n        var getRect = function getRect() {\n          if (frameRect) {\n            return frameRect;\n          }\n          frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n          return frameRect;\n        };\n        var getStyle = function getStyle() {\n          return style;\n        };\n\n        /**\n         * Read data from DOM\n         * @private\n         */\n        var _read = function _read() {\n          frameRect = null;\n\n          // read child views\n          childViews.forEach(function(child) {\n            return child._read();\n          });\n\n          var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n          if (shouldUpdate) {\n            updateRect(rect, element, style);\n          }\n\n          // readers\n          var api = { root: internalAPI, props: props, rect: rect };\n          readers.forEach(function(reader) {\n            return reader(api);\n          });\n        };\n\n        /**\n         * Write data to DOM\n         * @private\n         */\n        var _write = function _write(ts, frameActions, shouldOptimize) {\n          // if no actions, we assume that the view is resting\n          var resting = frameActions.length === 0;\n\n          // writers\n          writers.forEach(function(writer) {\n            var writerResting = writer({\n              props: props,\n              root: internalAPI,\n              actions: frameActions,\n              timestamp: ts,\n              shouldOptimize: shouldOptimize\n            });\n\n            if (writerResting === false) {\n              resting = false;\n            }\n          });\n\n          // run mixins\n          activeMixins.forEach(function(mixin) {\n            // if one of the mixins is still busy after write operation, we are not resting\n            var mixinResting = mixin.write(ts);\n            if (mixinResting === false) {\n              resting = false;\n            }\n          });\n\n          // updates child views that are currently attached to the DOM\n          childViews\n            .filter(function(child) {\n              return !!child.element.parentNode;\n            })\n            .forEach(function(child) {\n              // if a child view is not resting, we are not resting\n              var childResting = child._write(\n                ts,\n                filterFrameActionsForChild(child, frameActions),\n                shouldOptimize\n              );\n\n              if (!childResting) {\n                resting = false;\n              }\n            });\n\n          // append new elements to DOM and update those\n          childViews\n            //.filter(child => !child.element.parentNode)\n            .forEach(function(child, index) {\n              // skip\n              if (child.element.parentNode) {\n                return;\n              }\n\n              // append to DOM\n              internalAPI.appendChild(child.element, index);\n\n              // call read (need to know the size of these elements)\n              child._read();\n\n              // re-call write\n              child._write(\n                ts,\n                filterFrameActionsForChild(child, frameActions),\n                shouldOptimize\n              );\n\n              // we just added somthing to the dom, no rest\n              resting = false;\n            });\n\n          // update resting state\n          isResting = resting;\n\n          didWriteView({\n            props: props,\n            root: internalAPI,\n            actions: frameActions,\n            timestamp: ts\n          });\n\n          // let parent know if we are resting\n          return resting;\n        };\n\n        var _destroy = function _destroy() {\n          activeMixins.forEach(function(mixin) {\n            return mixin.destroy();\n          });\n          destroyers.forEach(function(destroyer) {\n            destroyer({ root: internalAPI, props: props });\n          });\n          childViews.forEach(function(child) {\n            return child._destroy();\n          });\n        };\n\n        // sharedAPI\n        var sharedAPIDefinition = {\n          element: {\n            get: getElement\n          },\n\n          style: {\n            get: getStyle\n          },\n\n          childViews: {\n            get: getChildViews\n          }\n        };\n\n        // private API definition\n        var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n          rect: {\n            get: getRect\n          },\n\n          // access to custom children references\n          ref: {\n            get: getReference\n          },\n\n          // dom modifiers\n          is: function is(needle) {\n            return name === needle;\n          },\n          appendChild: appendChild(element),\n          createChildView: createChildView(store),\n          linkView: function linkView(view) {\n            childViews.push(view);\n            return view;\n          },\n          unlinkView: function unlinkView(view) {\n            childViews.splice(childViews.indexOf(view), 1);\n          },\n          appendChildView: appendChildView(element, childViews),\n          removeChildView: removeChildView(element, childViews),\n          registerWriter: function registerWriter(writer) {\n            return writers.push(writer);\n          },\n          registerReader: function registerReader(reader) {\n            return readers.push(reader);\n          },\n          registerDestroyer: function registerDestroyer(destroyer) {\n            return destroyers.push(destroyer);\n          },\n          invalidateLayout: function invalidateLayout() {\n            return (element.layoutCalculated = false);\n          },\n\n          // access to data store\n          dispatch: store.dispatch,\n          query: store.query\n        });\n\n        // public view API methods\n        var externalAPIDefinition = {\n          element: {\n            get: getElement\n          },\n\n          childViews: {\n            get: getChildViews\n          },\n\n          rect: {\n            get: getRect\n          },\n\n          resting: {\n            get: function get() {\n              return isResting;\n            }\n          },\n\n          isRectIgnored: function isRectIgnored() {\n            return ignoreRect;\n          },\n          _read: _read,\n          _write: _write,\n          _destroy: _destroy\n        };\n\n        // mixin API methods\n        var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n          rect: {\n            get: function get() {\n              return rect;\n            }\n          }\n        });\n\n        // add mixin functionality\n        Object.keys(mixins)\n          .sort(function(a, b) {\n            // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n            if (a === 'styles') {\n              return 1;\n            } else if (b === 'styles') {\n              return -1;\n            }\n            return 0;\n          })\n          .forEach(function(key) {\n            var mixinAPI = Mixins[key]({\n              mixinConfig: mixins[key],\n              viewProps: props,\n              viewState: state,\n              viewInternalAPI: internalAPIDefinition,\n              viewExternalAPI: externalAPIDefinition,\n              view: createObject(mixinAPIDefinition)\n            });\n\n            if (mixinAPI) {\n              activeMixins.push(mixinAPI);\n            }\n          });\n\n        // construct private api\n        var internalAPI = createObject(internalAPIDefinition);\n\n        // create the view\n        create({\n          root: internalAPI,\n          props: props\n        });\n\n        // append created child views to root node\n        var childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\n        childViews.forEach(function(child, index) {\n          internalAPI.appendChild(child.element, childCount + index);\n        });\n\n        // call did create\n        didCreateView(internalAPI);\n\n        // expose public api\n        return createObject(externalAPIDefinition);\n      };\n    };\n\n  var createPainter = function createPainter(read, write) {\n    var fps =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;\n\n    var name = '__framePainter';\n\n    // set global painter\n    if (window[name]) {\n      window[name].readers.push(read);\n      window[name].writers.push(write);\n      return;\n    }\n\n    window[name] = {\n      readers: [read],\n      writers: [write]\n    };\n\n    var painter = window[name];\n\n    var interval = 1000 / fps;\n    var last = null;\n    var id = null;\n    var requestTick = null;\n    var cancelTick = null;\n\n    var setTimerType = function setTimerType() {\n      if (document.hidden) {\n        requestTick = function requestTick() {\n          return window.setTimeout(function() {\n            return tick(performance.now());\n          }, interval);\n        };\n        cancelTick = function cancelTick() {\n          return window.clearTimeout(id);\n        };\n      } else {\n        requestTick = function requestTick() {\n          return window.requestAnimationFrame(tick);\n        };\n        cancelTick = function cancelTick() {\n          return window.cancelAnimationFrame(id);\n        };\n      }\n    };\n\n    document.addEventListener('visibilitychange', function() {\n      if (cancelTick) cancelTick();\n      setTimerType();\n      tick(performance.now());\n    });\n\n    var tick = function tick(ts) {\n      // queue next tick\n      id = requestTick(tick);\n\n      // limit fps\n      if (!last) {\n        last = ts;\n      }\n\n      var delta = ts - last;\n\n      if (delta <= interval) {\n        // skip frame\n        return;\n      }\n\n      // align next frame\n      last = ts - (delta % interval);\n\n      // update view\n      painter.readers.forEach(function(read) {\n        return read();\n      });\n      painter.writers.forEach(function(write) {\n        return write(ts);\n      });\n    };\n\n    setTimerType();\n    tick(performance.now());\n\n    return {\n      pause: function pause() {\n        cancelTick(id);\n      }\n    };\n  };\n\n  var createRoute = function createRoute(routes, fn) {\n    return function(_ref) {\n      var root = _ref.root,\n        props = _ref.props,\n        _ref$actions = _ref.actions,\n        actions = _ref$actions === void 0 ? [] : _ref$actions,\n        timestamp = _ref.timestamp,\n        shouldOptimize = _ref.shouldOptimize;\n      actions\n        .filter(function(action) {\n          return routes[action.type];\n        })\n        .forEach(function(action) {\n          return routes[action.type]({\n            root: root,\n            props: props,\n            action: action.data,\n            timestamp: timestamp,\n            shouldOptimize: shouldOptimize\n          });\n        });\n\n      if (fn) {\n        fn({\n          root: root,\n          props: props,\n          actions: actions,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      }\n    };\n  };\n\n  var insertBefore = function insertBefore(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode);\n  };\n\n  var insertAfter = function insertAfter(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(\n      newNode,\n      referenceNode.nextSibling\n    );\n  };\n\n  var isArray = function isArray(value) {\n    return Array.isArray(value);\n  };\n\n  var isEmpty = function isEmpty(value) {\n    return value == null;\n  };\n\n  var trim = function trim(str) {\n    return str.trim();\n  };\n\n  var toString = function toString(value) {\n    return '' + value;\n  };\n\n  var toArray = function toArray(value) {\n    var splitter =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n    if (isEmpty(value)) {\n      return [];\n    }\n    if (isArray(value)) {\n      return value;\n    }\n    return toString(value)\n      .split(splitter)\n      .map(trim)\n      .filter(function(str) {\n        return str.length;\n      });\n  };\n\n  var isBoolean = function isBoolean(value) {\n    return typeof value === 'boolean';\n  };\n\n  var toBoolean = function toBoolean(value) {\n    return isBoolean(value) ? value : value === 'true';\n  };\n\n  var isString = function isString(value) {\n    return typeof value === 'string';\n  };\n\n  var toNumber = function toNumber(value) {\n    return isNumber(value)\n      ? value\n      : isString(value)\n      ? toString(value).replace(/[a-z]+/gi, '')\n      : 0;\n  };\n\n  var toInt = function toInt(value) {\n    return parseInt(toNumber(value), 10);\n  };\n\n  var toFloat = function toFloat(value) {\n    return parseFloat(toNumber(value));\n  };\n\n  var isInt = function isInt(value) {\n    return isNumber(value) && isFinite(value) && Math.floor(value) === value;\n  };\n\n  var toBytes = function toBytes(value) {\n    var base =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    // is in bytes\n    if (isInt(value)) {\n      return value;\n    }\n\n    // is natural file size\n    var naturalFileSize = toString(value).trim();\n\n    // if is value in megabytes\n    if (/MB$/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n      return toInt(naturalFileSize) * base * base;\n    }\n\n    // if is value in kilobytes\n    if (/KB/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n      return toInt(naturalFileSize) * base;\n    }\n\n    return toInt(naturalFileSize);\n  };\n\n  var isFunction = function isFunction(value) {\n    return typeof value === 'function';\n  };\n\n  var toFunctionReference = function toFunctionReference(string) {\n    var ref = self;\n    var levels = string.split('.');\n    var level = null;\n    while ((level = levels.shift())) {\n      ref = ref[level];\n      if (!ref) {\n        return null;\n      }\n    }\n    return ref;\n  };\n\n  var methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET'\n  };\n\n  var createServerAPI = function createServerAPI(outline) {\n    var api = {};\n\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n\n    forin(methods, function(key) {\n      api[key] = createAction(\n        key,\n        outline[key],\n        methods[key],\n        api.timeout,\n        api.headers\n      );\n    });\n\n    // special treatment for remove\n    api.remove = outline.remove || null;\n\n    // remove generic headers from api object\n    delete api.headers;\n\n    return api;\n  };\n\n  var createAction = function createAction(\n    name,\n    outline,\n    method,\n    timeout,\n    headers\n  ) {\n    // is explicitely set to null so disable\n    if (outline === null) {\n      return null;\n    }\n\n    // if is custom function, done! Dev handles everything.\n    if (typeof outline === 'function') {\n      return outline;\n    }\n\n    // build action object\n    var action = {\n      url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',\n      method: method,\n      headers: headers,\n      withCredentials: false,\n      timeout: timeout,\n      onload: null,\n      ondata: null,\n      onerror: null\n    };\n\n    // is a single url\n    if (isString(outline)) {\n      action.url = outline;\n      return action;\n    }\n\n    // overwrite\n    Object.assign(action, outline);\n\n    // see if should reformat headers;\n    if (isString(action.headers)) {\n      var parts = action.headers.split(/:(.+)/);\n      action.headers = {\n        header: parts[0],\n        value: parts[1]\n      };\n    }\n\n    // if is bool withCredentials\n    action.withCredentials = toBoolean(action.withCredentials);\n\n    return action;\n  };\n\n  var toServerAPI = function toServerAPI(value) {\n    return createServerAPI(value);\n  };\n\n  var isNull = function isNull(value) {\n    return value === null;\n  };\n\n  var isObject = function isObject(value) {\n    return typeof value === 'object' && value !== null;\n  };\n\n  var isAPI = function isAPI(value) {\n    return (\n      isObject(value) &&\n      isString(value.url) &&\n      isObject(value.process) &&\n      isObject(value.revert) &&\n      isObject(value.restore) &&\n      isObject(value.fetch)\n    );\n  };\n\n  var getType = function getType(value) {\n    if (isArray(value)) {\n      return 'array';\n    }\n\n    if (isNull(value)) {\n      return 'null';\n    }\n\n    if (isInt(value)) {\n      return 'int';\n    }\n\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n      return 'bytes';\n    }\n\n    if (isAPI(value)) {\n      return 'api';\n    }\n\n    return typeof value;\n  };\n\n  var replaceSingleQuotes = function replaceSingleQuotes(str) {\n    return str\n      .replace(/{\\s*'/g, '{\"')\n      .replace(/'\\s*}/g, '\"}')\n      .replace(/'\\s*:/g, '\":')\n      .replace(/:\\s*'/g, ':\"')\n      .replace(/,\\s*'/g, ',\"')\n      .replace(/'\\s*,/g, '\",');\n  };\n\n  var conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: function int(value) {\n      return getType(value) === 'bytes' ? toBytes(value) : toInt(value);\n    },\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: function string(value) {\n      return isFunction(value) ? value : toString(value);\n    },\n    function: function _function(value) {\n      return toFunctionReference(value);\n    },\n    serverapi: toServerAPI,\n    object: function object(value) {\n      try {\n        return JSON.parse(replaceSingleQuotes(value));\n      } catch (e) {\n        return null;\n      }\n    }\n  };\n\n  var convertTo = function convertTo(value, type) {\n    return conversionTable[type](value);\n  };\n\n  var getValueByType = function getValueByType(\n    newValue,\n    defaultValue,\n    valueType\n  ) {\n    // can always assign default value\n    if (newValue === defaultValue) {\n      return newValue;\n    }\n\n    // get the type of the new value\n    var newValueType = getType(newValue);\n\n    // is valid type?\n    if (newValueType !== valueType) {\n      // is string input, let's attempt to convert\n      var convertedValue = convertTo(newValue, valueType);\n\n      // what is the type now\n      newValueType = getType(convertedValue);\n\n      // no valid conversions found\n      if (convertedValue === null) {\n        throw 'Trying to assign value with incorrect type to \"' +\n          option +\n          '\", allowed type: \"' +\n          valueType +\n          '\"';\n      } else {\n        newValue = convertedValue;\n      }\n    }\n\n    // assign new value\n    return newValue;\n  };\n\n  var createOption = function createOption(defaultValue, valueType) {\n    var currentValue = defaultValue;\n    return {\n      enumerable: true,\n      get: function get() {\n        return currentValue;\n      },\n      set: function set(newValue) {\n        currentValue = getValueByType(newValue, defaultValue, valueType);\n      }\n    };\n  };\n\n  var createOptions = function createOptions(options) {\n    var obj = {};\n    forin(options, function(prop) {\n      var optionDefinition = options[prop];\n      obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n  };\n\n  var createInitialState = function createInitialState(options) {\n    return {\n      // model\n      items: [],\n\n      // timeout used for calling update items\n      listUpdateTimeout: null,\n\n      // timeout used for stacking metadata updates\n      itemUpdateTimeout: null,\n\n      // queue of items waiting to be processed\n      processingQueue: [],\n\n      // options\n      options: createOptions(options)\n    };\n  };\n\n  var fromCamels = function fromCamels(string) {\n    var separator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string\n      .split(/(?=[A-Z])/)\n      .map(function(part) {\n        return part.toLowerCase();\n      })\n      .join(separator);\n  };\n\n  var createOptionAPI = function createOptionAPI(store, options) {\n    var obj = {};\n    forin(options, function(key) {\n      obj[key] = {\n        get: function get() {\n          return store.getState().options[key];\n        },\n        set: function set(value) {\n          store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        }\n      };\n    });\n    return obj;\n  };\n\n  var createOptionActions = function createOptionActions(options) {\n    return function(dispatch, query, state) {\n      var obj = {};\n      forin(options, function(key) {\n        var name = fromCamels(key, '_').toUpperCase();\n\n        obj['SET_' + name] = function(action) {\n          try {\n            state.options[key] = action.value;\n          } catch (e) {} // nope, failed\n\n          // we successfully set the value of this option\n          dispatch('DID_SET_' + name, { value: state.options[key] });\n        };\n      });\n      return obj;\n    };\n  };\n\n  var createOptionQueries = function createOptionQueries(options) {\n    return function(state) {\n      var obj = {};\n      forin(options, function(key) {\n        obj['GET_' + fromCamels(key, '_').toUpperCase()] = function(action) {\n          return state.options[key];\n        };\n      });\n      return obj;\n    };\n  };\n\n  var InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5\n  };\n\n  var getUniqueId = function getUniqueId() {\n    return Math.random()\n      .toString(36)\n      .substr(2, 9);\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function(obj) {\n        return obj &&\n          typeof Symbol === 'function' &&\n          obj.constructor === Symbol &&\n          obj !== Symbol.prototype\n          ? 'symbol'\n          : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE =\n        (typeof Symbol === 'function' &&\n          Symbol['for'] &&\n          Symbol['for']('react.element')) ||\n        0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol !== 'undefined') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function(resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n          function(arg) {\n            if (wrappedAwait) {\n              resume('next', arg);\n              return;\n            }\n\n            settle(result.done ? 'return' : 'normal', arg);\n          },\n          function(err) {\n            resume('throw', err);\n          }\n        );\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function(arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function(arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function(arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function() {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function(resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function() {\n        return this;\n      };\n    }\n\n    iter.next = function(value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function(value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function(value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function() {\n      var self = this,\n        args = arguments;\n      return new Promise(function(resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(\n            gen,\n            resolve,\n            reject,\n            _next,\n            _throw,\n            'next',\n            value\n          );\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends =\n      Object.assign ||\n      function(target) {\n        for (var i = 1; i < arguments.length; i++) {\n          var source = arguments[i];\n\n          for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n              target[key] = source[key];\n            }\n          }\n        }\n\n        return target;\n      };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(\n          Object.getOwnPropertySymbols(source).filter(function(sym) {\n            return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n          })\n        );\n      }\n\n      ownKeys.forEach(function(key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly)\n        symbols = symbols.filter(function(sym) {\n          return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n        });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(source, true).forEach(function(key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(\n          target,\n          Object.getOwnPropertyDescriptors(source)\n        );\n      } else {\n        ownKeys(source).forEach(function(key) {\n          Object.defineProperty(\n            target,\n            key,\n            Object.getOwnPropertyDescriptor(source, key)\n          );\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf\n      ? Object.getPrototypeOf\n      : function _getPrototypeOf(o) {\n          return o.__proto__ || Object.getPrototypeOf(o);\n        };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf =\n      Object.setPrototypeOf ||\n      function _setPrototypeOf(o, p) {\n        o.__proto__ = p;\n        return o;\n      };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError(\n          'Super expression must either be null or a function'\n        );\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (\n      right != null &&\n      typeof Symbol !== 'undefined' &&\n      right[Symbol.hasInstance]\n    ) {\n      return !!right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule\n      ? obj\n      : {\n          default: obj\n        };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc =\n              Object.defineProperty && Object.getOwnPropertyDescriptor\n                ? Object.getOwnPropertyDescriptor(obj, key)\n                : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\n        \"this hasn't been initialised - super() hasn't been called\"\n      );\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(\n      Object.defineProperties(strings, {\n        raw: {\n          value: Object.freeze(raw)\n        }\n      })\n    );\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error(\n      'Class \"' + name + '\" cannot be referenced in computed property keys.'\n    );\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimit(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimitLoose(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return (\n      _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread()\n    );\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)\n        arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (\n      Symbol.iterator in Object(iter) ||\n      Object.prototype.toString.call(iter) === '[object Arguments]'\n    )\n      return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (\n        var _i = arr[Symbol.iterator](), _s;\n        !(_n = (_s = _i.next()).done);\n        _n = true\n      ) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (\n      var _iterator = arr[Symbol.iterator](), _step;\n      !(_step = _iterator.next()).done;\n\n    ) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function() {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error(\n      'Decorating class property failed. Please ensure that ' +\n        'proposal-class-properties is enabled and set to use loose mode. ' +\n        'To use proposal-class-properties in spec mode with decorators, wait for ' +\n        'the next major version of decorators in stage 2.'\n    );\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer\n        ? descriptor.initializer.call(context)\n        : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(\n    target,\n    property,\n    decorators,\n    descriptor,\n    context\n  ) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function(key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators\n      .slice()\n      .reverse()\n      .reduce(function(desc, decorator) {\n        return decorator(target, property, desc) || desc;\n      }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classPrivateFieldDestructureSet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      if (!('__destrObj' in descriptor)) {\n        descriptor.__destrObj = {\n          set value(v) {\n            descriptor.set.call(receiver, v);\n          }\n        };\n      }\n\n      return descriptor.__destrObj;\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      return descriptor;\n    }\n  }\n\n  function _classStaticPrivateFieldSpecGet(\n    receiver,\n    classConstructor,\n    descriptor\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(\n    receiver,\n    classConstructor,\n    descriptor,\n    value\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(\n      _coalesceClassElements(r.d.map(_createElementDescriptor)),\n      decorators\n    );\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function() {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function(O, elements) {\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function(F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            var placement = element.placement;\n\n            if (\n              element.kind === kind &&\n              (placement === 'static' || placement === 'prototype')\n            ) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function(receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function(elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function(element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function(element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(\n            element,\n            placements\n          );\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function(element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function(element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (\n          var decorators = element.decorators, i = decorators.length - 1;\n          i >= 0;\n          i--\n        ) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras(\n            (0, decorators[i])(elementObject) || elementObject\n          );\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function(elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor(\n            (0, decorators[i])(obj) || obj\n          );\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (\n                  elements[j].key === elements[k].key &&\n                  elements[j].placement === elements[k].placement\n                ) {\n                  throw new TypeError(\n                    'Duplicated element (' + elements[j].key + ')'\n                  );\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function(element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function(elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function(elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(\n            elementObject,\n            'finisher',\n            'An element descriptor'\n          );\n          this.disallowProperty(\n            elementObject,\n            'extras',\n            'An element descriptor'\n          );\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function(elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError(\n            'An element descriptor\\'s .kind property must be either \"method\" or' +\n              ' \"field\", but a decorator created an element descriptor with' +\n              ' .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (\n          placement !== 'static' &&\n          placement !== 'prototype' &&\n          placement !== 'own'\n        ) {\n          throw new TypeError(\n            'An element descriptor\\'s .placement property must be one of \"static\",' +\n              ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n              ' with .placement \"' +\n              placement +\n              '\"'\n          );\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(\n          elementObject,\n          'elements',\n          'An element descriptor'\n        );\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(\n            elementObject,\n            'initializer',\n            'A method descriptor'\n          );\n        } else {\n          this.disallowProperty(\n            descriptor,\n            'get',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'set',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'value',\n            'The property descriptor of a field descriptor'\n          );\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function(elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function(elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function(obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError(\n            'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n              ' created a class descriptor with .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function(constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function(obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(\n            objectType + \" can't have a .\" + name + ' property.'\n          );\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static\n        ? 'static'\n        : def.kind === 'field'\n        ? 'own'\n        : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function(other) {\n      return (\n        other.kind === 'method' &&\n        other.key === element.key &&\n        other.placement === element.placement\n      );\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (\n        element.kind === 'method' &&\n        (other = newElements.find(isSameElement))\n      ) {\n        if (\n          _isDataDescriptor(element.descriptor) ||\n          _isDataDescriptor(other.descriptor)\n        ) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError(\n              'Duplicated methods (' + element.key + \") can't be decorated.\"\n            );\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\n                \"Decorators can't be placed on different accessors with for \" +\n                  'the same property (' +\n                  element.key +\n                  ').'\n              );\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return (\n      desc !== undefined &&\n      !(desc.value === undefined && desc.writable === undefined)\n    );\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function(re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function(str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(\n          this,\n          str,\n          substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n            return '$' + groups[name];\n          })\n        );\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function() {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function(groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var arrayRemove = function arrayRemove(arr, index) {\n    return arr.splice(index, 1);\n  };\n\n  var run = function run(cb, sync) {\n    if (sync) {\n      cb();\n    } else if (document.hidden) {\n      Promise.resolve(1).then(cb);\n    } else {\n      setTimeout(cb, 0);\n    }\n  };\n\n  var on = function on() {\n    var listeners = [];\n    var off = function off(event, cb) {\n      arrayRemove(\n        listeners,\n        listeners.findIndex(function(listener) {\n          return listener.event === event && (listener.cb === cb || !cb);\n        })\n      );\n    };\n    var _fire = function fire(event, args, sync) {\n      listeners\n        .filter(function(listener) {\n          return listener.event === event;\n        })\n        .map(function(listener) {\n          return listener.cb;\n        })\n        .forEach(function(cb) {\n          return run(function() {\n            return cb.apply(void 0, _toConsumableArray(args));\n          }, sync);\n        });\n    };\n    return {\n      fireSync: function fireSync(event) {\n        for (\n          var _len = arguments.length,\n            args = new Array(_len > 1 ? _len - 1 : 0),\n            _key = 1;\n          _key < _len;\n          _key++\n        ) {\n          args[_key - 1] = arguments[_key];\n        }\n        _fire(event, args, true);\n      },\n      fire: function fire(event) {\n        for (\n          var _len2 = arguments.length,\n            args = new Array(_len2 > 1 ? _len2 - 1 : 0),\n            _key2 = 1;\n          _key2 < _len2;\n          _key2++\n        ) {\n          args[_key2 - 1] = arguments[_key2];\n        }\n        _fire(event, args, false);\n      },\n      on: function on(event, cb) {\n        listeners.push({ event: event, cb: cb });\n      },\n      onOnce: function onOnce(event, _cb) {\n        listeners.push({\n          event: event,\n          cb: function cb() {\n            off(event, _cb);\n            _cb.apply(void 0, arguments);\n          }\n        });\n      },\n      off: off\n    };\n  };\n\n  var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(\n    src,\n    target,\n    excluded\n  ) {\n    Object.getOwnPropertyNames(src)\n      .filter(function(property) {\n        return !excluded.includes(property);\n      })\n      .forEach(function(key) {\n        return Object.defineProperty(\n          target,\n          key,\n          Object.getOwnPropertyDescriptor(src, key)\n        );\n      });\n  };\n\n  var PRIVATE = [\n    'fire',\n    'process',\n    'revert',\n    'load',\n    'on',\n    'off',\n    'onOnce',\n    'retryLoad',\n    'extend',\n    'archive',\n    'archived',\n    'release',\n    'released',\n    'requestProcessing',\n    'freeze'\n  ];\n\n  var createItemAPI = function createItemAPI(item) {\n    var api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n  };\n\n  var removeReleasedItems = function removeReleasedItems(items) {\n    items.forEach(function(item, index) {\n      if (item.released) {\n        arrayRemove(items, index);\n      }\n    });\n  };\n\n  var ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8\n  };\n\n  var FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3\n  };\n\n  var getNonNumeric = function getNonNumeric(str) {\n    return /[^0-9]+/.exec(str);\n  };\n\n  var getDecimalSeparator = function getDecimalSeparator() {\n    return getNonNumeric((1.1).toLocaleString())[0];\n  };\n\n  var getThousandsSeparator = function getThousandsSeparator() {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    var decimalSeparator = getDecimalSeparator();\n    var thousandsStringWithSeparator = (1000.0).toLocaleString();\n    var thousandsStringWithoutSeparator = (1000.0).toString();\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n      return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n    return decimalSeparator === '.' ? ',' : '.';\n  };\n\n  var Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex'\n  };\n\n  // all registered filters\n  var filters = [];\n\n  // loops over matching filters and passes options to each filter, returning the mapped results\n  var applyFilterChain = function applyFilterChain(key, value, utils) {\n    return new Promise(function(resolve, reject) {\n      // find matching filters for this key\n      var matchingFilters = filters\n        .filter(function(f) {\n          return f.key === key;\n        })\n        .map(function(f) {\n          return f.cb;\n        });\n\n      // resolve now\n      if (matchingFilters.length === 0) {\n        resolve(value);\n        return;\n      }\n\n      // first filter to kick things of\n      var initialFilter = matchingFilters.shift();\n\n      // chain filters\n      matchingFilters\n        .reduce(\n          // loop over promises passing value to next promise\n          function(current, next) {\n            return current.then(function(value) {\n              return next(value, utils);\n            });\n          },\n\n          // call initial filter, will return a promise\n          initialFilter(value, utils)\n\n          // all executed\n        )\n        .then(function(value) {\n          return resolve(value);\n        })\n        .catch(function(error) {\n          return reject(error);\n        });\n    });\n  };\n\n  var applyFilters = function applyFilters(key, value, utils) {\n    return filters\n      .filter(function(f) {\n        return f.key === key;\n      })\n      .map(function(f) {\n        return f.cb(value, utils);\n      });\n  };\n\n  // adds a new filter to the list\n  var addFilter = function addFilter(key, cb) {\n    return filters.push({ key: key, cb: cb });\n  };\n\n  var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {\n    return Object.assign(defaultOptions, additionalOptions);\n  };\n\n  var getOptions = function getOptions() {\n    return Object.assign({}, defaultOptions);\n  };\n\n  var setOptions = function setOptions(opts) {\n    forin(opts, function(key, value) {\n      // key does not exist, so this option cannot be set\n      if (!defaultOptions[key]) {\n        return;\n      }\n      defaultOptions[key][0] = getValueByType(\n        value,\n        defaultOptions[key][0],\n        defaultOptions[key][1]\n      );\n    });\n  };\n\n  // default options on app\n  var defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n\n    // input field name to use\n    name: ['filepond', Type.STRING],\n\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n\n    // is the field required\n    required: [false, Type.BOOLEAN],\n\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n\n    // sync `acceptedFileTypes` property with `accept` attribute\n    allowSyncAcceptAttribute: [true, Type.BOOLEAN],\n\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN], // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN], // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN], // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN], // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN], // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN], // Allows user to revert file upload\n    allowRemove: [true, Type.BOOLEAN], // Allow user to remove a file\n    allowProcess: [true, Type.BOOLEAN], // Allows user to process a file, when set to false, this removes the file upload button\n    allowReorder: [false, Type.BOOLEAN], // Allow reordering of files\n    allowDirectoriesOnly: [false, Type.BOOLEAN], // Allow only selecting directories with browse (no support for filtering dnd at this point)\n\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN], // Set to 'force' to require the file to be reverted before removal\n\n    // Input requirements\n    maxFiles: [null, Type.INT], // Max number of files\n    checkValidity: [false, Type.BOOLEAN], // Enables custom validity messages\n\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN], // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING], // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN], // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN], // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN], // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN], // Should upload files immediately on drop\n    maxParallelUploads: [2, Type.INT], // Maximum files to upload in parallel\n\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN], // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN], // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT], // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.Array], // Amount of times to retry upload of a chunk when it fails\n\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n\n    // File size calculations, can set to 1024, this is only used for display, properties use file size base 1000\n    fileSizeBase: [1000, Type.INT],\n\n    // Labels and status messages\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING], // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING], // Default is locale separator\n\n    labelIdle: [\n      'Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>',\n      Type.STRING\n    ],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING], // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING], // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconProcess: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>',\n      Type.STRING\n    ],\n\n    iconRetry: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconUndo: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconDone: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    oninitfile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n    onreorderfiles: [null, Type.FUNCTION],\n\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n    beforePrepareFile: [null, Type.FUNCTION],\n\n    // styles\n    stylePanelLayout: [null, Type.STRING], // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING], // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n    styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\n\n    // custom initial files array\n    files: [[], Type.ARRAY],\n\n    // show support by displaying credits\n    credits: [['https://pqina.nl/', 'Powered by PQINA'], Type.ARRAY]\n  };\n\n  var getItemByQuery = function getItemByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return items[0] || null;\n    }\n\n    // query is index\n    if (isInt(query)) {\n      return items[query] || null;\n    }\n\n    // if query is item, get the id\n    if (typeof query === 'object') {\n      query = query.id;\n    }\n\n    // assume query is a string and return item by id\n    return (\n      items.find(function(item) {\n        return item.id === query;\n      }) || null\n    );\n  };\n\n  var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(\n    aspectRatio\n  ) {\n    if (isEmpty(aspectRatio)) {\n      return aspectRatio;\n    }\n    if (/:/.test(aspectRatio)) {\n      var parts = aspectRatio.split(':');\n      return parts[1] / parts[0];\n    }\n    return parseFloat(aspectRatio);\n  };\n\n  var getActiveItems = function getActiveItems(items) {\n    return items.filter(function(item) {\n      return !item.archived;\n    });\n  };\n\n  var Status = {\n    EMPTY: 0,\n    IDLE: 1, // waiting\n    ERROR: 2, // a file is in error state\n    BUSY: 3, // busy processing or loading\n    READY: 4 // all files uploaded\n  };\n\n  var ITEM_ERROR = [\n    ItemStatus.LOAD_ERROR,\n    ItemStatus.PROCESSING_ERROR,\n    ItemStatus.PROCESSING_REVERT_ERROR\n  ];\n  var ITEM_BUSY = [\n    ItemStatus.LOADING,\n    ItemStatus.PROCESSING,\n    ItemStatus.PROCESSING_QUEUED,\n    ItemStatus.INIT\n  ];\n  var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\n  var isItemInErrorState = function isItemInErrorState(item) {\n    return ITEM_ERROR.includes(item.status);\n  };\n  var isItemInBusyState = function isItemInBusyState(item) {\n    return ITEM_BUSY.includes(item.status);\n  };\n  var isItemInReadyState = function isItemInReadyState(item) {\n    return ITEM_READY.includes(item.status);\n  };\n\n  var queries = function queries(state) {\n    return {\n      GET_STATUS: function GET_STATUS() {\n        var items = getActiveItems(state.items);\n        var EMPTY = Status.EMPTY,\n          ERROR = Status.ERROR,\n          BUSY = Status.BUSY,\n          IDLE = Status.IDLE,\n          READY = Status.READY;\n\n        if (items.length === 0) return EMPTY;\n\n        if (items.some(isItemInErrorState)) return ERROR;\n\n        if (items.some(isItemInBusyState)) return BUSY;\n\n        if (items.some(isItemInReadyState)) return READY;\n\n        return IDLE;\n      },\n\n      GET_ITEM: function GET_ITEM(query) {\n        return getItemByQuery(state.items, query);\n      },\n\n      GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {\n        return getItemByQuery(getActiveItems(state.items), query);\n      },\n\n      GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {\n        return getActiveItems(state.items);\n      },\n\n      GET_ITEMS: function GET_ITEMS() {\n        return state.items;\n      },\n\n      GET_ITEM_NAME: function GET_ITEM_NAME(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n      },\n\n      GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n      },\n\n      GET_STYLES: function GET_STYLES() {\n        return Object.keys(state.options)\n          .filter(function(key) {\n            return /^style/.test(key);\n          })\n          .map(function(option) {\n            return {\n              name: option,\n              value: state.options[option]\n            };\n          });\n      },\n\n      GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {\n        var isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        var aspectRatio = isShapeCircle\n          ? 1\n          : getNumericAspectRatioFromString(\n              state.options.stylePanelAspectRatio\n            );\n        return aspectRatio;\n      },\n\n      GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {\n        return state.options.styleItemPanelAspectRatio;\n      },\n\n      GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {\n        return getActiveItems(state.items).filter(function(item) {\n          return item.status === status;\n        });\n      },\n\n      GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {\n        return getActiveItems(state.items).length;\n      },\n\n      IS_ASYNC: function IS_ASYNC() {\n        return (\n          isObject(state.options.server) &&\n          (isObject(state.options.server.process) ||\n            isFunction(state.options.server.process))\n        );\n      }\n    };\n  };\n\n  var hasRoomForItem = function hasRoomForItem(state) {\n    var count = getActiveItems(state.items).length;\n\n    // if cannot have multiple items, to add one item it should currently not contain items\n    if (!state.options.allowMultiple) {\n      return count === 0;\n    }\n\n    // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n    var maxFileCount = state.options.maxFiles;\n    if (maxFileCount === null) {\n      return true;\n    }\n\n    // we check if the current count is smaller than the max count, if so, another file can still be added\n    if (count < maxFileCount) {\n      return true;\n    }\n\n    // no more room for another file\n    return false;\n  };\n\n  var limit = function limit(value, min, max) {\n    return Math.max(Math.min(max, value), min);\n  };\n\n  var arrayInsert = function arrayInsert(arr, index, item) {\n    return arr.splice(index, 0, item);\n  };\n\n  var insertItem = function insertItem(items, item, index) {\n    if (isEmpty(item)) {\n      return null;\n    }\n\n    // if index is undefined, append\n    if (typeof index === 'undefined') {\n      items.push(item);\n      return item;\n    }\n\n    // limit the index to the size of the items array\n    index = limit(index, 0, items.length);\n\n    // add item to array\n    arrayInsert(items, index, item);\n\n    // expose\n    return item;\n  };\n\n  var isBase64DataURI = function isBase64DataURI(str) {\n    return /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(\n      str\n    );\n  };\n\n  var getFilenameFromURL = function getFilenameFromURL(url) {\n    return url\n      .split('/')\n      .pop()\n      .split('?')\n      .shift();\n  };\n\n  var getExtensionFromFilename = function getExtensionFromFilename(name) {\n    return name.split('.').pop();\n  };\n\n  var guesstimateExtension = function guesstimateExtension(type) {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n      return '';\n    }\n\n    // get subtype\n    var subtype = type.split('/').pop();\n\n    // is svg subtype\n    if (/svg/.test(subtype)) {\n      return 'svg';\n    }\n\n    if (/zip|compressed/.test(subtype)) {\n      return 'zip';\n    }\n\n    if (/plain/.test(subtype)) {\n      return 'txt';\n    }\n\n    if (/msword/.test(subtype)) {\n      return 'doc';\n    }\n\n    // if is valid subtype\n    if (/[a-z]+/.test(subtype)) {\n      // always use jpg extension\n      if (subtype === 'jpeg') {\n        return 'jpg';\n      }\n\n      // return subtype\n      return subtype;\n    }\n\n    return '';\n  };\n\n  var leftPad = function leftPad(value) {\n    var padding =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    return (padding + value).slice(-padding.length);\n  };\n\n  var getDateString = function getDateString() {\n    var date =\n      arguments.length > 0 && arguments[0] !== undefined\n        ? arguments[0]\n        : new Date();\n    return (\n      date.getFullYear() +\n      '-' +\n      leftPad(date.getMonth() + 1, '00') +\n      '-' +\n      leftPad(date.getDate(), '00') +\n      '_' +\n      leftPad(date.getHours(), '00') +\n      '-' +\n      leftPad(date.getMinutes(), '00') +\n      '-' +\n      leftPad(date.getSeconds(), '00')\n    );\n  };\n\n  var getFileFromBlob = function getFileFromBlob(blob, filename) {\n    var type =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var extension =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    var file =\n      typeof type === 'string'\n        ? blob.slice(0, blob.size, type)\n        : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date();\n\n    // copy relative path\n    if (blob._relativePath) file._relativePath = blob._relativePath;\n\n    // if blob has name property, use as filename if no filename supplied\n    if (!isString(filename)) {\n      filename = getDateString();\n    }\n\n    // if filename supplied but no extension and filename has extension\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n      file.name = filename;\n    } else {\n      extension = extension || guesstimateExtension(file.type);\n      file.name = filename + (extension ? '.' + extension : '');\n    }\n\n    return file;\n  };\n\n  var getBlobBuilder = function getBlobBuilder() {\n    return (window.BlobBuilder =\n      window.BlobBuilder ||\n      window.WebKitBlobBuilder ||\n      window.MozBlobBuilder ||\n      window.MSBlobBuilder);\n  };\n\n  var createBlob = function createBlob(arrayBuffer, mimeType) {\n    var BB = getBlobBuilder();\n\n    if (BB) {\n      var bb = new BB();\n      bb.append(arrayBuffer);\n      return bb.getBlob(mimeType);\n    }\n\n    return new Blob([arrayBuffer], {\n      type: mimeType\n    });\n  };\n\n  var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(\n    byteString,\n    mimeType\n  ) {\n    var ab = new ArrayBuffer(byteString.length);\n    var ia = new Uint8Array(ab);\n\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n\n    return createBlob(ab, mimeType);\n  };\n\n  var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(\n    dataURI\n  ) {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n  };\n\n  var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(\n    dataURI\n  ) {\n    // get data part of string (remove data:image/jpeg...,)\n    var data = dataURI.split(',')[1];\n\n    // remove any whitespace as that causes InvalidCharacterError in IE\n    return data.replace(/\\s/g, '');\n  };\n\n  var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(\n    dataURI\n  ) {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n  };\n\n  var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {\n    var mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    var byteString = getByteStringFromBase64DataURI(dataURI);\n\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n  };\n\n  var getFileFromBase64DataURI = function getFileFromBase64DataURI(\n    dataURI,\n    filename,\n    extension\n  ) {\n    return getFileFromBlob(\n      getBlobFromBase64DataURI(dataURI),\n      filename,\n      null,\n      extension\n    );\n  };\n\n  var getFileNameFromHeader = function getFileNameFromHeader(header) {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null;\n\n    // get filename parts\n    var matches = header\n      .split(/filename=|filename\\*=.+''/)\n      .splice(1)\n      .map(function(name) {\n        return name.trim().replace(/^[\"']|[;\"']{0,2}$/g, '');\n      })\n      .filter(function(name) {\n        return name.length;\n      });\n\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n  };\n\n  var getFileSizeFromHeader = function getFileSizeFromHeader(header) {\n    if (/content-length:/i.test(header)) {\n      var size = header.match(/[0-9]+/)[0];\n      return size ? parseInt(size, 10) : null;\n    }\n    return null;\n  };\n\n  var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {\n    if (/x-content-transfer-id:/i.test(header)) {\n      var id = (header.split(':')[1] || '').trim();\n      return id || null;\n    }\n    return null;\n  };\n\n  var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {\n    var info = {\n      source: null,\n      name: null,\n      size: null\n    };\n\n    var rows = headers.split('\\n');\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n    try {\n      for (\n        var _iterator = rows[Symbol.iterator](), _step;\n        !(_iteratorNormalCompletion = (_step = _iterator.next()).done);\n        _iteratorNormalCompletion = true\n      ) {\n        var header = _step.value;\n\n        var name = getFileNameFromHeader(header);\n        if (name) {\n          info.name = name;\n          continue;\n        }\n\n        var size = getFileSizeFromHeader(header);\n        if (size) {\n          info.size = size;\n          continue;\n        }\n\n        var source = getTranfserIdFromHeader(header);\n        if (source) {\n          info.source = source;\n          continue;\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    return info;\n  };\n\n  var createFileLoader = function createFileLoader(fetchFn) {\n    var state = {\n      source: null,\n      complete: false,\n      progress: 0,\n      size: null,\n      timestamp: null,\n      duration: 0,\n      request: null\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress;\n    };\n    var abort = function abort() {\n      if (state.request && state.request.abort) {\n        state.request.abort();\n      }\n    };\n\n    // load source\n    var load = function load() {\n      // get quick reference\n      var source = state.source;\n\n      api.fire('init', source);\n\n      // Load Files\n      if (source instanceof File) {\n        api.fire('load', source);\n      } else if (source instanceof Blob) {\n        // Load blobs, set default name to current date\n        api.fire('load', getFileFromBlob(source, source.name));\n      } else if (isBase64DataURI(source)) {\n        // Load base 64, set default name to current date\n        api.fire('load', getFileFromBase64DataURI(source));\n      } else {\n        // Deal as if is external URL, let's load it!\n        loadURL(source);\n      }\n    };\n\n    // loads a url\n    var loadURL = function loadURL(url) {\n      // is remote url and no fetch method supplied\n      if (!fetchFn) {\n        api.fire('error', {\n          type: 'error',\n          body: \"Can't load URL\",\n          code: 400\n        });\n\n        return;\n      }\n\n      // set request start\n      state.timestamp = Date.now();\n\n      // load file\n      state.request = fetchFn(\n        url,\n        function(response) {\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // done!\n          state.complete = true;\n\n          // turn blob response into a file\n          if (response instanceof Blob) {\n            response = getFileFromBlob(\n              response,\n              response.name || getFilenameFromURL(url)\n            );\n          }\n\n          api.fire(\n            'load',\n            // if has received blob, we go with blob, if no response, we return null\n            response instanceof Blob\n              ? response\n              : response\n              ? response.body\n              : null\n          );\n        },\n        function(error) {\n          api.fire(\n            'error',\n            typeof error === 'string'\n              ? {\n                  type: 'error',\n                  code: 0,\n                  body: error\n                }\n              : error\n          );\n        },\n        function(computable, current, total) {\n          // collected some meta data already\n          if (total) {\n            state.size = total;\n          }\n\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // if we can't compute progress, we're not going to fire progress events\n          if (!computable) {\n            state.progress = null;\n            return;\n          }\n\n          // update progress percentage\n          state.progress = current / total;\n\n          // expose\n          api.fire('progress', state.progress);\n        },\n        function() {\n          api.fire('abort');\n        },\n        function(response) {\n          var fileinfo = getFileInfoFromHeaders(\n            typeof response === 'string' ? response : response.headers\n          );\n          api.fire('meta', {\n            size: state.size || fileinfo.size,\n            filename: fileinfo.name,\n            source: fileinfo.source\n          });\n        }\n      );\n    };\n\n    var api = Object.assign({}, on(), {\n      setSource: function setSource(source) {\n        return (state.source = source);\n      },\n      getProgress: getProgress, // file load progress\n      abort: abort, // abort file load\n      load: load // start load\n    });\n\n    return api;\n  };\n\n  var isGet = function isGet(method) {\n    return /GET|HEAD/.test(method);\n  };\n\n  var sendRequest = function sendRequest(data, url, options) {\n    var api = {\n      onheaders: function onheaders() {},\n      onprogress: function onprogress() {},\n      onload: function onload() {},\n      ontimeout: function ontimeout() {},\n      onerror: function onerror() {},\n      onabort: function onabort() {},\n      abort: function abort() {\n        aborted = true;\n        xhr.abort();\n      }\n    };\n\n    // timeout identifier, only used when timeout is defined\n    var aborted = false;\n    var headersReceived = false;\n\n    // set default options\n    options = Object.assign(\n      {\n        method: 'POST',\n        headers: {},\n        withCredentials: false\n      },\n      options\n    );\n\n    // encode url\n    url = encodeURI(url);\n\n    // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n      url =\n        '' +\n        url +\n        encodeURIComponent(\n          typeof data === 'string' ? data : JSON.stringify(data)\n        );\n    }\n\n    // create request\n    var xhr = new XMLHttpRequest();\n\n    // progress of load\n    var process = isGet(options.method) ? xhr : xhr.upload;\n    process.onprogress = function(e) {\n      // no progress event when aborted ( onprogress is called once after abort() )\n      if (aborted) {\n        return;\n      }\n\n      api.onprogress(e.lengthComputable, e.loaded, e.total);\n    };\n\n    // tries to get header info to the app as fast as possible\n    xhr.onreadystatechange = function() {\n      // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n      if (xhr.readyState < 2) {\n        return;\n      }\n\n      // no server response\n      if (xhr.readyState === 4 && xhr.status === 0) {\n        return;\n      }\n\n      if (headersReceived) {\n        return;\n      }\n\n      headersReceived = true;\n\n      // we've probably received some useful data in response headers\n      api.onheaders(xhr);\n    };\n\n    // load successful\n    xhr.onload = function() {\n      // is classified as valid response\n      if (xhr.status >= 200 && xhr.status < 300) {\n        api.onload(xhr);\n      } else {\n        api.onerror(xhr);\n      }\n    };\n\n    // error during load\n    xhr.onerror = function() {\n      return api.onerror(xhr);\n    };\n\n    // request aborted\n    xhr.onabort = function() {\n      aborted = true;\n      api.onabort();\n    };\n\n    // request timeout\n    xhr.ontimeout = function() {\n      return api.ontimeout(xhr);\n    };\n\n    // open up open up!\n    xhr.open(options.method, url, true);\n\n    // set timeout if defined (do it after open so IE11 plays ball)\n    if (isInt(options.timeout)) {\n      xhr.timeout = options.timeout;\n    }\n\n    // add headers\n    Object.keys(options.headers).forEach(function(key) {\n      var value = unescape(encodeURIComponent(options.headers[key]));\n      xhr.setRequestHeader(key, value);\n    });\n\n    // set type of response\n    if (options.responseType) {\n      xhr.responseType = options.responseType;\n    }\n\n    // set credentials\n    if (options.withCredentials) {\n      xhr.withCredentials = true;\n    }\n\n    // let's send our data\n    xhr.send(data);\n\n    return api;\n  };\n\n  var createResponse = function createResponse(type, code, body, headers) {\n    return {\n      type: type,\n      code: code,\n      body: body,\n      headers: headers\n    };\n  };\n\n  var createTimeoutResponse = function createTimeoutResponse(cb) {\n    return function(xhr) {\n      cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n    };\n  };\n\n  var hasQS = function hasQS(str) {\n    return /\\?/.test(str);\n  };\n  var buildURL = function buildURL() {\n    var url = '';\n    for (\n      var _len = arguments.length, parts = new Array(_len), _key = 0;\n      _key < _len;\n      _key++\n    ) {\n      parts[_key] = arguments[_key];\n    }\n    parts.forEach(function(part) {\n      url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\n    });\n    return url;\n  };\n\n  var createFetchFunction = function createFetchFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') {\n      return action;\n    }\n\n    // no action supplied\n    if (!action || !isString(action.url)) {\n      return null;\n    }\n\n    // set onload hanlder\n    var onload =\n      action.onload ||\n      function(res) {\n        return res;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // internal handler\n    return function(url, load, error, progress, abort, headers) {\n      // do local or remote request based on if the url is external\n      var request = sendRequest(\n        url,\n        buildURL(apiUrl, action.url),\n        Object.assign({}, action, {\n          responseType: 'blob'\n        })\n      );\n\n      request.onload = function(xhr) {\n        // get headers\n        var headers = xhr.getAllResponseHeaders();\n\n        // get filename\n        var filename =\n          getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n        // create response\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            action.method === 'HEAD'\n              ? null\n              : getFileFromBlob(onload(xhr.response), filename),\n            headers\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onheaders = function(xhr) {\n        headers(\n          createResponse(\n            'headers',\n            xhr.status,\n            null,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort;\n\n      // should return request\n      return request;\n    };\n  };\n\n  var ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4\n  };\n\n  /*\n                                                       function signature:\n                                                         (file, metadata, load, error, progress, abort, transfer, options) => {\n                                                           return {\n                                                           abort:() => {}\n                                                         }\n                                                       }\n                                                       */\n\n  // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\n  var processFileChunked = function processFileChunked(\n    apiUrl,\n    action,\n    name,\n    file,\n    metadata,\n    load,\n    error,\n    progress,\n    abort,\n    transfer,\n    options\n  ) {\n    // all chunks\n    var chunks = [];\n    var chunkTransferId = options.chunkTransferId,\n      chunkServer = options.chunkServer,\n      chunkSize = options.chunkSize,\n      chunkRetryDelays = options.chunkRetryDelays;\n\n    // default state\n    var state = {\n      serverId: chunkTransferId,\n      aborted: false\n    };\n\n    // set onload handlers\n    var ondata =\n      action.ondata ||\n      function(fd) {\n        return fd;\n      };\n    var onload =\n      action.onload ||\n      function(xhr, method) {\n        return method === 'HEAD'\n          ? xhr.getResponseHeader('Upload-Offset')\n          : xhr.response;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // create server hook\n    var requestTransferId = function requestTransferId(cb) {\n      var formData = new FormData();\n\n      // add metadata under same name\n      if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n\n      var headers =\n        typeof action.headers === 'function'\n          ? action.headers(file, metadata)\n          : Object.assign({}, action.headers, {\n              'Upload-Length': file.size\n            });\n\n      var requestParams = Object.assign({}, action, {\n        headers: headers\n      });\n\n      // send request object\n      var request = sendRequest(\n        ondata(formData),\n        buildURL(apiUrl, action.url),\n        requestParams\n      );\n\n      request.onload = function(xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function(xhr) {\n        return error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    var requestTransferOffset = function requestTransferOffset(cb) {\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n      var headers =\n        typeof action.headers === 'function'\n          ? action.headers(state.serverId)\n          : Object.assign({}, action.headers);\n\n      var requestParams = {\n        headers: headers,\n        method: 'HEAD'\n      };\n\n      var request = sendRequest(null, requestUrl, requestParams);\n\n      request.onload = function(xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function(xhr) {\n        return error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    // create chunks\n    var lastChunkIndex = Math.floor(file.size / chunkSize);\n    for (var i = 0; i <= lastChunkIndex; i++) {\n      var offset = i * chunkSize;\n      var data = file.slice(\n        offset,\n        offset + chunkSize,\n        'application/offset+octet-stream'\n      );\n      chunks[i] = {\n        index: i,\n        size: data.size,\n        offset: offset,\n        data: data,\n        file: file,\n        progress: 0,\n        retries: _toConsumableArray(chunkRetryDelays),\n        status: ChunkStatus.QUEUED,\n        error: null,\n        request: null,\n        timeout: null\n      };\n    }\n\n    var completeProcessingChunks = function completeProcessingChunks() {\n      return load(state.serverId);\n    };\n\n    var canProcessChunk = function canProcessChunk(chunk) {\n      return (\n        chunk.status === ChunkStatus.QUEUED ||\n        chunk.status === ChunkStatus.ERROR\n      );\n    };\n\n    var processChunk = function processChunk(chunk) {\n      // processing is paused, wait here\n      if (state.aborted) return;\n\n      // get next chunk to process\n      chunk = chunk || chunks.find(canProcessChunk);\n\n      // no more chunks to process\n      if (!chunk) {\n        // all done?\n        if (\n          chunks.every(function(chunk) {\n            return chunk.status === ChunkStatus.COMPLETE;\n          })\n        ) {\n          completeProcessingChunks();\n        }\n\n        // no chunk to handle\n        return;\n      }\n\n      // now processing this chunk\n      chunk.status = ChunkStatus.PROCESSING;\n      chunk.progress = null;\n\n      // allow parsing of formdata\n      var ondata =\n        chunkServer.ondata ||\n        function(fd) {\n          return fd;\n        };\n      var onerror =\n        chunkServer.onerror ||\n        function(res) {\n          return null;\n        };\n\n      // send request object\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n      var headers =\n        typeof chunkServer.headers === 'function'\n          ? chunkServer.headers(chunk)\n          : Object.assign({}, chunkServer.headers, {\n              'Content-Type': 'application/offset+octet-stream',\n              'Upload-Offset': chunk.offset,\n              'Upload-Length': file.size,\n              'Upload-Name': file.name\n            });\n\n      var request = (chunk.request = sendRequest(\n        ondata(chunk.data),\n        requestUrl,\n        Object.assign({}, chunkServer, {\n          headers: headers\n        })\n      ));\n\n      request.onload = function() {\n        // done!\n        chunk.status = ChunkStatus.COMPLETE;\n\n        // remove request reference\n        chunk.request = null;\n\n        // start processing more chunks\n        processChunks();\n      };\n\n      request.onprogress = function(lengthComputable, loaded, total) {\n        chunk.progress = lengthComputable ? loaded : null;\n        updateTotalProgress();\n      };\n\n      request.onerror = function(xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        chunk.error = onerror(xhr.response) || xhr.statusText;\n        if (!retryProcessChunk(chunk)) {\n          error(\n            createResponse(\n              'error',\n              xhr.status,\n              onerror(xhr.response) || xhr.statusText,\n              xhr.getAllResponseHeaders()\n            )\n          );\n        }\n      };\n\n      request.ontimeout = function(xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        if (!retryProcessChunk(chunk)) {\n          createTimeoutResponse(error)(xhr);\n        }\n      };\n\n      request.onabort = function() {\n        chunk.status = ChunkStatus.QUEUED;\n        chunk.request = null;\n        abort();\n      };\n    };\n\n    var retryProcessChunk = function retryProcessChunk(chunk) {\n      // no more retries left\n      if (chunk.retries.length === 0) return false;\n\n      // new retry\n      chunk.status = ChunkStatus.WAITING;\n      clearTimeout(chunk.timeout);\n      chunk.timeout = setTimeout(function() {\n        processChunk(chunk);\n      }, chunk.retries.shift());\n\n      // we're going to retry\n      return true;\n    };\n\n    var updateTotalProgress = function updateTotalProgress() {\n      // calculate total progress fraction\n      var totalBytesTransfered = chunks.reduce(function(p, chunk) {\n        if (p === null || chunk.progress === null) return null;\n        return p + chunk.progress;\n      }, 0);\n\n      // can't compute progress\n      if (totalBytesTransfered === null) return progress(false, 0, 0);\n\n      // calculate progress values\n      var totalSize = chunks.reduce(function(total, chunk) {\n        return total + chunk.size;\n      }, 0);\n\n      // can update progress indicator\n      progress(true, totalBytesTransfered, totalSize);\n    };\n\n    // process new chunks\n    var processChunks = function processChunks() {\n      var totalProcessing = chunks.filter(function(chunk) {\n        return chunk.status === ChunkStatus.PROCESSING;\n      }).length;\n      if (totalProcessing >= 1) return;\n      processChunk();\n    };\n\n    var abortChunks = function abortChunks() {\n      chunks.forEach(function(chunk) {\n        clearTimeout(chunk.timeout);\n        if (chunk.request) {\n          chunk.request.abort();\n        }\n      });\n    };\n\n    // let's go!\n    if (!state.serverId) {\n      requestTransferId(function(serverId) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return;\n\n        // pass back to item so we can use it if something goes wrong\n        transfer(serverId);\n\n        // store internally\n        state.serverId = serverId;\n        processChunks();\n      });\n    } else {\n      requestTransferOffset(function(offset) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return;\n\n        // mark chunks with lower offset as complete\n        chunks\n          .filter(function(chunk) {\n            return chunk.offset < offset;\n          })\n          .forEach(function(chunk) {\n            chunk.status = ChunkStatus.COMPLETE;\n            chunk.progress = chunk.size;\n          });\n\n        // continue processing\n        processChunks();\n      });\n    }\n\n    return {\n      abort: function abort() {\n        state.aborted = true;\n        abortChunks();\n      }\n    };\n  };\n\n  /*\n                                                               function signature:\n                                                                 (file, metadata, load, error, progress, abort) => {\n                                                                   return {\n                                                                   abort:() => {}\n                                                                 }\n                                                               }\n                                                               */\n  var createFileProcessorFunction = function createFileProcessorFunction(\n    apiUrl,\n    action,\n    name,\n    options\n  ) {\n    return function(file, metadata, load, error, progress, abort, transfer) {\n      // no file received\n      if (!file) return;\n\n      // if was passed a file, and we can chunk it, exit here\n      var canChunkUpload = options.chunkUploads;\n      var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n      var willChunkUpload =\n        canChunkUpload && (shouldChunkUpload || options.chunkForce);\n      if (file instanceof Blob && willChunkUpload)\n        return processFileChunked(\n          apiUrl,\n          action,\n          name,\n          file,\n          metadata,\n          load,\n          error,\n          progress,\n          abort,\n          transfer,\n          options\n        );\n\n      // set handlers\n      var ondata =\n        action.ondata ||\n        function(fd) {\n          return fd;\n        };\n      var onload =\n        action.onload ||\n        function(res) {\n          return res;\n        };\n      var onerror =\n        action.onerror ||\n        function(res) {\n          return null;\n        };\n\n      // create formdata object\n      var formData = new FormData();\n\n      // add metadata under same name\n      if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n      }\n\n      // Turn into an array of objects so no matter what the input, we can handle it the same way\n      (file instanceof Blob ? [{ name: null, file: file }] : file).forEach(\n        function(item) {\n          formData.append(\n            name,\n            item.file,\n            item.name === null\n              ? item.file.name\n              : '' + item.name + item.file.name\n          );\n        }\n      );\n\n      // send request object\n      var request = sendRequest(\n        ondata(formData),\n        buildURL(apiUrl, action.url),\n        action\n      );\n      request.onload = function(xhr) {\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            onload(xhr.response),\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort;\n\n      // should return request\n      return request;\n    };\n  };\n\n  var createProcessorFunction = function createProcessorFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    var name = arguments.length > 2 ? arguments[2] : undefined;\n    var options = arguments.length > 3 ? arguments[3] : undefined;\n\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function')\n      return function() {\n        for (\n          var _len = arguments.length, params = new Array(_len), _key = 0;\n          _key < _len;\n          _key++\n        ) {\n          params[_key] = arguments[_key];\n        }\n        return action.apply(void 0, [name].concat(params, [options]));\n      };\n\n    // no action supplied\n    if (!action || !isString(action.url)) return null;\n\n    // internal handler\n    return createFileProcessorFunction(apiUrl, action, name, options);\n  };\n\n  /*\n                                                      function signature:\n                                                      (uniqueFileId, load, error) => { }\n                                                      */\n  var createRevertFunction = function createRevertFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    // is custom implementation\n    if (typeof action === 'function') {\n      return action;\n    }\n\n    // no action supplied, return stub function, interface will work, but file won't be removed\n    if (!action || !isString(action.url)) {\n      return function(uniqueFileId, load) {\n        return load();\n      };\n    }\n\n    // set onload hanlder\n    var onload =\n      action.onload ||\n      function(res) {\n        return res;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // internal implementation\n    return function(uniqueFileId, load, error) {\n      var request = sendRequest(\n        uniqueFileId,\n        apiUrl + action.url,\n        action // contains method, headers and withCredentials properties\n      );\n      request.onload = function(xhr) {\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            onload(xhr.response),\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n\n      return request;\n    };\n  };\n\n  var getRandomNumber = function getRandomNumber() {\n    var min =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var max =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return min + Math.random() * (max - min);\n  };\n\n  var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(\n    cb\n  ) {\n    var duration =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    var offset =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var tickMin =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;\n    var tickMax =\n      arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n    var timeout = null;\n    var start = Date.now();\n\n    var tick = function tick() {\n      var runtime = Date.now() - start;\n      var delay = getRandomNumber(tickMin, tickMax);\n\n      if (runtime + delay > duration) {\n        delay = runtime + delay - duration;\n      }\n\n      var progress = runtime / duration;\n      if (progress >= 1 || document.hidden) {\n        cb(1);\n        return;\n      }\n\n      cb(progress);\n\n      timeout = setTimeout(tick, delay);\n    };\n\n    tick();\n\n    return {\n      clear: function clear() {\n        clearTimeout(timeout);\n      }\n    };\n  };\n\n  var createFileProcessor = function createFileProcessor(processFn) {\n    var state = {\n      complete: false,\n      perceivedProgress: 0,\n      perceivedPerformanceUpdater: null,\n      progress: null,\n      timestamp: null,\n      perceivedDuration: 0,\n      duration: 0,\n      request: null,\n      response: null\n    };\n\n    var process = function process(file, metadata) {\n      var progressFn = function progressFn() {\n        // we've not yet started the real download, stop here\n        // the request might not go through, for instance, there might be some server trouble\n        // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n        if (state.duration === 0 || state.progress === null) return;\n\n        // as we're now processing, fire the progress event\n        api.fire('progress', api.getProgress());\n      };\n\n      var completeFn = function completeFn() {\n        state.complete = true;\n        api.fire('load-perceived', state.response.body);\n      };\n\n      // let's start processing\n      api.fire('start');\n\n      // set request start\n      state.timestamp = Date.now();\n\n      // create perceived performance progress indicator\n      state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(\n        function(progress) {\n          state.perceivedProgress = progress;\n          state.perceivedDuration = Date.now() - state.timestamp;\n\n          progressFn();\n\n          // if fake progress is done, and a response has been received,\n          // and we've not yet called the complete method\n          if (\n            state.response &&\n            state.perceivedProgress === 1 &&\n            !state.complete\n          ) {\n            // we done!\n            completeFn();\n          }\n        },\n        // random delay as in a list of files you start noticing\n        // files uploading at the exact same speed\n        getRandomNumber(750, 1500)\n      );\n\n      // remember request so we can abort it later\n      state.request = processFn(\n        // the file to process\n        file,\n\n        // the metadata to send along\n        metadata,\n\n        // callbacks (load, error, progress, abort, transfer)\n        // load expects the body to be a server id if\n        // you want to make use of revert\n        function(response) {\n          // we put the response in state so we can access\n          // it outside of this method\n          state.response = isObject(response)\n            ? response\n            : {\n                type: 'load',\n                code: 200,\n                body: '' + response,\n                headers: {}\n              };\n\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // force progress to 1 as we're now done\n          state.progress = 1;\n\n          // actual load is done let's share results\n          api.fire('load', state.response.body);\n\n          // we are really done\n          // if perceived progress is 1 ( wait for perceived progress to complete )\n          // or if server does not support progress ( null )\n          if (state.perceivedProgress === 1) {\n            completeFn();\n          }\n        },\n\n        // error is expected to be an object with type, code, body\n        function(error) {\n          // cancel updater\n          state.perceivedPerformanceUpdater.clear();\n\n          // update others about this error\n          api.fire(\n            'error',\n            isObject(error)\n              ? error\n              : {\n                  type: 'error',\n                  code: 0,\n                  body: '' + error\n                }\n          );\n        },\n\n        // actual processing progress\n        function(computable, current, total) {\n          // update actual duration\n          state.duration = Date.now() - state.timestamp;\n\n          // update actual progress\n          state.progress = computable ? current / total : null;\n\n          progressFn();\n        },\n\n        // abort does not expect a value\n        function() {\n          // stop updater\n          state.perceivedPerformanceUpdater.clear();\n\n          // fire the abort event so we can switch visuals\n          api.fire('abort', state.response ? state.response.body : null);\n        },\n\n        // register the id for this transfer\n        function(transferId) {\n          api.fire('transfer', transferId);\n        }\n      );\n    };\n\n    var abort = function abort() {\n      // no request running, can't abort\n      if (!state.request) return;\n\n      // stop updater\n      state.perceivedPerformanceUpdater.clear();\n\n      // abort actual request\n      if (state.request.abort) state.request.abort();\n\n      // if has response object, we've completed the request\n      state.complete = true;\n    };\n\n    var reset = function reset() {\n      abort();\n      state.complete = false;\n      state.perceivedProgress = 0;\n      state.progress = 0;\n      state.timestamp = null;\n      state.perceivedDuration = 0;\n      state.duration = 0;\n      state.request = null;\n      state.response = null;\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress\n        ? Math.min(state.progress, state.perceivedProgress)\n        : null;\n    };\n    var getDuration = function getDuration() {\n      return Math.min(state.duration, state.perceivedDuration);\n    };\n\n    var api = Object.assign({}, on(), {\n      process: process, // start processing file\n      abort: abort, // abort active process request\n      getProgress: getProgress,\n      getDuration: getDuration,\n      reset: reset\n    });\n\n    return api;\n  };\n\n  var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n    return name.substr(0, name.lastIndexOf('.')) || name;\n  };\n\n  var createFileStub = function createFileStub(source) {\n    var data = [source.name, source.size, source.type];\n\n    // is blob or base64, then we need to set the name\n    if (source instanceof Blob || isBase64DataURI(source)) {\n      data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n      // if is base64 data uri we need to determine the average size and type\n      data[1] = source.length;\n      data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n      // url\n      data[0] = getFilenameFromURL(source);\n      data[1] = 0;\n      data[2] = 'application/octet-stream';\n    }\n\n    return {\n      name: data[0],\n      size: data[1],\n      type: data[2]\n    };\n  };\n\n  var isFile = function isFile(value) {\n    return !!(value instanceof File || (value instanceof Blob && value.name));\n  };\n\n  var deepCloneObject = function deepCloneObject(src) {\n    if (!isObject(src)) return src;\n    var target = isArray(src) ? [] : {};\n    for (var key in src) {\n      if (!src.hasOwnProperty(key)) continue;\n      var v = src[key];\n      target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n    return target;\n  };\n\n  var createItem = function createItem() {\n    var origin =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var serverFileReference =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var file =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    // unique id for this item, is used to identify the item across views\n    var id = getUniqueId();\n\n    /**\n     * Internal item state\n     */\n    var state = {\n      // is archived\n      archived: false,\n\n      // if is frozen, no longer fires events\n      frozen: false,\n\n      // removed from view\n      released: false,\n\n      // original source\n      source: null,\n\n      // file model reference\n      file: file,\n\n      // id of file on server\n      serverFileReference: serverFileReference,\n\n      // id of file transfer on server\n      transferId: null,\n\n      // is aborted\n      processingAborted: false,\n\n      // current item status\n      status: serverFileReference\n        ? ItemStatus.PROCESSING_COMPLETE\n        : ItemStatus.INIT,\n\n      // active processes\n      activeLoader: null,\n      activeProcessor: null\n    };\n\n    // callback used when abort processing is called to link back to the resolve method\n    var abortProcessingRequestComplete = null;\n\n    /**\n     * Externally added item metadata\n     */\n    var metadata = {};\n\n    // item data\n    var setStatus = function setStatus(status) {\n      return (state.status = status);\n    };\n\n    // fire event unless the item has been archived\n    var fire = function fire(event) {\n      if (state.released || state.frozen) return;\n      for (\n        var _len = arguments.length,\n          params = new Array(_len > 1 ? _len - 1 : 0),\n          _key = 1;\n        _key < _len;\n        _key++\n      ) {\n        params[_key - 1] = arguments[_key];\n      }\n      api.fire.apply(api, [event].concat(params));\n    };\n\n    // file data\n    var getFileExtension = function getFileExtension() {\n      return getExtensionFromFilename(state.file.name);\n    };\n    var getFileType = function getFileType() {\n      return state.file.type;\n    };\n    var getFileSize = function getFileSize() {\n      return state.file.size;\n    };\n    var getFile = function getFile() {\n      return state.file;\n    };\n\n    //\n    // logic to load a file\n    //\n    var load = function load(source, loader, onload) {\n      // remember the original item source\n      state.source = source;\n\n      // source is known\n      api.fireSync('init');\n\n      // file stub is already there\n      if (state.file) {\n        api.fireSync('load-skip');\n        return;\n      }\n\n      // set a stub file object while loading the actual data\n      state.file = createFileStub(source);\n\n      // starts loading\n      loader.on('init', function() {\n        fire('load-init');\n      });\n\n      // we'eve received a size indication, let's update the stub\n      loader.on('meta', function(meta) {\n        // set size of file stub\n        state.file.size = meta.size;\n\n        // set name of file stub\n        state.file.filename = meta.filename;\n\n        // if has received source, we done\n        if (meta.source) {\n          origin = FileOrigin.LIMBO;\n          state.serverFileReference = meta.source;\n          state.status = ItemStatus.PROCESSING_COMPLETE;\n        }\n\n        // size has been updated\n        fire('load-meta');\n      });\n\n      // the file is now loading we need to update the progress indicators\n      loader.on('progress', function(progress) {\n        setStatus(ItemStatus.LOADING);\n\n        fire('load-progress', progress);\n      });\n\n      // an error was thrown while loading the file, we need to switch to error state\n      loader.on('error', function(error) {\n        setStatus(ItemStatus.LOAD_ERROR);\n\n        fire('load-request-error', error);\n      });\n\n      // user or another process aborted the file load (cannot retry)\n      loader.on('abort', function() {\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n      });\n\n      // done loading\n      loader.on('load', function(file) {\n        // as we've now loaded the file the loader is no longer required\n        state.activeLoader = null;\n\n        // called when file has loaded succesfully\n        var success = function success(result) {\n          // set (possibly) transformed file\n          state.file = isFile(result) ? result : state.file;\n\n          // file received\n          if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n          } else {\n            setStatus(ItemStatus.IDLE);\n          }\n\n          fire('load');\n        };\n\n        var error = function error(result) {\n          // set original file\n          state.file = file;\n          fire('load-meta');\n\n          setStatus(ItemStatus.LOAD_ERROR);\n          fire('load-file-error', result);\n        };\n\n        // if we already have a server file reference, we don't need to call the onload method\n        if (state.serverFileReference) {\n          success(file);\n          return;\n        }\n\n        // no server id, let's give this file the full treatment\n        onload(file, success, error);\n      });\n\n      // set loader source data\n      loader.setSource(source);\n\n      // set as active loader\n      state.activeLoader = loader;\n\n      // load the source data\n      loader.load();\n    };\n\n    var retryLoad = function retryLoad() {\n      if (!state.activeLoader) {\n        return;\n      }\n      state.activeLoader.load();\n    };\n\n    var abortLoad = function abortLoad() {\n      if (state.activeLoader) {\n        state.activeLoader.abort();\n        return;\n      }\n      setStatus(ItemStatus.INIT);\n      fire('load-abort');\n    };\n\n    //\n    // logic to process a file\n    //\n    var process = function process(processor, onprocess) {\n      // processing was aborted\n      if (state.processingAborted) {\n        state.processingAborted = false;\n        return;\n      }\n\n      // now processing\n      setStatus(ItemStatus.PROCESSING);\n\n      // reset abort callback\n      abortProcessingRequestComplete = null;\n\n      // if no file loaded we'll wait for the load event\n      if (!(state.file instanceof Blob)) {\n        api.on('load', function() {\n          process(processor, onprocess);\n        });\n        return;\n      }\n\n      // setup processor\n      processor.on('load', function(serverFileReference) {\n        // need this id to be able to revert the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n      });\n\n      // register transfer id\n      processor.on('transfer', function(transferId) {\n        // need this id to be able to revert the upload\n        state.transferId = transferId;\n      });\n\n      processor.on('load-perceived', function(serverFileReference) {\n        // no longer required\n        state.activeProcessor = null;\n\n        // need this id to be able to rever the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n\n        setStatus(ItemStatus.PROCESSING_COMPLETE);\n        fire('process-complete', serverFileReference);\n      });\n\n      processor.on('start', function() {\n        fire('process-start');\n      });\n\n      processor.on('error', function(error) {\n        state.activeProcessor = null;\n        setStatus(ItemStatus.PROCESSING_ERROR);\n        fire('process-error', error);\n      });\n\n      processor.on('abort', function(serverFileReference) {\n        state.activeProcessor = null;\n\n        // if file was uploaded but processing was cancelled during perceived processor time store file reference\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n\n        setStatus(ItemStatus.IDLE);\n        fire('process-abort');\n\n        // has timeout so doesn't interfere with remove action\n        if (abortProcessingRequestComplete) {\n          abortProcessingRequestComplete();\n        }\n      });\n\n      processor.on('progress', function(progress) {\n        fire('process-progress', progress);\n      });\n\n      // when successfully transformed\n      var success = function success(file) {\n        // if was archived in the mean time, don't process\n        if (state.archived) return;\n\n        // process file!\n        processor.process(file, Object.assign({}, metadata));\n      };\n\n      // something went wrong during transform phase\n      var error = console.error;\n\n      // start processing the file\n      onprocess(state.file, success, error);\n\n      // set as active processor\n      state.activeProcessor = processor;\n    };\n\n    var requestProcessing = function requestProcessing() {\n      state.processingAborted = false;\n      setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n\n    var abortProcessing = function abortProcessing() {\n      return new Promise(function(resolve) {\n        if (!state.activeProcessor) {\n          state.processingAborted = true;\n\n          setStatus(ItemStatus.IDLE);\n          fire('process-abort');\n\n          resolve();\n          return;\n        }\n\n        abortProcessingRequestComplete = function abortProcessingRequestComplete() {\n          resolve();\n        };\n\n        state.activeProcessor.abort();\n      });\n    };\n\n    //\n    // logic to revert a processed file\n    //\n    var revert = function revert(revertFileUpload, forceRevert) {\n      return new Promise(function(resolve, reject) {\n        // cannot revert without a server id for this process\n        if (state.serverFileReference === null) {\n          resolve();\n          return;\n        }\n\n        // revert the upload (fire and forget)\n        revertFileUpload(\n          state.serverFileReference,\n          function() {\n            // reset file server id as now it's no available on the server\n            state.serverFileReference = null;\n            resolve();\n          },\n          function(error) {\n            // don't set error state when reverting is optional, it will always resolve\n            if (!forceRevert) {\n              resolve();\n              return;\n            }\n\n            // oh no errors\n            setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n            fire('process-revert-error');\n            reject(error);\n          }\n        );\n\n        // fire event\n        setStatus(ItemStatus.IDLE);\n        fire('process-revert');\n      });\n    };\n\n    // exposed methods\n    var _setMetadata = function setMetadata(key, value, silent) {\n      var keys = key.split('.');\n      var root = keys[0];\n      var last = keys.pop();\n      var data = metadata;\n      keys.forEach(function(key) {\n        return (data = data[key]);\n      });\n\n      // compare old value against new value, if they're the same, we're not updating\n      if (JSON.stringify(data[last]) === JSON.stringify(value)) return;\n\n      // update value\n      data[last] = value;\n\n      // don't fire update\n      if (silent) return;\n\n      // fire update\n      fire('metadata-update', {\n        key: root,\n        value: metadata[root]\n      });\n    };\n\n    var getMetadata = function getMetadata(key) {\n      return deepCloneObject(key ? metadata[key] : metadata);\n    };\n\n    var api = Object.assign(\n      {\n        id: {\n          get: function get() {\n            return id;\n          }\n        },\n        origin: {\n          get: function get() {\n            return origin;\n          }\n        },\n        serverId: {\n          get: function get() {\n            return state.serverFileReference;\n          }\n        },\n        transferId: {\n          get: function get() {\n            return state.transferId;\n          }\n        },\n        status: {\n          get: function get() {\n            return state.status;\n          }\n        },\n        filename: {\n          get: function get() {\n            return state.file.name;\n          }\n        },\n        filenameWithoutExtension: {\n          get: function get() {\n            return getFilenameWithoutExtension(state.file.name);\n          }\n        },\n        fileExtension: { get: getFileExtension },\n        fileType: { get: getFileType },\n        fileSize: { get: getFileSize },\n        file: { get: getFile },\n        relativePath: {\n          get: function get() {\n            return state.file._relativePath;\n          }\n        },\n\n        source: {\n          get: function get() {\n            return state.source;\n          }\n        },\n\n        getMetadata: getMetadata,\n        setMetadata: function setMetadata(key, value, silent) {\n          if (isObject(key)) {\n            var data = key;\n            Object.keys(data).forEach(function(key) {\n              _setMetadata(key, data[key], value);\n            });\n            return key;\n          }\n          _setMetadata(key, value, silent);\n          return value;\n        },\n\n        extend: function extend(name, handler) {\n          return (itemAPI[name] = handler);\n        },\n\n        abortLoad: abortLoad,\n        retryLoad: retryLoad,\n        requestProcessing: requestProcessing,\n        abortProcessing: abortProcessing,\n\n        load: load,\n        process: process,\n        revert: revert\n      },\n\n      on(),\n      {\n        freeze: function freeze() {\n          return (state.frozen = true);\n        },\n\n        release: function release() {\n          return (state.released = true);\n        },\n        released: {\n          get: function get() {\n            return state.released;\n          }\n        },\n\n        archive: function archive() {\n          return (state.archived = true);\n        },\n        archived: {\n          get: function get() {\n            return state.archived;\n          }\n        }\n      }\n    );\n\n    // create it here instead of returning it instantly so we can extend it later\n    var itemAPI = createObject(api);\n\n    return itemAPI;\n  };\n\n  var getItemIndexByQuery = function getItemIndexByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return 0;\n    }\n\n    // invalid queries\n    if (!isString(query)) {\n      return -1;\n    }\n\n    // return item by id (or -1 if not found)\n    return items.findIndex(function(item) {\n      return item.id === query;\n    });\n  };\n\n  var getItemById = function getItemById(items, itemId) {\n    var index = getItemIndexByQuery(items, itemId);\n    if (index < 0) {\n      return;\n    }\n    return items[index] || null;\n  };\n\n  var fetchBlob = function fetchBlob(\n    url,\n    load,\n    error,\n    progress,\n    abort,\n    headers\n  ) {\n    var request = sendRequest(null, url, {\n      method: 'GET',\n      responseType: 'blob'\n    });\n\n    request.onload = function(xhr) {\n      // get headers\n      var headers = xhr.getAllResponseHeaders();\n\n      // get filename\n      var filename =\n        getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n      // create response\n      load(\n        createResponse(\n          'load',\n          xhr.status,\n          getFileFromBlob(xhr.response, filename),\n          headers\n        )\n      );\n    };\n\n    request.onerror = function(xhr) {\n      error(\n        createResponse(\n          'error',\n          xhr.status,\n          xhr.statusText,\n          xhr.getAllResponseHeaders()\n        )\n      );\n    };\n\n    request.onheaders = function(xhr) {\n      headers(\n        createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders())\n      );\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort;\n\n    // should return request\n    return request;\n  };\n\n  var getDomainFromURL = function getDomainFromURL(url) {\n    if (url.indexOf('//') === 0) {\n      url = location.protocol + url;\n    }\n    return url\n      .toLowerCase()\n      .replace('blob:', '')\n      .replace(/([a-z])?:\\/\\//, '$1')\n      .split('/')[0];\n  };\n\n  var isExternalURL = function isExternalURL(url) {\n    return (\n      (url.indexOf(':') > -1 || url.indexOf('//') > -1) &&\n      getDomainFromURL(location.href) !== getDomainFromURL(url)\n    );\n  };\n\n  var dynamicLabel = function dynamicLabel(label) {\n    return function() {\n      return isFunction(label) ? label.apply(void 0, arguments) : label;\n    };\n  };\n\n  var isMockItem = function isMockItem(item) {\n    return !isFile(item.file);\n  };\n\n  var listUpdated = function listUpdated(dispatch, state) {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(function() {\n      dispatch('DID_UPDATE_ITEMS', { items: getActiveItems(state.items) });\n    }, 0);\n  };\n\n  var optionalPromise = function optionalPromise(fn) {\n    for (\n      var _len = arguments.length,\n        params = new Array(_len > 1 ? _len - 1 : 0),\n        _key = 1;\n      _key < _len;\n      _key++\n    ) {\n      params[_key - 1] = arguments[_key];\n    }\n    return new Promise(function(resolve) {\n      if (!fn) {\n        return resolve(true);\n      }\n\n      var result = fn.apply(void 0, params);\n\n      if (result == null) {\n        return resolve(true);\n      }\n\n      if (typeof result === 'boolean') {\n        return resolve(result);\n      }\n\n      if (typeof result.then === 'function') {\n        result.then(resolve);\n      }\n    });\n  };\n\n  var sortItems = function sortItems(state, compare) {\n    state.items.sort(function(a, b) {\n      return compare(createItemAPI(a), createItemAPI(b));\n    });\n  };\n\n  // returns item based on state\n  var getItemByQueryFromState = function getItemByQueryFromState(\n    state,\n    itemHandler\n  ) {\n    return function() {\n      var _ref =\n        arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var query = _ref.query,\n        _ref$success = _ref.success,\n        success = _ref$success === void 0 ? function() {} : _ref$success,\n        _ref$failure = _ref.failure,\n        failure = _ref$failure === void 0 ? function() {} : _ref$failure,\n        options = _objectWithoutProperties(_ref, [\n          'query',\n          'success',\n          'failure'\n        ]);\n      var item = getItemByQuery(state.items, query);\n      if (!item) {\n        failure({\n          error: createResponse('error', 0, 'Item not found'),\n\n          file: null\n        });\n\n        return;\n      }\n      itemHandler(item, success, failure, options || {});\n    };\n  };\n\n  var actions = function actions(dispatch, query, state) {\n    return {\n      /**\n       * Aborts all ongoing processes\n       */\n      ABORT_ALL: function ABORT_ALL() {\n        getActiveItems(state.items).forEach(function(item) {\n          item.freeze();\n          item.abortLoad();\n          item.abortProcessing();\n        });\n      },\n\n      /**\n       * Sets initial files\n       */\n      DID_SET_FILES: function DID_SET_FILES(_ref2) {\n        var _ref2$value = _ref2.value,\n          value = _ref2$value === void 0 ? [] : _ref2$value;\n\n        // map values to file objects\n        var files = value.map(function(file) {\n          return {\n            source: file.source ? file.source : file,\n            options: file.options\n          };\n        });\n\n        // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n        var activeItems = getActiveItems(state.items);\n\n        activeItems.forEach(function(item) {\n          // if item not is in new value, remove\n          if (\n            !files.find(function(file) {\n              return file.source === item.source || file.source === item.file;\n            })\n          ) {\n            dispatch('REMOVE_ITEM', { query: item, remove: false });\n          }\n        });\n\n        // add new files\n        activeItems = getActiveItems(state.items);\n        files.forEach(function(file, index) {\n          // if file is already in list\n          if (\n            activeItems.find(function(item) {\n              return item.source === file.source || item.file === file.source;\n            })\n          )\n            return;\n\n          // not in list, add\n          dispatch(\n            'ADD_ITEM',\n            Object.assign({}, file, {\n              interactionMethod: InteractionMethod.NONE,\n              index: index\n            })\n          );\n        });\n      },\n\n      DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {\n        var id = _ref3.id,\n          action = _ref3.action;\n\n        // if is called multiple times in close succession we combined all calls together to save resources\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(function() {\n          var item = getItemById(state.items, id);\n\n          // only revert and attempt to upload when we're uploading to a server\n          if (!query('IS_ASYNC')) {\n            // should we update the output data\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query,\n              action: action\n            }).then(function(shouldPrepareOutput) {\n              // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n              var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n              if (beforePrepareFile)\n                shouldPrepareOutput = beforePrepareFile(\n                  item,\n                  shouldPrepareOutput\n                );\n\n              if (!shouldPrepareOutput) return;\n\n              dispatch(\n                'REQUEST_PREPARE_OUTPUT',\n                {\n                  query: id,\n                  item: item,\n                  success: function success(file) {\n                    dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });\n                  }\n                },\n                true\n              );\n            });\n\n            return;\n          }\n\n          // for async scenarios\n          var upload = function upload() {\n            // we push this forward a bit so the interface is updated correctly\n            setTimeout(function() {\n              dispatch('REQUEST_ITEM_PROCESSING', { query: id });\n            }, 32);\n          };\n\n          var revert = function revert(doUpload) {\n            item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                query('GET_FORCE_REVERT')\n              )\n              .then(doUpload ? upload : function() {})\n              .catch(function() {});\n          };\n\n          var abort = function abort(doUpload) {\n            item.abortProcessing().then(doUpload ? upload : function() {});\n          };\n\n          // if we should re-upload the file immediately\n          if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n            return revert(state.options.instantUpload);\n          }\n\n          // if currently uploading, cancel upload\n          if (item.status === ItemStatus.PROCESSING) {\n            return abort(state.options.instantUpload);\n          }\n\n          if (state.options.instantUpload) {\n            upload();\n          }\n        }, 0);\n      },\n\n      MOVE_ITEM: function MOVE_ITEM(_ref4) {\n        var query = _ref4.query,\n          index = _ref4.index;\n        var item = getItemByQuery(state.items, query);\n        if (!item) return;\n        var currentIndex = state.items.indexOf(item);\n        index = limit(index, 0, state.items.length - 1);\n        if (currentIndex === index) return;\n        state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\n      },\n\n      SORT: function SORT(_ref5) {\n        var compare = _ref5.compare;\n        sortItems(state, compare);\n        dispatch('DID_SORT_ITEMS', {\n          items: query('GET_ACTIVE_ITEMS')\n        });\n      },\n\n      ADD_ITEMS: function ADD_ITEMS(_ref6) {\n        var items = _ref6.items,\n          index = _ref6.index,\n          interactionMethod = _ref6.interactionMethod,\n          _ref6$success = _ref6.success,\n          success = _ref6$success === void 0 ? function() {} : _ref6$success,\n          _ref6$failure = _ref6.failure,\n          failure = _ref6$failure === void 0 ? function() {} : _ref6$failure;\n\n        var currentIndex = index;\n\n        if (index === -1 || typeof index === 'undefined') {\n          var insertLocation = query('GET_ITEM_INSERT_LOCATION');\n          var totalItems = query('GET_TOTAL_ITEMS');\n          currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n\n        var ignoredFiles = query('GET_IGNORED_FILES');\n        var isValidFile = function isValidFile(source) {\n          return isFile(source)\n            ? !ignoredFiles.includes(source.name.toLowerCase())\n            : !isEmpty(source);\n        };\n        var validItems = items.filter(isValidFile);\n\n        var promises = validItems.map(function(source) {\n          return new Promise(function(resolve, reject) {\n            dispatch('ADD_ITEM', {\n              interactionMethod: interactionMethod,\n              source: source.source || source,\n              success: resolve,\n              failure: reject,\n              index: currentIndex++,\n              options: source.options || {}\n            });\n          });\n        });\n\n        Promise.all(promises)\n          .then(success)\n          .catch(failure);\n      },\n\n      /**\n       * @param source\n       * @param index\n       * @param interactionMethod\n       */\n      ADD_ITEM: function ADD_ITEM(_ref7) {\n        var source = _ref7.source,\n          _ref7$index = _ref7.index,\n          index = _ref7$index === void 0 ? -1 : _ref7$index,\n          interactionMethod = _ref7.interactionMethod,\n          _ref7$success = _ref7.success,\n          success = _ref7$success === void 0 ? function() {} : _ref7$success,\n          _ref7$failure = _ref7.failure,\n          failure = _ref7$failure === void 0 ? function() {} : _ref7$failure,\n          _ref7$options = _ref7.options,\n          options = _ref7$options === void 0 ? {} : _ref7$options;\n\n        // if no source supplied\n        if (isEmpty(source)) {\n          failure({\n            error: createResponse('error', 0, 'No source'),\n\n            file: null\n          });\n\n          return;\n        }\n\n        // filter out invalid file items, used to filter dropped directory contents\n        if (\n          isFile(source) &&\n          state.options.ignoredFiles.includes(source.name.toLowerCase())\n        ) {\n          // fail silently\n          return;\n        }\n\n        // test if there's still room in the list of files\n        if (!hasRoomForItem(state)) {\n          // if multiple allowed, we can't replace\n          // or if only a single item is allowed but we're not allowed to replace it we exit\n          if (\n            state.options.allowMultiple ||\n            (!state.options.allowMultiple && !state.options.allowReplace)\n          ) {\n            var error = createResponse('warning', 0, 'Max files');\n\n            dispatch('DID_THROW_MAX_FILES', {\n              source: source,\n              error: error\n            });\n\n            failure({ error: error, file: null });\n\n            return;\n          }\n\n          // let's replace the item\n          // id of first item we're about to remove\n          var _item = getActiveItems(state.items)[0];\n\n          // if has been processed remove it from the server as well\n          if (\n            _item.status === ItemStatus.PROCESSING_COMPLETE ||\n            _item.status === ItemStatus.PROCESSING_REVERT_ERROR\n          ) {\n            var forceRevert = query('GET_FORCE_REVERT');\n            _item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                forceRevert\n              )\n              .then(function() {\n                if (!forceRevert) return;\n\n                // try to add now\n                dispatch('ADD_ITEM', {\n                  source: source,\n                  index: index,\n                  interactionMethod: interactionMethod,\n                  success: success,\n                  failure: failure,\n                  options: options\n                });\n              })\n              .catch(function() {}); // no need to handle this catch state for now\n\n            if (forceRevert) return;\n          }\n\n          // remove first item as it will be replaced by this item\n          dispatch('REMOVE_ITEM', { query: _item.id });\n        }\n\n        // where did the file originate\n        var origin =\n          options.type === 'local'\n            ? FileOrigin.LOCAL\n            : options.type === 'limbo'\n            ? FileOrigin.LIMBO\n            : FileOrigin.INPUT;\n\n        // create a new blank item\n        var item = createItem(\n          // where did this file come from\n          origin,\n\n          // an input file never has a server file reference\n          origin === FileOrigin.INPUT ? null : source,\n\n          // file mock data, if defined\n          options.file\n        );\n\n        // set initial meta data\n        Object.keys(options.metadata || {}).forEach(function(key) {\n          item.setMetadata(key, options.metadata[key]);\n        });\n\n        // created the item, let plugins add methods\n        applyFilters('DID_CREATE_ITEM', item, {\n          query: query,\n          dispatch: dispatch\n        });\n\n        // where to insert new items\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        // adjust index if is not allowed to pick location\n        if (!state.options.itemInsertLocationFreedom) {\n          index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        }\n\n        // add item to list\n        insertItem(state.items, item, index);\n\n        // sort items in list\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        }\n\n        // get a quick reference to the item id\n        var id = item.id;\n\n        // observe item events\n        item.on('init', function() {\n          dispatch('DID_INIT_ITEM', { id: id });\n        });\n\n        item.on('load-init', function() {\n          dispatch('DID_START_ITEM_LOAD', { id: id });\n        });\n\n        item.on('load-meta', function() {\n          dispatch('DID_UPDATE_ITEM_META', { id: id });\n        });\n\n        item.on('load-progress', function(progress) {\n          dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n\n        item.on('load-request-error', function(error) {\n          var mainStatus = dynamicLabel(state.options.labelFileLoadError)(\n            error\n          );\n\n          // is client error, no way to recover\n          if (error.code >= 400 && error.code < 500) {\n            dispatch('DID_THROW_ITEM_INVALID', {\n              id: id,\n              error: error,\n              status: {\n                main: mainStatus,\n                sub: error.code + ' (' + error.body + ')'\n              }\n            });\n\n            // reject the file so can be dealt with through API\n            failure({ error: error, file: createItemAPI(item) });\n            return;\n          }\n\n          // is possible server error, so might be possible to retry\n          dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: mainStatus,\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('load-file-error', function(error) {\n          dispatch('DID_THROW_ITEM_INVALID', {\n            id: id,\n            error: error.status,\n            status: error.status\n          });\n\n          failure({ error: error.status, file: createItemAPI(item) });\n        });\n\n        item.on('load-abort', function() {\n          dispatch('REMOVE_ITEM', { query: id });\n        });\n\n        item.on('load-skip', function() {\n          dispatch('COMPLETE_LOAD_ITEM', {\n            query: id,\n            item: item,\n            data: {\n              source: source,\n              success: success\n            }\n          });\n        });\n\n        item.on('load', function() {\n          var handleAdd = function handleAdd(shouldAdd) {\n            // no should not add this file\n            if (!shouldAdd) {\n              dispatch('REMOVE_ITEM', {\n                query: id\n              });\n\n              return;\n            }\n\n            // now interested in metadata updates\n            item.on('metadata-update', function(change) {\n              dispatch('DID_UPDATE_ITEM_METADATA', { id: id, change: change });\n            });\n\n            // let plugins decide if the output data should be prepared at this point\n            // means we'll do this and wait for idle state\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function(shouldPrepareOutput) {\n              // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n              var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n              if (beforePrepareFile)\n                shouldPrepareOutput = beforePrepareFile(\n                  item,\n                  shouldPrepareOutput\n                );\n\n              var loadComplete = function loadComplete() {\n                dispatch('COMPLETE_LOAD_ITEM', {\n                  query: id,\n                  item: item,\n                  data: {\n                    source: source,\n                    success: success\n                  }\n                });\n\n                listUpdated(dispatch, state);\n              };\n\n              // exit\n              if (shouldPrepareOutput) {\n                // wait for idle state and then run PREPARE_OUTPUT\n                dispatch(\n                  'REQUEST_PREPARE_OUTPUT',\n                  {\n                    query: id,\n                    item: item,\n                    success: function success(file) {\n                      dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });\n                      loadComplete();\n                    }\n                  },\n                  true\n                );\n\n                return;\n              }\n\n              loadComplete();\n            });\n          };\n\n          // item loaded, allow plugins to\n          // - read data (quickly)\n          // - add metadata\n          applyFilterChain('DID_LOAD_ITEM', item, {\n            query: query,\n            dispatch: dispatch\n          })\n            .then(function() {\n              optionalPromise(\n                query('GET_BEFORE_ADD_FILE'),\n                createItemAPI(item)\n              ).then(handleAdd);\n            })\n            .catch(function() {\n              handleAdd(false);\n            });\n        });\n\n        item.on('process-start', function() {\n          dispatch('DID_START_ITEM_PROCESSING', { id: id });\n        });\n\n        item.on('process-progress', function(progress) {\n          dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n\n        item.on('process-error', function(error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('process-revert-error', function(error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingRevertError)(\n                error\n              ),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('process-complete', function(serverFileReference) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: id,\n            error: null,\n            serverFileReference: serverFileReference\n          });\n\n          dispatch('DID_DEFINE_VALUE', { id: id, value: serverFileReference });\n        });\n\n        item.on('process-abort', function() {\n          dispatch('DID_ABORT_ITEM_PROCESSING', { id: id });\n        });\n\n        item.on('process-revert', function() {\n          dispatch('DID_REVERT_ITEM_PROCESSING', { id: id });\n          dispatch('DID_DEFINE_VALUE', { id: id, value: null });\n        });\n\n        // let view know the item has been inserted\n        dispatch('DID_ADD_ITEM', {\n          id: id,\n          index: index,\n          interactionMethod: interactionMethod\n        });\n\n        listUpdated(dispatch, state);\n\n        // start loading the source\n        var _ref8 = state.options.server || {},\n          url = _ref8.url,\n          load = _ref8.load,\n          restore = _ref8.restore,\n          fetch = _ref8.fetch;\n\n        item.load(\n          source,\n\n          // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n          createFileLoader(\n            origin === FileOrigin.INPUT\n              ? // input, if is remote, see if should use custom fetch, else use default fetchBlob\n                isString(source) && isExternalURL(source)\n                ? fetch\n                  ? createFetchFunction(url, fetch)\n                  : fetchBlob // remote url\n                : fetchBlob // try to fetch url\n              : // limbo or local\n              origin === FileOrigin.LIMBO\n              ? createFetchFunction(url, restore) // limbo\n              : createFetchFunction(url, load) // local\n          ),\n\n          // called when the file is loaded so it can be piped through the filters\n          function(file, success, error) {\n            // let's process the file\n            applyFilterChain('LOAD_FILE', file, { query: query })\n              .then(success)\n              .catch(error);\n          }\n        );\n      },\n\n      REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref9) {\n        var item = _ref9.item,\n          success = _ref9.success,\n          _ref9$failure = _ref9.failure,\n          failure = _ref9$failure === void 0 ? function() {} : _ref9$failure;\n\n        // error response if item archived\n        var err = {\n          error: createResponse('error', 0, 'Item not found'),\n\n          file: null\n        };\n\n        // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n        if (item.archived) return failure(err);\n\n        // allow plugins to alter the file data\n        applyFilterChain('PREPARE_OUTPUT', item.file, {\n          query: query,\n          item: item\n        }).then(function(result) {\n          applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {\n            query: query,\n            item: item\n          }).then(function(result) {\n            // don't handle archived items, an item could have been archived (load aborted) while being prepared\n            if (item.archived) return failure(err);\n\n            // we done!\n            success(result);\n          });\n        });\n      },\n\n      COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref10) {\n        var item = _ref10.item,\n          data = _ref10.data;\n        var success = data.success,\n          source = data.source;\n\n        // sort items in list\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        }\n\n        // let interface know the item has loaded\n        dispatch('DID_LOAD_ITEM', {\n          id: item.id,\n          error: null,\n          serverFileReference: item.origin === FileOrigin.INPUT ? null : source\n        });\n\n        // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n        success(createItemAPI(item));\n\n        // if this is a local server file we need to show a different state\n        if (item.origin === FileOrigin.LOCAL) {\n          dispatch('DID_LOAD_LOCAL_ITEM', { id: item.id });\n          return;\n        }\n\n        // if is a temp server file we prevent async upload call here (as the file is already on the server)\n        if (item.origin === FileOrigin.LIMBO) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: item.id,\n            error: null,\n            serverFileReference: source\n          });\n\n          dispatch('DID_DEFINE_VALUE', {\n            id: item.id,\n            value: source\n          });\n\n          return;\n        }\n\n        // id we are allowed to upload the file immediately, lets do it\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n          dispatch('REQUEST_ITEM_PROCESSING', { query: item.id });\n        }\n      },\n\n      RETRY_ITEM_LOAD: getItemByQueryFromState(state, function(item) {\n        // try loading the source one more time\n        item.retryLoad();\n      }),\n\n      REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, function(\n        item,\n        _success,\n        failure\n      ) {\n        dispatch(\n          'REQUEST_PREPARE_OUTPUT',\n          {\n            query: item.id,\n            item: item,\n            success: function success(file) {\n              dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });\n              _success({\n                file: item,\n                output: file\n              });\n            },\n            failure: failure\n          },\n          true\n        );\n      }),\n\n      REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function(\n        item,\n        success,\n        failure\n      ) {\n        // cannot be queued (or is already queued)\n        var itemCanBeQueuedForProcessing =\n          // waiting for something\n          item.status === ItemStatus.IDLE ||\n          // processing went wrong earlier\n          item.status === ItemStatus.PROCESSING_ERROR;\n\n        // not ready to be processed\n        if (!itemCanBeQueuedForProcessing) {\n          var processNow = function processNow() {\n            return dispatch('REQUEST_ITEM_PROCESSING', {\n              query: item,\n              success: success,\n              failure: failure\n            });\n          };\n\n          var process = function process() {\n            return document.hidden ? processNow() : setTimeout(processNow, 32);\n          };\n\n          // if already done processing or tried to revert but didn't work, try again\n          if (\n            item.status === ItemStatus.PROCESSING_COMPLETE ||\n            item.status === ItemStatus.PROCESSING_REVERT_ERROR\n          ) {\n            item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                query('GET_FORCE_REVERT')\n              )\n              .then(process)\n              .catch(function() {}); // don't continue with processing if something went wrong\n          } else if (item.status === ItemStatus.PROCESSING) {\n            item.abortProcessing().then(process);\n          }\n\n          return;\n        }\n\n        // already queued for processing\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n\n        item.requestProcessing();\n\n        dispatch('DID_REQUEST_ITEM_PROCESSING', { id: item.id });\n\n        dispatch(\n          'PROCESS_ITEM',\n          { query: item, success: success, failure: failure },\n          true\n        );\n      }),\n\n      PROCESS_ITEM: getItemByQueryFromState(state, function(\n        item,\n        success,\n        failure\n      ) {\n        var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        var totalCurrentUploads = query(\n          'GET_ITEMS_BY_STATUS',\n          ItemStatus.PROCESSING\n        ).length;\n\n        // queue and wait till queue is freed up\n        if (totalCurrentUploads === maxParallelUploads) {\n          // queue for later processing\n          state.processingQueue.push({\n            id: item.id,\n            success: success,\n            failure: failure\n          });\n\n          // stop it!\n          return;\n        }\n\n        // if was not queued or is already processing exit here\n        if (item.status === ItemStatus.PROCESSING) return;\n\n        var processNext = function processNext() {\n          // process queueud items\n          var queueEntry = state.processingQueue.shift();\n\n          // no items left\n          if (!queueEntry) return;\n\n          // get item reference\n          var id = queueEntry.id,\n            success = queueEntry.success,\n            failure = queueEntry.failure;\n          var itemReference = getItemByQuery(state.items, id);\n\n          // if item was archived while in queue, jump to next\n          if (!itemReference || itemReference.archived) {\n            processNext();\n            return;\n          }\n\n          // process queued item\n          dispatch(\n            'PROCESS_ITEM',\n            { query: id, success: success, failure: failure },\n            true\n          );\n        };\n\n        // we done function\n        item.onOnce('process-complete', function() {\n          success(createItemAPI(item));\n          processNext();\n\n          // All items processed? No errors?\n          var allItemsProcessed =\n            query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE)\n              .length === state.items.length;\n          if (allItemsProcessed) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n          }\n        });\n\n        // we error function\n        item.onOnce('process-error', function(error) {\n          failure({ error: error, file: createItemAPI(item) });\n          processNext();\n        });\n\n        // start file processing\n        var options = state.options;\n        item.process(\n          createFileProcessor(\n            createProcessorFunction(\n              options.server.url,\n              options.server.process,\n              options.name,\n              {\n                chunkTransferId: item.transferId,\n                chunkServer: options.server.patch,\n                chunkUploads: options.chunkUploads,\n                chunkForce: options.chunkForce,\n                chunkSize: options.chunkSize,\n                chunkRetryDelays: options.chunkRetryDelays\n              }\n            )\n          ),\n\n          // called when the file is about to be processed so it can be piped through the transform filters\n          function(file, success, error) {\n            // allow plugins to alter the file data\n            applyFilterChain('PREPARE_OUTPUT', file, {\n              query: query,\n              item: item\n            })\n              .then(function(file) {\n                dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });\n\n                success(file);\n              })\n              .catch(error);\n          }\n        );\n      }),\n\n      RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        dispatch('REQUEST_ITEM_PROCESSING', { query: item });\n      }),\n\n      REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function(item) {\n        optionalPromise(\n          query('GET_BEFORE_REMOVE_FILE'),\n          createItemAPI(item)\n        ).then(function(shouldRemove) {\n          if (!shouldRemove) {\n            return;\n          }\n          dispatch('REMOVE_ITEM', { query: item });\n        });\n      }),\n\n      RELEASE_ITEM: getItemByQueryFromState(state, function(item) {\n        item.release();\n      }),\n\n      REMOVE_ITEM: getItemByQueryFromState(state, function(\n        item,\n        success,\n        failure,\n        options\n      ) {\n        var removeFromView = function removeFromView() {\n          // get id reference\n          var id = item.id;\n\n          // archive the item, this does not remove it from the list\n          getItemById(state.items, id).archive();\n\n          // tell the view the item has been removed\n          dispatch('DID_REMOVE_ITEM', { error: null, id: id, item: item });\n\n          // now the list has been modified\n          listUpdated(dispatch, state);\n\n          // correctly removed\n          success(createItemAPI(item));\n        };\n\n        // if this is a local file and the server.remove function has been configured, send source there so dev can remove file from server\n        var server = state.options.server;\n        if (\n          item.origin === FileOrigin.LOCAL &&\n          server &&\n          isFunction(server.remove) &&\n          options.remove !== false\n        ) {\n          dispatch('DID_START_ITEM_REMOVE', { id: item.id });\n\n          server.remove(\n            item.source,\n            function() {\n              return removeFromView();\n            },\n            function(status) {\n              dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n                id: item.id,\n                error: createResponse('error', 0, status, null),\n                status: {\n                  main: dynamicLabel(state.options.labelFileRemoveError)(\n                    status\n                  ),\n                  sub: state.options.labelTapToRetry\n                }\n              });\n            }\n          );\n        } else {\n          // if is requesting revert and can revert need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\n          if (\n            options.revert &&\n            item.origin !== FileOrigin.LOCAL &&\n            item.serverId !== null\n          ) {\n            item.revert(\n              createRevertFunction(\n                state.options.server.url,\n                state.options.server.revert\n              ),\n              query('GET_FORCE_REVERT')\n            );\n          }\n\n          // can now safely remove from view\n          removeFromView();\n        }\n      }),\n\n      ABORT_ITEM_LOAD: getItemByQueryFromState(state, function(item) {\n        item.abortLoad();\n      }),\n\n      ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        // test if is already processed\n        if (item.serverId) {\n          dispatch('REVERT_ITEM_PROCESSING', { id: item.id });\n          return;\n        }\n\n        // abort\n        item.abortProcessing().then(function() {\n          var shouldRemove = state.options.instantUpload;\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', { query: item.id });\n          }\n        });\n      }),\n\n      REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(\n        item\n      ) {\n        // not instant uploading, revert immediately\n        if (!state.options.instantUpload) {\n          dispatch('REVERT_ITEM_PROCESSING', { query: item });\n          return;\n        }\n\n        // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n        var handleRevert = function handleRevert(shouldRevert) {\n          if (!shouldRevert) return;\n          dispatch('REVERT_ITEM_PROCESSING', { query: item });\n        };\n\n        var fn = query('GET_BEFORE_REMOVE_FILE');\n        if (!fn) {\n          return handleRevert(true);\n        }\n\n        var requestRemoveResult = fn(createItemAPI(item));\n        if (requestRemoveResult == null) {\n          // undefined or null\n          return handleRevert(true);\n        }\n\n        if (typeof requestRemoveResult === 'boolean') {\n          return handleRevert(requestRemoveResult);\n        }\n\n        if (typeof requestRemoveResult.then === 'function') {\n          requestRemoveResult.then(handleRevert);\n        }\n      }),\n\n      REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        item\n          .revert(\n            createRevertFunction(\n              state.options.server.url,\n              state.options.server.revert\n            ),\n            query('GET_FORCE_REVERT')\n          )\n          .then(function() {\n            var shouldRemove = state.options.instantUpload || isMockItem(item);\n            if (shouldRemove) {\n              dispatch('REMOVE_ITEM', { query: item.id });\n            }\n          })\n          .catch(function() {});\n      }),\n\n      SET_OPTIONS: function SET_OPTIONS(_ref11) {\n        var options = _ref11.options;\n        forin(options, function(key, value) {\n          dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        });\n      }\n    };\n  };\n\n  var formatFilename = function formatFilename(name) {\n    return name;\n  };\n\n  var createElement$1 = function createElement(tagName) {\n    return document.createElement(tagName);\n  };\n\n  var text = function text(node, value) {\n    var textNode = node.childNodes[0];\n    if (!textNode) {\n      textNode = document.createTextNode(value);\n      node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n      textNode.nodeValue = value;\n    }\n  };\n\n  var polarToCartesian = function polarToCartesian(\n    centerX,\n    centerY,\n    radius,\n    angleInDegrees\n  ) {\n    var angleInRadians = (((angleInDegrees % 360) - 90) * Math.PI) / 180.0;\n    return {\n      x: centerX + radius * Math.cos(angleInRadians),\n      y: centerY + radius * Math.sin(angleInRadians)\n    };\n  };\n\n  var describeArc = function describeArc(\n    x,\n    y,\n    radius,\n    startAngle,\n    endAngle,\n    arcSweep\n  ) {\n    var start = polarToCartesian(x, y, radius, endAngle);\n    var end = polarToCartesian(x, y, radius, startAngle);\n    return [\n      'M',\n      start.x,\n      start.y,\n      'A',\n      radius,\n      radius,\n      0,\n      arcSweep,\n      0,\n      end.x,\n      end.y\n    ].join(' ');\n  };\n\n  var percentageArc = function percentageArc(x, y, radius, from, to) {\n    var arcSweep = 1;\n    if (to > from && to - from <= 0.5) {\n      arcSweep = 0;\n    }\n    if (from > to && from - to >= 0.5) {\n      arcSweep = 0;\n    }\n    return describeArc(\n      x,\n      y,\n      radius,\n      Math.min(0.9999, from) * 360,\n      Math.min(0.9999, to) * 360,\n      arcSweep\n    );\n  };\n\n  var create = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // start at 0\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0;\n\n    // svg\n    var svg = createElement('svg');\n    root.ref.path = createElement('path', {\n      'stroke-width': 2,\n      'stroke-linecap': 'round'\n    });\n\n    svg.appendChild(root.ref.path);\n\n    root.ref.svg = svg;\n\n    root.appendChild(svg);\n  };\n\n  var write = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n\n    if (props.opacity === 0) {\n      return;\n    }\n\n    if (props.align) {\n      root.element.dataset.align = props.align;\n    }\n\n    // get width of stroke\n    var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);\n\n    // calculate size of ring\n    var size = root.rect.element.width * 0.5;\n\n    // ring state\n    var ringFrom = 0;\n    var ringTo = 0;\n\n    // now in busy mode\n    if (props.spin) {\n      ringFrom = 0;\n      ringTo = 0.5;\n    } else {\n      ringFrom = 0;\n      ringTo = props.progress;\n    }\n\n    // get arc path\n    var coordinates = percentageArc(\n      size,\n      size,\n      size - ringStrokeWidth,\n      ringFrom,\n      ringTo\n    );\n\n    // update progress bar\n    attr(root.ref.path, 'd', coordinates);\n\n    // hide while contains 0 value\n    attr(\n      root.ref.path,\n      'stroke-opacity',\n      props.spin || props.progress > 0 ? 1 : 0\n    );\n  };\n\n  var progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create: create,\n    write: write,\n    mixins: {\n      apis: ['progress', 'spin', 'align'],\n      styles: ['opacity'],\n      animations: {\n        opacity: { type: 'tween', duration: 500 },\n        progress: {\n          type: 'spring',\n          stiffness: 0.95,\n          damping: 0.65,\n          mass: 10\n        }\n      }\n    }\n  });\n\n  var create$1 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.element.innerHTML =\n      (props.icon || '') + ('<span>' + props.label + '</span>');\n\n    props.isDisabled = false;\n  };\n\n  var write$1 = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    var isDisabled = props.isDisabled;\n    var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n    if (shouldDisable && !isDisabled) {\n      props.isDisabled = true;\n      attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n      props.isDisabled = false;\n      root.element.removeAttribute('disabled');\n    }\n  };\n\n  var fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n      type: 'button'\n    },\n\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n      apis: ['label'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      },\n\n      listeners: true\n    },\n\n    create: create$1,\n    write: write$1\n  });\n\n  var toNaturalFileSize = function toNaturalFileSize(bytes) {\n    var decimalSeparator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.';\n    var base =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1000;\n    // no negative byte sizes\n    bytes = Math.round(Math.abs(bytes));\n\n    var KB = base;\n    var MB = base * base;\n    var GB = base * base * base;\n\n    // just bytes\n    if (bytes < KB) {\n      return bytes + ' bytes';\n    }\n\n    // kilobytes\n    if (bytes < MB) {\n      return Math.floor(bytes / KB) + ' KB';\n    }\n\n    // megabytes\n    if (bytes < GB) {\n      return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' MB';\n    }\n\n    // gigabytes\n    return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' GB';\n  };\n\n  var removeDecimalsWhenZero = function removeDecimalsWhenZero(\n    value,\n    decimalCount,\n    separator\n  ) {\n    return value\n      .toFixed(decimalCount)\n      .split('.')\n      .filter(function(part) {\n        return part !== '0';\n      })\n      .join(separator);\n  };\n\n  var create$2 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // filename\n    var fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main';\n    // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName;\n\n    // filesize\n    var fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize;\n\n    // set initial values\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFile = function updateFile(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    text(\n      root.ref.fileSize,\n      toNaturalFileSize(\n        root.query('GET_ITEM_SIZE', props.id),\n        '.',\n        root.query('GET_FILE_SIZE_BASE')\n      )\n    );\n\n    text(\n      root.ref.fileName,\n      formatFilename(root.query('GET_ITEM_NAME', props.id))\n    );\n  };\n\n  var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {\n    var root = _ref3.root,\n      props = _ref3.props;\n    // if size is available don't fallback to unknown size message\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n      return;\n    }\n\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n  };\n\n  var fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: updateFile,\n      DID_UPDATE_ITEM_META: updateFile,\n      DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n      DID_THROW_ITEM_INVALID: updateFileSizeOnError\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    create: create$2,\n    mixins: {\n      styles: ['translateX', 'translateY'],\n      animations: {\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var toPercentage = function toPercentage(value) {\n    return Math.round(value * 100);\n  };\n\n  var create$3 = function create(_ref) {\n    var root = _ref.root;\n\n    // main status\n    var main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main;\n\n    // sub status\n    var sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n\n    didSetItemLoadProgress({ root: root, action: { progress: null } });\n  };\n\n  var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    var title =\n      action.progress === null\n        ? root.query('GET_LABEL_FILE_LOADING')\n        : root.query('GET_LABEL_FILE_LOADING') +\n          ' ' +\n          toPercentage(action.progress) +\n          '%';\n\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var title =\n      action.progress === null\n        ? root.query('GET_LABEL_FILE_PROCESSING')\n        : root.query('GET_LABEL_FILE_PROCESSING') +\n          ' ' +\n          toPercentage(action.progress) +\n          '%';\n\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {\n    var root = _ref4.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {\n    var root = _ref5.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n  };\n\n  var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {\n    var root = _ref6.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n  };\n\n  var clear = function clear(_ref7) {\n    var root = _ref7.root;\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n  };\n\n  var error = function error(_ref8) {\n    var root = _ref8.root,\n      action = _ref8.action;\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n  };\n\n  var fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: clear,\n      DID_REVERT_ITEM_PROCESSING: clear,\n      DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n      DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n      DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n      DID_THROW_ITEM_LOAD_ERROR: error,\n      DID_THROW_ITEM_INVALID: error,\n      DID_THROW_ITEM_PROCESSING_ERROR: error,\n      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n      DID_THROW_ITEM_REMOVE_ERROR: error\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    create: create$3,\n    mixins: {\n      styles: ['translateX', 'translateY', 'opacity'],\n      animations: {\n        opacity: { type: 'tween', duration: 250 },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  /**\n   * Button definitions for the file view\n   */\n\n  var Buttons = {\n    AbortItemLoad: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n      action: 'ABORT_ITEM_LOAD',\n      className: 'filepond--action-abort-item-load',\n      align: 'LOAD_INDICATOR_POSITION' // right\n    },\n    RetryItemLoad: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n      action: 'RETRY_ITEM_LOAD',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-load',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RemoveItem: {\n      label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n      action: 'REQUEST_REMOVE_ITEM',\n      icon: 'GET_ICON_REMOVE',\n      className: 'filepond--action-remove-item',\n      align: 'BUTTON_REMOVE_ITEM_POSITION' // left\n    },\n    ProcessItem: {\n      label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n      action: 'REQUEST_ITEM_PROCESSING',\n      icon: 'GET_ICON_PROCESS',\n      className: 'filepond--action-process-item',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    AbortItemProcessing: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n      action: 'ABORT_ITEM_PROCESSING',\n      className: 'filepond--action-abort-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RetryItemProcessing: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n      action: 'RETRY_ITEM_PROCESSING',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RevertItemProcessing: {\n      label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n      action: 'REQUEST_REVERT_ITEM_PROCESSING',\n      icon: 'GET_ICON_UNDO',\n      className: 'filepond--action-revert-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    }\n  };\n\n  // make a list of buttons, we can then remove buttons from this list if they're disabled\n  var ButtonKeys = [];\n  forin(Buttons, function(key) {\n    ButtonKeys.push(key);\n  });\n\n  var calculateFileInfoOffset = function calculateFileInfoOffset(root) {\n    var buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n  };\n\n  var calculateButtonWidth = function calculateButtonWidth(root) {\n    var buttonRect = root.ref.buttonAbortItemLoad.rect.element;\n    return buttonRect.width;\n  };\n\n  // Force on full pixels so text stays crips\n  var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(\n    root\n  ) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\n  };\n  var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(\n    root\n  ) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n  };\n\n  var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {\n    return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\n  };\n  var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(\n    root\n  ) {\n    return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\n  };\n  var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {\n    return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n  };\n\n  var DefaultStyle = {\n    buttonAbortItemLoad: { opacity: 0 },\n    buttonRetryItemLoad: { opacity: 0 },\n    buttonRemoveItem: { opacity: 0 },\n    buttonProcessItem: { opacity: 0 },\n    buttonAbortItemProcessing: { opacity: 0 },\n    buttonRetryItemProcessing: { opacity: 0 },\n    buttonRevertItemProcessing: { opacity: 0 },\n    loadProgressIndicator: { opacity: 0, align: getLoadIndicatorAlignment },\n    processProgressIndicator: {\n      opacity: 0,\n      align: getProcessIndicatorAlignment\n    },\n    processingCompleteIndicator: { opacity: 0, scaleX: 0.75, scaleY: 0.75 },\n    info: { translateX: 0, translateY: 0, opacity: 0 },\n    status: { translateX: 0, translateY: 0, opacity: 0 }\n  };\n\n  var IdleStyle = {\n    buttonRemoveItem: { opacity: 1 },\n    buttonProcessItem: { opacity: 1 },\n    info: { translateX: calculateFileInfoOffset },\n    status: { translateX: calculateFileInfoOffset }\n  };\n\n  var ProcessingStyle = {\n    buttonAbortItemProcessing: { opacity: 1 },\n    processProgressIndicator: { opacity: 1 },\n    status: { opacity: 1 }\n  };\n\n  var StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { translateX: calculateFileInfoOffset, opacity: 1 }\n    },\n\n    DID_START_ITEM_LOAD: {\n      buttonAbortItemLoad: { opacity: 1 },\n      loadProgressIndicator: { opacity: 1 },\n      status: { opacity: 1 }\n    },\n\n    DID_THROW_ITEM_LOAD_ERROR: {\n      buttonRetryItemLoad: { opacity: 1 },\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1 }\n    },\n\n    DID_START_ITEM_REMOVE: {\n      processProgressIndicator: {\n        opacity: 1,\n        align: getRemoveIndicatorAligment\n      },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 0 }\n    },\n\n    DID_THROW_ITEM_REMOVE_ERROR: {\n      processProgressIndicator: {\n        opacity: 0,\n        align: getRemoveIndicatorAligment\n      },\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1, translateX: calculateFileInfoOffset }\n    },\n\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { translateX: calculateFileInfoOffset }\n    },\n\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n      buttonRevertItemProcessing: { opacity: 1 },\n      info: { opacity: 1 },\n      status: { opacity: 1 }\n    },\n\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n      buttonRemoveItem: { opacity: 1 },\n      buttonRetryItemProcessing: { opacity: 1 },\n      status: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset }\n    },\n\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n      buttonRevertItemProcessing: { opacity: 1 },\n      status: { opacity: 1 },\n      info: { opacity: 1 }\n    },\n\n    DID_ABORT_ITEM_PROCESSING: {\n      buttonRemoveItem: { opacity: 1 },\n      buttonProcessItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1 }\n    },\n\n    DID_REVERT_ITEM_PROCESSING: IdleStyle\n  };\n\n  // complete indicator view\n  var processingCompleteIndicatorView = createView({\n    create: function create(_ref) {\n      var root = _ref.root;\n      root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n      styles: ['scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      }\n    }\n  });\n\n  /**\n   * Creates the file view\n   */\n  var create$4 = function create(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    var id = props.id;\n\n    // allow reverting upload\n    var allowRevert = root.query('GET_ALLOW_REVERT');\n\n    // allow remove file\n    var allowRemove = root.query('GET_ALLOW_REMOVE');\n\n    // allow processing upload\n    var allowProcess = root.query('GET_ALLOW_PROCESS');\n\n    // is instant uploading, need this to determine the icon of the undo button\n    var instantUpload = root.query('GET_INSTANT_UPLOAD');\n\n    // is async set up\n    var isAsync = root.query('IS_ASYNC');\n\n    // should align remove item buttons\n    var alignRemoveItemButton = root.query(\n      'GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN'\n    );\n\n    // enabled buttons array\n    var buttonFilter;\n    if (isAsync) {\n      if (allowProcess && !allowRevert) {\n        // only remove revert button\n        buttonFilter = function buttonFilter(key) {\n          return !/RevertItemProcessing/.test(key);\n        };\n      } else if (!allowProcess && allowRevert) {\n        // only remove process button\n        buttonFilter = function buttonFilter(key) {\n          return !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(\n            key\n          );\n        };\n      } else if (!allowProcess && !allowRevert) {\n        // remove all process buttons\n        buttonFilter = function buttonFilter(key) {\n          return !/Process/.test(key);\n        };\n      }\n    } else {\n      // no process controls available\n      buttonFilter = function buttonFilter(key) {\n        return !/Process/.test(key);\n      };\n    }\n\n    var enabledButtons = buttonFilter\n      ? ButtonKeys.filter(buttonFilter)\n      : ButtonKeys.concat();\n\n    // update icon and label for revert button when instant uploading\n    if (instantUpload && allowRevert) {\n      Buttons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n      Buttons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    }\n\n    // remove last button (revert) if not allowed\n    if (isAsync && !allowRevert) {\n      var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      map.info.translateX = calculateFileHorizontalCenterOffset;\n      map.info.translateY = calculateFileVerticalCenterOffset;\n      map.status.translateY = calculateFileVerticalCenterOffset;\n      map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    // should align center\n    if (isAsync && !allowProcess) {\n      [\n        'DID_START_ITEM_PROCESSING',\n        'DID_REQUEST_ITEM_PROCESSING',\n        'DID_UPDATE_ITEM_PROCESS_PROGRESS',\n        'DID_THROW_ITEM_PROCESSING_ERROR'\n      ].forEach(function(key) {\n        StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;\n      });\n      StyleMap[\n        'DID_THROW_ITEM_PROCESSING_ERROR'\n      ].status.translateX = calculateButtonWidth;\n    }\n\n    // move remove button to right\n    if (alignRemoveItemButton && allowRevert) {\n      Buttons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\n      var _map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      _map.info.translateX = calculateFileInfoOffset;\n      _map.status.translateY = calculateFileVerticalCenterOffset;\n      _map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    if (!allowRemove) {\n      Buttons['RemoveItem'].disabled = true;\n    }\n\n    // create the button views\n    forin(Buttons, function(key, definition) {\n      // create button\n      var buttonView = root.createChildView(fileActionButton, {\n        label: root.query(definition.label),\n        icon: root.query(definition.icon),\n        opacity: 0\n      });\n\n      // should be appended?\n      if (enabledButtons.includes(key)) {\n        root.appendChildView(buttonView);\n      }\n\n      // toggle\n      if (definition.disabled) {\n        buttonView.element.setAttribute('disabled', 'disabled');\n        buttonView.element.setAttribute('hidden', 'hidden');\n      }\n\n      // add position attribute\n      buttonView.element.dataset.align = root.query(\n        'GET_STYLE_' + definition.align\n      );\n\n      // add class\n      buttonView.element.classList.add(definition.className);\n\n      // handle interactions\n      buttonView.on('click', function(e) {\n        e.stopPropagation();\n        if (definition.disabled) return;\n        root.dispatch(definition.action, { query: id });\n      });\n\n      // set reference\n      root.ref['button' + key] = buttonView;\n    });\n\n    // checkmark\n    root.ref.processingCompleteIndicator = root.appendChildView(\n      root.createChildView(processingCompleteIndicatorView)\n    );\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query(\n      'GET_STYLE_BUTTON_PROCESS_ITEM_POSITION'\n    );\n\n    // create file info view\n    root.ref.info = root.appendChildView(\n      root.createChildView(fileInfo, { id: id })\n    );\n\n    // create file status view\n    root.ref.status = root.appendChildView(\n      root.createChildView(fileStatus, { id: id })\n    );\n\n    // add progress indicators\n    var loadIndicatorView = root.appendChildView(\n      root.createChildView(progressIndicator, {\n        opacity: 0,\n        align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION')\n      })\n    );\n\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n\n    var progressIndicatorView = root.appendChildView(\n      root.createChildView(progressIndicator, {\n        opacity: 0,\n        align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION')\n      })\n    );\n\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView;\n\n    // current active styles\n    root.ref.activeStyles = [];\n  };\n\n  var write$2 = function write(_ref3) {\n    var root = _ref3.root,\n      actions = _ref3.actions,\n      props = _ref3.props;\n\n    // route actions\n    route({ root: root, actions: actions, props: props });\n\n    // select last state change action\n    var action = actions\n      .concat()\n      .filter(function(action) {\n        return /^DID_/.test(action.type);\n      })\n      .reverse()\n      .find(function(action) {\n        return StyleMap[action.type];\n      });\n\n    // a new action happened, let's get the matching styles\n    if (action) {\n      // define new active styles\n      root.ref.activeStyles = [];\n\n      var stylesToApply = StyleMap[action.type];\n      forin(DefaultStyle, function(name, defaultStyles) {\n        // get reference to control\n        var control = root.ref[name];\n\n        // loop over all styles for this control\n        forin(defaultStyles, function(key, defaultValue) {\n          var value =\n            stylesToApply[name] &&\n            typeof stylesToApply[name][key] !== 'undefined'\n              ? stylesToApply[name][key]\n              : defaultValue;\n          root.ref.activeStyles.push({\n            control: control,\n            key: key,\n            value: value\n          });\n        });\n      });\n    }\n\n    // apply active styles to element\n    root.ref.activeStyles.forEach(function(_ref4) {\n      var control = _ref4.control,\n        key = _ref4.key,\n        value = _ref4.value;\n      control[key] = typeof value === 'function' ? value(root) : value;\n    });\n  };\n\n  var route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(\n      _ref5\n    ) {\n      var root = _ref5.root,\n        action = _ref5.action;\n      root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(\n      _ref6\n    ) {\n      var root = _ref6.root,\n        action = _ref6.action;\n      root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(\n      _ref7\n    ) {\n      var root = _ref7.root,\n        action = _ref7.action;\n      root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {\n      var root = _ref8.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {\n      var root = _ref9.root;\n      root.ref.loadProgressIndicator.spin = true;\n      root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {\n      var root = _ref10.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(\n      _ref11\n    ) {\n      var root = _ref11.root,\n        action = _ref11.action;\n      root.ref.loadProgressIndicator.spin = false;\n      root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(\n      _ref12\n    ) {\n      var root = _ref12.root,\n        action = _ref12.action;\n      root.ref.processProgressIndicator.spin = false;\n      root.ref.processProgressIndicator.progress = action.progress;\n    }\n  });\n\n  var file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    name: 'file'\n  });\n\n  /**\n   * Creates the file view\n   */\n  var create$5 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // filename\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName);\n\n    // file appended\n    root.ref.file = root.appendChildView(\n      root.createChildView(file, { id: props.id })\n    );\n\n    // data has moved to data.js\n    root.ref.data = false;\n  };\n\n  /**\n   * Data storage\n   */\n  var didLoadItem = function didLoadItem(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    // updates the legend of the fieldset so screenreaders can better group buttons\n    text(\n      root.ref.fileName,\n      formatFilename(root.query('GET_ITEM_NAME', props.id))\n    );\n  };\n\n  var fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n      DID_LOAD_ITEM: didLoadItem\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper'\n  });\n\n  var PANEL_SPRING_PROPS = { type: 'spring', damping: 0.6, mass: 7 };\n\n  var create$6 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    [\n      {\n        name: 'top'\n      },\n\n      {\n        name: 'center',\n        props: {\n          translateY: null,\n          scaleY: null\n        },\n\n        mixins: {\n          animations: {\n            scaleY: PANEL_SPRING_PROPS\n          },\n\n          styles: ['translateY', 'scaleY']\n        }\n      },\n\n      {\n        name: 'bottom',\n        props: {\n          translateY: null\n        },\n\n        mixins: {\n          animations: {\n            translateY: PANEL_SPRING_PROPS\n          },\n\n          styles: ['translateY']\n        }\n      }\n    ].forEach(function(section) {\n      createSection(root, section, props.name);\n    });\n\n    root.element.classList.add('filepond--' + props.name);\n\n    root.ref.scalable = null;\n  };\n\n  var createSection = function createSection(root, section, className) {\n    var viewConstructor = createView({\n      name: 'panel-' + section.name + ' filepond--' + className,\n      mixins: section.mixins,\n      ignoreRectUpdate: true\n    });\n\n    var view = root.createChildView(viewConstructor, section.props);\n\n    root.ref[section.name] = root.appendChildView(view);\n  };\n\n  var write$3 = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n\n    // update scalable state\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n      root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n      root.element.dataset.scalable = root.ref.scalable;\n    }\n\n    // no height, can't set\n    if (!props.height) return;\n\n    // get child rects\n    var topRect = root.ref.top.rect.element;\n    var bottomRect = root.ref.bottom.rect.element;\n\n    // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n    var height = Math.max(topRect.height + bottomRect.height, props.height);\n\n    // offset center part\n    root.ref.center.translateY = topRect.height;\n\n    // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n    root.ref.center.scaleY =\n      (height - topRect.height - bottomRect.height) / 100;\n\n    // offset bottom part\n    root.ref.bottom.translateY = height - bottomRect.height;\n  };\n\n  var panel = createView({\n    name: 'panel',\n    read: function read(_ref3) {\n      var root = _ref3.root,\n        props = _ref3.props;\n      return (props.heightCurrent = root.ref.bottom.translateY);\n    },\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n      apis: ['height', 'heightCurrent', 'scalable']\n    }\n  });\n\n  var createDragHelper = function createDragHelper(items) {\n    var itemIds = items.map(function(item) {\n      return item.id;\n    });\n    var prevIndex = undefined;\n    return {\n      setIndex: function setIndex(index) {\n        prevIndex = index;\n      },\n      getIndex: function getIndex() {\n        return prevIndex;\n      },\n      getItemIndex: function getItemIndex(item) {\n        return itemIds.indexOf(item.id);\n      }\n    };\n  };\n\n  var ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10\n  };\n\n  var ITEM_SCALE_SPRING = 'spring';\n\n  var StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy processing',\n    DID_REQUEST_ITEM_PROCESSING: 'busy processing',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle'\n  };\n\n  /**\n   * Creates the file view\n   */\n  var create$7 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // select\n    root.ref.handleClick = function(e) {\n      return root.dispatch('DID_ACTIVATE_ITEM', { id: props.id });\n    };\n\n    // set id\n    root.element.id = 'filepond--item-' + props.id;\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // file view\n    root.ref.container = root.appendChildView(\n      root.createChildView(fileWrapper, { id: props.id })\n    );\n\n    // file panel\n    root.ref.panel = root.appendChildView(\n      root.createChildView(panel, { name: 'item-panel' })\n    );\n\n    // default start height\n    root.ref.panel.height = null;\n\n    // by default not marked for removal\n    props.markedForRemoval = false;\n\n    // if not allowed to reorder file items, exit here\n    if (!root.query('GET_ALLOW_REORDER')) return;\n\n    // set to idle so shows grab cursor\n    root.element.dataset.dragState = 'idle';\n\n    var grab = function grab(e) {\n      if (!e.isPrimary) return;\n\n      var removedActivateListener = false;\n\n      var origin = {\n        x: e.pageX,\n        y: e.pageY\n      };\n\n      props.dragOrigin = {\n        x: root.translateX,\n        y: root.translateY\n      };\n\n      props.dragCenter = {\n        x: e.offsetX,\n        y: e.offsetY\n      };\n\n      var dragState = createDragHelper(root.query('GET_ACTIVE_ITEMS'));\n\n      root.dispatch('DID_GRAB_ITEM', { id: props.id, dragState: dragState });\n\n      var drag = function drag(e) {\n        if (!e.isPrimary) return;\n\n        e.stopPropagation();\n        e.preventDefault();\n\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        };\n\n        // if dragged stop listening to clicks, will re-add when done dragging\n        var dist =\n          props.dragOffset.x * props.dragOffset.x +\n          props.dragOffset.y * props.dragOffset.y;\n        if (dist > 16 && !removedActivateListener) {\n          removedActivateListener = true;\n          root.element.removeEventListener('click', root.ref.handleClick);\n        }\n\n        root.dispatch('DID_DRAG_ITEM', { id: props.id, dragState: dragState });\n      };\n\n      var drop = function drop(e) {\n        if (!e.isPrimary) return;\n\n        document.removeEventListener('pointermove', drag);\n        document.removeEventListener('pointerup', drop);\n\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        };\n\n        root.dispatch('DID_DROP_ITEM', { id: props.id, dragState: dragState });\n\n        // start listening to clicks again\n        if (removedActivateListener) {\n          setTimeout(function() {\n            return root.element.addEventListener('click', root.ref.handleClick);\n          }, 0);\n        }\n      };\n\n      document.addEventListener('pointermove', drag);\n      document.addEventListener('pointerup', drop);\n    };\n\n    root.element.addEventListener('pointerdown', grab);\n  };\n\n  var route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {\n      var root = _ref2.root,\n        action = _ref2.action;\n      root.height = action.height;\n    }\n  });\n\n  var write$4 = createRoute(\n    {\n      DID_GRAB_ITEM: function DID_GRAB_ITEM(_ref3) {\n        var root = _ref3.root,\n          props = _ref3.props;\n        props.dragOrigin = {\n          x: root.translateX,\n          y: root.translateY\n        };\n      },\n      DID_DRAG_ITEM: function DID_DRAG_ITEM(_ref4) {\n        var root = _ref4.root;\n        root.element.dataset.dragState = 'drag';\n      },\n      DID_DROP_ITEM: function DID_DROP_ITEM(_ref5) {\n        var root = _ref5.root,\n          props = _ref5.props;\n        props.dragOffset = null;\n        props.dragOrigin = null;\n        root.element.dataset.dragState = 'drop';\n      }\n    },\n    function(_ref6) {\n      var root = _ref6.root,\n        actions = _ref6.actions,\n        props = _ref6.props,\n        shouldOptimize = _ref6.shouldOptimize;\n\n      if (root.element.dataset.dragState === 'drop') {\n        if (root.scaleX <= 1) {\n          root.element.dataset.dragState = 'idle';\n        }\n      }\n\n      // select last state change action\n      var action = actions\n        .concat()\n        .filter(function(action) {\n          return /^DID_/.test(action.type);\n        })\n        .reverse()\n        .find(function(action) {\n          return StateMap[action.type];\n        });\n\n      // no need to set same state twice\n      if (action && action.type !== props.currentState) {\n        // set current state\n        props.currentState = action.type;\n\n        // set state\n        root.element.dataset.filepondItemState =\n          StateMap[props.currentState] || '';\n      }\n\n      // route actions\n      var aspectRatio =\n        root.query('GET_ITEM_PANEL_ASPECT_RATIO') ||\n        root.query('GET_PANEL_ASPECT_RATIO');\n      if (!aspectRatio) {\n        route$1({ root: root, actions: actions, props: props });\n        if (!root.height && root.ref.container.rect.element.height > 0) {\n          root.height = root.ref.container.rect.element.height;\n        }\n      } else if (!shouldOptimize) {\n        root.height = root.rect.element.width * aspectRatio;\n      }\n\n      // sync panel height with item height\n      if (shouldOptimize) {\n        root.ref.panel.height = null;\n      }\n\n      root.ref.panel.height = root.height;\n    }\n  );\n\n  var item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: function destroy(_ref7) {\n      var root = _ref7.root,\n        props = _ref7.props;\n      root.element.removeEventListener('click', root.ref.handleClick);\n      root.dispatch('RELEASE_ITEM', { query: props.id });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n      apis: [\n        'id',\n        'interactionMethod',\n        'markedForRemoval',\n        'spawnDate',\n        'dragCenter',\n        'dragOrigin',\n        'dragOffset'\n      ],\n      styles: [\n        'translateX',\n        'translateY',\n        'scaleX',\n        'scaleY',\n        'opacity',\n        'height'\n      ],\n\n      animations: {\n        scaleX: ITEM_SCALE_SPRING,\n        scaleY: ITEM_SCALE_SPRING,\n        translateX: ITEM_TRANSLATE_SPRING,\n        translateY: ITEM_TRANSLATE_SPRING,\n        opacity: { type: 'tween', duration: 150 }\n      }\n    }\n  });\n\n  var getItemIndexByPosition = function getItemIndexByPosition(\n    view,\n    children,\n    positionInView\n  ) {\n    if (!positionInView) return;\n\n    var horizontalSpace = view.rect.element.width;\n    // const children = view.childViews;\n    var l = children.length;\n    var last = null;\n\n    // -1, don't move items to accomodate (either add to top or bottom)\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;\n\n    // let's get the item width\n    var item = children[0];\n    var itemRect = item.rect.element;\n    var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    var itemWidth = itemRect.width + itemHorizontalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      for (var index = 0; index < l; index++) {\n        var child = children[index];\n        var childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n        if (positionInView.top < childMid) {\n          return index;\n        }\n      }\n      return l;\n    }\n\n    // grid\n    var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    var itemHeight = itemRect.height + itemVerticalMargin;\n    for (var _index = 0; _index < l; _index++) {\n      var indexX = _index % itemsPerRow;\n      var indexY = Math.floor(_index / itemsPerRow);\n\n      var offsetX = indexX * itemWidth;\n      var offsetY = indexY * itemHeight;\n\n      var itemTop = offsetY - itemRect.marginTop;\n      var itemRight = offsetX + itemWidth;\n      var itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n      if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n        if (positionInView.left < itemRight) {\n          return _index;\n        } else if (_index !== l - 1) {\n          last = _index;\n        } else {\n          last = null;\n        }\n      }\n    }\n\n    if (last !== null) {\n      return last;\n    }\n\n    return l;\n  };\n\n  var dropAreaDimensions = {\n    height: 0,\n    width: 0,\n    get getHeight() {\n      return this.height;\n    },\n    set setHeight(val) {\n      if (this.height === 0 || val === 0) this.height = val;\n    },\n    get getWidth() {\n      return this.width;\n    },\n    set setWidth(val) {\n      if (this.width === 0 || val === 0) this.width = val;\n    },\n    setDimensions: function setDimensions(height, width) {\n      if (this.height === 0 || height === 0) this.height = height;\n      if (this.width === 0 || width === 0) this.width = width;\n    }\n  };\n\n  var create$8 = function create(_ref) {\n    var root = _ref.root;\n    // need to set role to list as otherwise it won't be read as a list by VoiceOver\n    attr(root.element, 'role', 'list');\n\n    root.ref.lastItemSpanwDate = Date.now();\n  };\n\n  /**\n   * Inserts a new item\n   * @param root\n   * @param action\n   */\n  var addItemView = function addItemView(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    var id = action.id,\n      index = action.index,\n      interactionMethod = action.interactionMethod;\n\n    root.ref.addIndex = index;\n\n    var now = Date.now();\n    var spawnDate = now;\n    var opacity = 1;\n\n    if (interactionMethod !== InteractionMethod.NONE) {\n      opacity = 0;\n      var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n      var dist = now - root.ref.lastItemSpanwDate;\n      spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n\n    root.ref.lastItemSpanwDate = spawnDate;\n\n    root.appendChildView(\n      root.createChildView(\n        // view type\n        item,\n\n        // props\n        {\n          spawnDate: spawnDate,\n          id: id,\n          opacity: opacity,\n          interactionMethod: interactionMethod\n        }\n      ),\n\n      index\n    );\n  };\n\n  var moveItem = function moveItem(item, x, y) {\n    var vx =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var vy =\n      arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n\n    // set to null to remove animation while dragging\n    if (item.dragOffset) {\n      item.translateX = null;\n      item.translateY = null;\n      item.translateX = item.dragOrigin.x + item.dragOffset.x;\n      item.translateY = item.dragOrigin.y + item.dragOffset.y;\n      item.scaleX = 1.025;\n      item.scaleY = 1.025;\n    } else {\n      item.translateX = x;\n      item.translateY = y;\n\n      if (Date.now() > item.spawnDate) {\n        // reveal element\n        if (item.opacity === 0) {\n          introItemView(item, x, y, vx, vy);\n        }\n\n        // make sure is default scale every frame\n        item.scaleX = 1;\n        item.scaleY = 1;\n        item.opacity = 1;\n      }\n    }\n  };\n\n  var introItemView = function introItemView(item, x, y, vx, vy) {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n      item.translateX = null;\n      item.translateX = x;\n      item.translateY = null;\n      item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n      item.translateX = null;\n      item.translateX = x - vx * 20;\n\n      item.translateY = null;\n      item.translateY = y - vy * 10;\n\n      item.scaleX = 0.8;\n      item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n      item.translateY = null;\n      item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n      item.translateX = null;\n      item.translateX = x - 30;\n      item.translateY = null;\n    }\n  };\n\n  /**\n   * Removes an existing item\n   * @param root\n   * @param action\n   */\n  var removeItemView = function removeItemView(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var id = action.id;\n\n    // get the view matching the given id\n    var view = root.childViews.find(function(child) {\n      return child.id === id;\n    });\n\n    // if no view found, exit\n    if (!view) {\n      return;\n    }\n\n    // animate view out of view\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0;\n\n    // mark for removal\n    view.markedForRemoval = true;\n  };\n\n  var getItemHeight = function getItemHeight(child) {\n    return (\n      child.rect.element.height +\n      child.rect.element.marginBottom * 0.5 +\n      child.rect.element.marginTop * 0.5\n    );\n  };\n  var getItemWidth = function getItemWidth(child) {\n    return (\n      child.rect.element.width +\n      child.rect.element.marginLeft * 0.5 +\n      child.rect.element.marginRight * 0.5\n    );\n  };\n\n  var dragItem = function dragItem(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    var id = action.id,\n      dragState = action.dragState;\n\n    // reference to item\n    var item = root.query('GET_ITEM', { id: id });\n\n    // get the view matching the given id\n    var view = root.childViews.find(function(child) {\n      return child.id === id;\n    });\n\n    var numItems = root.childViews.length;\n    var oldIndex = dragState.getItemIndex(item);\n\n    // if no view found, exit\n    if (!view) return;\n\n    var dragPosition = {\n      x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,\n      y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y\n\n      // get drag area dimensions\n    };\n    var dragHeight = getItemHeight(view);\n    var dragWidth = getItemWidth(view);\n\n    // get rows and columns (There will always be at least one row and one column if a file is present)\n    var cols = Math.floor(root.rect.outer.width / dragWidth);\n    if (cols > numItems) cols = numItems;\n\n    // rows are used to find when we have left the preview area bounding box\n    var rows = Math.floor(numItems / cols + 1);\n\n    dropAreaDimensions.setHeight = dragHeight * rows;\n    dropAreaDimensions.setWidth = dragWidth * cols;\n\n    // get new index of dragged item\n    var location = {\n      y: Math.floor(dragPosition.y / dragHeight),\n      x: Math.floor(dragPosition.x / dragWidth),\n      getGridIndex: function getGridIndex() {\n        if (\n          dragPosition.y > dropAreaDimensions.getHeight ||\n          dragPosition.y < 0 ||\n          dragPosition.x > dropAreaDimensions.getWidth ||\n          dragPosition.x < 0\n        )\n          return oldIndex;\n        return this.y * cols + this.x;\n      },\n      getColIndex: function getColIndex() {\n        var items = root.query('GET_ACTIVE_ITEMS');\n        var visibleChildren = root.childViews.filter(function(child) {\n          return child.rect.element.height;\n        });\n        var children = items.map(function(item) {\n          return visibleChildren.find(function(childView) {\n            return childView.id === item.id;\n          });\n        });\n        var currentIndex = children.findIndex(function(child) {\n          return child === view;\n        });\n        var dragHeight = getItemHeight(view);\n        var l = children.length;\n        var idx = l;\n        var childHeight = 0;\n        var childBottom = 0;\n        var childTop = 0;\n        for (var i = 0; i < l; i++) {\n          childHeight = getItemHeight(children[i]);\n          childTop = childBottom;\n          childBottom = childTop + childHeight;\n          if (dragPosition.y < childBottom) {\n            if (currentIndex > i) {\n              if (dragPosition.y < childTop + dragHeight) {\n                idx = i;\n                break;\n              }\n              continue;\n            }\n            idx = i;\n            break;\n          }\n        }\n        return idx;\n      }\n\n      // get new index\n    };\n    var index = cols > 1 ? location.getGridIndex() : location.getColIndex();\n    root.dispatch('MOVE_ITEM', { query: view, index: index });\n\n    // if the index of the item changed, dispatch reorder action\n    var currentIndex = dragState.getIndex();\n\n    if (currentIndex === undefined || currentIndex !== index) {\n      dragState.setIndex(index);\n\n      if (currentIndex === undefined) return;\n\n      root.dispatch('DID_REORDER_ITEMS', {\n        items: root.query('GET_ACTIVE_ITEMS'),\n        origin: oldIndex,\n        target: index\n      });\n    }\n  };\n\n  /**\n   * Setup action routes\n   */\n  var route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView,\n    DID_DRAG_ITEM: dragItem\n  });\n\n  /**\n   * Write to view\n   * @param root\n   * @param actions\n   * @param props\n   */\n  var write$5 = function write(_ref5) {\n    var root = _ref5.root,\n      props = _ref5.props,\n      actions = _ref5.actions,\n      shouldOptimize = _ref5.shouldOptimize;\n\n    // route actions\n    route$2({ root: root, props: props, actions: actions });\n    var dragCoordinates = props.dragCoordinates;\n\n    // available space on horizontal axis\n    var horizontalSpace = root.rect.element.width;\n\n    // only draw children that have dimensions\n    var visibleChildren = root.childViews.filter(function(child) {\n      return child.rect.element.height;\n    });\n\n    // sort based on current active items\n    var children = root\n      .query('GET_ACTIVE_ITEMS')\n      .map(function(item) {\n        return visibleChildren.find(function(child) {\n          return child.id === item.id;\n        });\n      })\n      .filter(function(item) {\n        return item;\n      });\n\n    // get index\n    var dragIndex = dragCoordinates\n      ? getItemIndexByPosition(root, children, dragCoordinates)\n      : null;\n\n    // add index is used to reserve the dropped/added item index till the actual item is rendered\n    var addIndex = root.ref.addIndex || null;\n\n    // add index no longer needed till possibly next draw\n    root.ref.addIndex = null;\n\n    var dragIndexOffset = 0;\n    var removeIndexOffset = 0;\n    var addIndexOffset = 0;\n\n    if (children.length === 0) return;\n\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      var offsetY = 0;\n      var dragOffset = 0;\n\n      children.forEach(function(child, index) {\n        if (dragIndex) {\n          var dist = index - dragIndex;\n          if (dist === -2) {\n            dragOffset = -itemVerticalMargin * 0.25;\n          } else if (dist === -1) {\n            dragOffset = -itemVerticalMargin * 0.75;\n          } else if (dist === 0) {\n            dragOffset = itemVerticalMargin * 0.75;\n          } else if (dist === 1) {\n            dragOffset = itemVerticalMargin * 0.25;\n          } else {\n            dragOffset = 0;\n          }\n        }\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        if (!child.markedForRemoval) {\n          moveItem(child, 0, offsetY + dragOffset);\n        }\n\n        var itemHeight = child.rect.element.height + itemVerticalMargin;\n\n        var visualHeight =\n          itemHeight * (child.markedForRemoval ? child.opacity : 1);\n\n        offsetY += visualHeight;\n      });\n    }\n    // grid\n    else {\n      var prevX = 0;\n      var prevY = 0;\n\n      children.forEach(function(child, index) {\n        if (index === dragIndex) {\n          dragIndexOffset = 1;\n        }\n\n        if (index === addIndex) {\n          addIndexOffset += 1;\n        }\n\n        if (child.markedForRemoval && child.opacity < 0.5) {\n          removeIndexOffset -= 1;\n        }\n\n        var visualIndex =\n          index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n\n        var indexX = visualIndex % itemsPerRow;\n        var indexY = Math.floor(visualIndex / itemsPerRow);\n\n        var offsetX = indexX * itemWidth;\n        var offsetY = indexY * itemHeight;\n\n        var vectorX = Math.sign(offsetX - prevX);\n        var vectorY = Math.sign(offsetY - prevY);\n\n        prevX = offsetX;\n        prevY = offsetY;\n\n        if (child.markedForRemoval) return;\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        moveItem(child, offsetX, offsetY, vectorX, vectorY);\n      });\n    }\n  };\n\n  /**\n   * Filters actions that are meant specifically for a certain child of the list\n   * @param child\n   * @param actions\n   */\n  var filterSetItemActions = function filterSetItemActions(child, actions) {\n    return actions.filter(function(action) {\n      // if action has an id, filter out actions that don't have this child id\n      if (action.data && action.data.id) {\n        return child.id === action.data.id;\n      }\n\n      // allow all other actions\n      return true;\n    });\n  };\n\n  var list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: function didWriteView(_ref6) {\n      var root = _ref6.root;\n      root.childViews\n        .filter(function(view) {\n          return view.markedForRemoval && view.opacity === 0 && view.resting;\n        })\n        .forEach(function(view) {\n          view._destroy();\n          root.removeChildView(view);\n        });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n      apis: ['dragCoordinates']\n    }\n  });\n\n  var create$9 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n  };\n\n  var storeDragCoordinates = function storeDragCoordinates(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props,\n      action = _ref2.action;\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n      left: action.position.scopeLeft - root.ref.list.rect.element.left,\n      top:\n        action.position.scopeTop -\n        (root.rect.outer.top +\n          root.rect.element.marginTop +\n          root.rect.element.scrollTop)\n    };\n  };\n\n  var clearDragCoordinates = function clearDragCoordinates(_ref3) {\n    var props = _ref3.props;\n    props.dragCoordinates = null;\n  };\n\n  var route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates\n  });\n\n  var write$6 = function write(_ref4) {\n    var root = _ref4.root,\n      props = _ref4.props,\n      actions = _ref4.actions;\n\n    // route actions\n    route$3({ root: root, props: props, actions: actions });\n\n    // current drag position\n    root.ref.list.dragCoordinates = props.dragCoordinates;\n\n    // if currently overflowing but no longer received overflow\n    if (props.overflowing && !props.overflow) {\n      props.overflowing = false;\n\n      // reset overflow state\n      root.element.dataset.state = '';\n      root.height = null;\n    }\n\n    // if is not overflowing currently but does receive overflow value\n    if (props.overflow) {\n      var newHeight = Math.round(props.overflow);\n      if (newHeight !== root.height) {\n        props.overflowing = true;\n        root.element.dataset.state = 'overflow';\n        root.height = newHeight;\n      }\n    }\n  };\n\n  var listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n      apis: ['overflow', 'dragCoordinates'],\n      styles: ['height', 'translateY'],\n      animations: {\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var attrToggle = function attrToggle(element, name, state) {\n    var enabledValue =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n    if (state) {\n      attr(element, name, enabledValue);\n    } else {\n      element.removeAttribute(name);\n    }\n  };\n\n  var resetFileInput = function resetFileInput(input) {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n      return;\n    }\n\n    try {\n      // for modern browsers\n      input.value = '';\n    } catch (err) {}\n\n    // for IE10\n    if (input.value) {\n      // quickly append input to temp form and reset form\n      var form = createElement$1('form');\n      var parentNode = input.parentNode;\n      var ref = input.nextSibling;\n      form.appendChild(input);\n      form.reset();\n\n      // re-inject input where it originally was\n      if (ref) {\n        parentNode.insertBefore(input, ref);\n      } else {\n        parentNode.appendChild(input);\n      }\n    }\n  };\n\n  var create$a = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // set id so can be referenced from outside labels\n    root.element.id = 'filepond--browser-' + props.id;\n\n    // set name of element (is removed when a value is set)\n    attr(root.element, 'name', root.query('GET_NAME'));\n\n    // we have to link this element to the status element\n    attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id);\n\n    // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n    attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id);\n\n    // set configurable props\n    setAcceptedFileTypes({\n      root: root,\n      action: { value: root.query('GET_ACCEPTED_FILE_TYPES') }\n    });\n    toggleAllowMultiple({\n      root: root,\n      action: { value: root.query('GET_ALLOW_MULTIPLE') }\n    });\n    toggleDirectoryFilter({\n      root: root,\n      action: { value: root.query('GET_ALLOW_DIRECTORIES_ONLY') }\n    });\n    toggleDisabled({ root: root });\n    toggleRequired({\n      root: root,\n      action: { value: root.query('GET_REQUIRED') }\n    });\n    setCaptureMethod({\n      root: root,\n      action: { value: root.query('GET_CAPTURE_METHOD') }\n    });\n\n    // handle changes to the input field\n    root.ref.handleChange = function(e) {\n      if (!root.element.value) {\n        return;\n      }\n\n      // extract files and move value of webkitRelativePath path to _relativePath\n      var files = Array.from(root.element.files).map(function(file) {\n        file._relativePath = file.webkitRelativePath;\n        return file;\n      });\n\n      // we add a little delay so the OS file select window can move out of the way before we add our file\n      setTimeout(function() {\n        // load files\n        props.onload(files);\n\n        // reset input, it's just for exposing a method to drop files, should not retain any state\n        resetFileInput(root.element);\n      }, 250);\n    };\n\n    root.element.addEventListener('change', root.ref.handleChange);\n  };\n\n  var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!root.query('GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE')) return;\n    attrToggle(\n      root.element,\n      'accept',\n      !!action.value,\n      action.value ? action.value.join(',') : ''\n    );\n  };\n\n  var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    attrToggle(root.element, 'multiple', action.value);\n  };\n\n  var toggleDirectoryFilter = function toggleDirectoryFilter(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    attrToggle(root.element, 'webkitdirectory', action.value);\n  };\n\n  var toggleDisabled = function toggleDisabled(_ref5) {\n    var root = _ref5.root;\n    var isDisabled = root.query('GET_DISABLED');\n    var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    var disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n  };\n\n  var toggleRequired = function toggleRequired(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    // want to remove required, always possible\n    if (!action.value) {\n      attrToggle(root.element, 'required', false);\n    }\n    // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n      attrToggle(root.element, 'required', true);\n    }\n  };\n\n  var setCaptureMethod = function setCaptureMethod(_ref7) {\n    var root = _ref7.root,\n      action = _ref7.action;\n    attrToggle(\n      root.element,\n      'capture',\n      !!action.value,\n      action.value === true ? '' : action.value\n    );\n  };\n\n  var updateRequiredStatus = function updateRequiredStatus(_ref8) {\n    var root = _ref8.root;\n    var element = root.element;\n    // always remove the required attribute when more than zero items\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n      attrToggle(element, 'required', false);\n      attrToggle(element, 'name', false);\n    } else {\n      // add name attribute\n      attrToggle(element, 'name', true, root.query('GET_NAME'));\n\n      // remove any validation messages\n      var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n      if (shouldCheckValidity) {\n        element.setCustomValidity('');\n      }\n\n      // we only add required if the field has been deemed required\n      if (root.query('GET_REQUIRED')) {\n        attrToggle(element, 'required', true);\n      }\n    }\n  };\n\n  var updateFieldValidityStatus = function updateFieldValidityStatus(_ref9) {\n    var root = _ref9.root;\n    var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n  };\n\n  var browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n      type: 'file'\n    },\n\n    create: create$a,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n      DID_LOAD_ITEM: updateRequiredStatus,\n      DID_REMOVE_ITEM: updateRequiredStatus,\n      DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n\n      DID_SET_DISABLED: toggleDisabled,\n      DID_SET_ALLOW_BROWSE: toggleDisabled,\n      DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\n      DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n      DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n      DID_SET_CAPTURE_METHOD: setCaptureMethod,\n      DID_SET_REQUIRED: toggleRequired\n    })\n  });\n\n  var Key = {\n    ENTER: 13,\n    SPACE: 32\n  };\n\n  var create$b = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // create the label and link it to the file browser\n    var label = createElement$1('label');\n    attr(label, 'for', 'filepond--browser-' + props.id);\n\n    // use for labeling file input (aria-labelledby on file input)\n    attr(label, 'id', 'filepond--drop-label-' + props.id);\n\n    // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.\n    attr(label, 'aria-hidden', 'true');\n\n    // handle keys\n    root.ref.handleKeyDown = function(e) {\n      var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n      if (!isActivationKey) return;\n      // stops from triggering the element a second time\n      e.preventDefault();\n\n      // click link (will then in turn activate file input)\n      root.ref.label.click();\n    };\n\n    root.ref.handleClick = function(e) {\n      var isLabelClick = e.target === label || label.contains(e.target);\n\n      // don't want to click twice\n      if (isLabelClick) return;\n\n      // click link (will then in turn activate file input)\n      root.ref.label.click();\n    };\n\n    // attach events\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // update\n    updateLabelValue(label, props.caption);\n\n    // add!\n    root.appendChild(label);\n    root.ref.label = label;\n  };\n\n  var updateLabelValue = function updateLabelValue(label, value) {\n    label.innerHTML = value;\n    var clickable = label.querySelector('.filepond--label-action');\n    if (clickable) {\n      attr(clickable, 'tabindex', '0');\n    }\n    return value;\n  };\n\n  var dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: function destroy(_ref2) {\n      var root = _ref2.root;\n      root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n      root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n      DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {\n        var root = _ref3.root,\n          action = _ref3.action;\n        updateLabelValue(root.ref.label, action.value);\n      }\n    }),\n\n    mixins: {\n      styles: ['opacity', 'translateX', 'translateY'],\n      animations: {\n        opacity: { type: 'tween', duration: 150 },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      }\n    }\n  });\n\n  var addBlob = function addBlob(_ref) {\n    var root = _ref.root;\n    var centerX = root.rect.element.width * 0.5;\n    var centerY = root.rect.element.height * 0.5;\n\n    root.ref.blob = root.appendChildView(\n      root.createChildView(blob, {\n        opacity: 0,\n        scaleX: 2.5,\n        scaleY: 2.5,\n        translateX: centerX,\n        translateY: centerY\n      })\n    );\n  };\n\n  var moveBlob = function moveBlob(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!root.ref.blob) {\n      addBlob({ root: root });\n      return;\n    }\n\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n  };\n\n  var hideBlob = function hideBlob(_ref3) {\n    var root = _ref3.root;\n    if (!root.ref.blob) {\n      return;\n    }\n    root.ref.blob.opacity = 0;\n  };\n\n  var explodeBlob = function explodeBlob(_ref4) {\n    var root = _ref4.root;\n    if (!root.ref.blob) {\n      return;\n    }\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n  };\n\n  var write$7 = function write(_ref5) {\n    var root = _ref5.root,\n      props = _ref5.props,\n      actions = _ref5.actions;\n    route$4({ root: root, props: props, actions: actions });\n    var blob = root.ref.blob;\n\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n      root.removeChildView(blob);\n      root.ref.blob = null;\n    }\n  };\n\n  var route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob\n  });\n\n  var drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7\n  });\n\n  var create$c = function create(_ref) {\n    var root = _ref.root;\n    return (root.ref.fields = {});\n  };\n\n  var getField = function getField(root, id) {\n    return root.ref.fields[id];\n  };\n\n  var syncFieldPositionsWithItems = function syncFieldPositionsWithItems(root) {\n    root.query('GET_ACTIVE_ITEMS').forEach(function(item) {\n      if (!root.ref.fields[item.id]) return;\n      root.element.appendChild(root.ref.fields[item.id]);\n    });\n  };\n\n  var didReorderItems = function didReorderItems(_ref2) {\n    var root = _ref2.root;\n    return syncFieldPositionsWithItems(root);\n  };\n\n  var didAddItem = function didAddItem(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var dataContainer = createElement$1('input');\n    dataContainer.type = 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    dataContainer.disabled = root.query('GET_DISABLED');\n    root.ref.fields[action.id] = dataContainer;\n    syncFieldPositionsWithItems(root);\n  };\n\n  var didLoadItem$1 = function didLoadItem(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    var field = getField(root, action.id);\n    if (!field || action.serverFileReference === null) return;\n    field.value = action.serverFileReference;\n  };\n\n  var didSetDisabled = function didSetDisabled(_ref5) {\n    var root = _ref5.root;\n    root.element.disabled = root.query('GET_DISABLED');\n  };\n\n  var didRemoveItem = function didRemoveItem(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n    if (field.parentNode) field.parentNode.removeChild(field);\n    delete root.ref.fields[action.id];\n  };\n\n  var didDefineValue = function didDefineValue(_ref7) {\n    var root = _ref7.root,\n      action = _ref7.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n    if (action.value === null) {\n      field.removeAttribute('value');\n    } else {\n      field.value = action.value;\n    }\n    syncFieldPositionsWithItems(root);\n  };\n\n  var write$8 = createRoute({\n    DID_SET_DISABLED: didSetDisabled,\n    DID_ADD_ITEM: didAddItem,\n    DID_LOAD_ITEM: didLoadItem$1,\n    DID_REMOVE_ITEM: didRemoveItem,\n    DID_DEFINE_VALUE: didDefineValue,\n    DID_REORDER_ITEMS: didReorderItems,\n    DID_SORT_ITEMS: didReorderItems\n  });\n\n  var data = createView({\n    tag: 'fieldset',\n    name: 'data',\n    create: create$c,\n    write: write$8,\n    ignoreRect: true\n  });\n\n  var getRootNode = function getRootNode(element) {\n    return 'getRootNode' in element ? element.getRootNode() : document;\n  };\n\n  var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n  var text$1 = ['css', 'csv', 'html', 'txt'];\n  var map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip'\n  };\n\n  var guesstimateMimeType = function guesstimateMimeType() {\n    var extension =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    extension = extension.toLowerCase();\n    if (images.includes(extension)) {\n      return (\n        'image/' +\n        (extension === 'jpg'\n          ? 'jpeg'\n          : extension === 'svg'\n          ? 'svg+xml'\n          : extension)\n      );\n    }\n    if (text$1.includes(extension)) {\n      return 'text/' + extension;\n    }\n\n    return map[extension] || '';\n  };\n\n  var requestDataTransferItems = function requestDataTransferItems(\n    dataTransfer\n  ) {\n    return new Promise(function(resolve, reject) {\n      // try to get links from transfer, if found we'll exit immediately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n      var links = getLinks(dataTransfer);\n      if (links.length && !hasFiles(dataTransfer)) {\n        return resolve(links);\n      }\n      // try to get files from the transfer\n      getFiles(dataTransfer).then(resolve);\n    });\n  };\n\n  /**\n   * Test if datatransfer has files\n   */\n  var hasFiles = function hasFiles(dataTransfer) {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n  };\n\n  /**\n   * Extracts files from a DataTransfer object\n   */\n  var getFiles = function getFiles(dataTransfer) {\n    return new Promise(function(resolve, reject) {\n      // get the transfer items as promises\n      var promisedFiles = (dataTransfer.items\n        ? Array.from(dataTransfer.items)\n        : []\n      )\n        // only keep file system items (files and directories)\n        .filter(function(item) {\n          return isFileSystemItem(item);\n        })\n\n        // map each item to promise\n        .map(function(item) {\n          return getFilesFromItem(item);\n        });\n\n      // if is empty, see if we can extract some info from the files property as a fallback\n      if (!promisedFiles.length) {\n        // TODO: test for directories (should not be allowed)\n        // Use FileReader, problem is that the files property gets lost in the process\n        resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n        return;\n      }\n\n      // done!\n      Promise.all(promisedFiles)\n        .then(function(returnedFileGroups) {\n          // flatten groups\n          var files = [];\n          returnedFileGroups.forEach(function(group) {\n            files.push.apply(files, group);\n          });\n\n          // done (filter out empty files)!\n          resolve(\n            files\n              .filter(function(file) {\n                return file;\n              })\n              .map(function(file) {\n                if (!file._relativePath)\n                  file._relativePath = file.webkitRelativePath;\n                return file;\n              })\n          );\n        })\n        .catch(console.error);\n    });\n  };\n\n  var isFileSystemItem = function isFileSystemItem(item) {\n    if (isEntry(item)) {\n      var entry = getAsEntry(item);\n      if (entry) {\n        return entry.isFile || entry.isDirectory;\n      }\n    }\n    return item.kind === 'file';\n  };\n\n  var getFilesFromItem = function getFilesFromItem(item) {\n    return new Promise(function(resolve, reject) {\n      if (isDirectoryEntry(item)) {\n        getFilesInDirectory(getAsEntry(item))\n          .then(resolve)\n          .catch(reject);\n        return;\n      }\n\n      resolve([item.getAsFile()]);\n    });\n  };\n\n  var getFilesInDirectory = function getFilesInDirectory(entry) {\n    return new Promise(function(resolve, reject) {\n      var files = [];\n\n      // the total entries to read\n      var dirCounter = 0;\n      var fileCounter = 0;\n\n      var resolveIfDone = function resolveIfDone() {\n        if (fileCounter === 0 && dirCounter === 0) {\n          resolve(files);\n        }\n      };\n\n      // the recursive function\n      var readEntries = function readEntries(dirEntry) {\n        dirCounter++;\n\n        var directoryReader = dirEntry.createReader();\n\n        // directories are returned in batches, we need to process all batches before we're done\n        var readBatch = function readBatch() {\n          directoryReader.readEntries(function(entries) {\n            if (entries.length === 0) {\n              dirCounter--;\n              resolveIfDone();\n              return;\n            }\n\n            entries.forEach(function(entry) {\n              // recursively read more directories\n              if (entry.isDirectory) {\n                readEntries(entry);\n              } else {\n                // read as file\n                fileCounter++;\n\n                entry.file(function(file) {\n                  var correctedFile = correctMissingFileType(file);\n                  if (entry.fullPath)\n                    correctedFile._relativePath = entry.fullPath;\n                  files.push(correctedFile);\n                  fileCounter--;\n                  resolveIfDone();\n                });\n              }\n            });\n\n            // try to get next batch of files\n            readBatch();\n          }, reject);\n        };\n\n        // read first batch of files\n        readBatch();\n      };\n\n      // go!\n      readEntries(entry);\n    });\n  };\n\n  var correctMissingFileType = function correctMissingFileType(file) {\n    if (file.type.length) return file;\n    var date = file.lastModifiedDate;\n    var name = file.name;\n    var type = guesstimateMimeType(getExtensionFromFilename(file.name));\n    if (!type.length) return file;\n    file = file.slice(0, file.size, type);\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n  };\n\n  var isDirectoryEntry = function isDirectoryEntry(item) {\n    return isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n  };\n\n  var isEntry = function isEntry(item) {\n    return 'webkitGetAsEntry' in item;\n  };\n\n  var getAsEntry = function getAsEntry(item) {\n    return item.webkitGetAsEntry();\n  };\n\n  /**\n   * Extracts links from a DataTransfer object\n   */\n  var getLinks = function getLinks(dataTransfer) {\n    var links = [];\n    try {\n      // look in meta data property\n      links = getLinksFromTransferMetaData(dataTransfer);\n      if (links.length) {\n        return links;\n      }\n      links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {\n      // nope nope nope (probably IE trouble)\n    }\n    return links;\n  };\n\n  var getLinksFromTransferURLData = function getLinksFromTransferURLData(\n    dataTransfer\n  ) {\n    var data = dataTransfer.getData('url');\n    if (typeof data === 'string' && data.length) {\n      return [data];\n    }\n    return [];\n  };\n\n  var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(\n    dataTransfer\n  ) {\n    var data = dataTransfer.getData('text/html');\n    if (typeof data === 'string' && data.length) {\n      var matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n      if (matches) {\n        return [matches[1]];\n      }\n    }\n    return [];\n  };\n\n  var dragNDropObservers = [];\n\n  var eventPosition = function eventPosition(e) {\n    return {\n      pageLeft: e.pageX,\n      pageTop: e.pageY,\n      scopeLeft: e.offsetX || e.layerX,\n      scopeTop: e.offsetY || e.layerY\n    };\n  };\n\n  var createDragNDropClient = function createDragNDropClient(\n    element,\n    scopeToObserve,\n    filterElement\n  ) {\n    var observer = getDragNDropObserver(scopeToObserve);\n\n    var client = {\n      element: element,\n      filterElement: filterElement,\n      state: null,\n      ondrop: function ondrop() {},\n      onenter: function onenter() {},\n      ondrag: function ondrag() {},\n      onexit: function onexit() {},\n      onload: function onload() {},\n      allowdrop: function allowdrop() {}\n    };\n\n    client.destroy = observer.addListener(client);\n\n    return client;\n  };\n\n  var getDragNDropObserver = function getDragNDropObserver(element) {\n    // see if already exists, if so, return\n    var observer = dragNDropObservers.find(function(item) {\n      return item.element === element;\n    });\n    if (observer) {\n      return observer;\n    }\n\n    // create new observer, does not yet exist for this element\n    var newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n  };\n\n  var createDragNDropObserver = function createDragNDropObserver(element) {\n    var clients = [];\n\n    var routes = {\n      dragenter: dragenter,\n      dragover: dragover,\n      dragleave: dragleave,\n      drop: drop\n    };\n\n    var handlers = {};\n\n    forin(routes, function(event, createHandler) {\n      handlers[event] = createHandler(element, clients);\n      element.addEventListener(event, handlers[event], false);\n    });\n\n    var observer = {\n      element: element,\n      addListener: function addListener(client) {\n        // add as client\n        clients.push(client);\n\n        // return removeListener function\n        return function() {\n          // remove client\n          clients.splice(clients.indexOf(client), 1);\n\n          // if no more clients, clean up observer\n          if (clients.length === 0) {\n            dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n\n            forin(routes, function(event) {\n              element.removeEventListener(event, handlers[event], false);\n            });\n          }\n        };\n      }\n    };\n\n    return observer;\n  };\n\n  var elementFromPoint = function elementFromPoint(root, point) {\n    if (!('elementFromPoint' in root)) {\n      root = document;\n    }\n    return root.elementFromPoint(point.x, point.y);\n  };\n\n  var isEventTarget = function isEventTarget(e, target) {\n    // get root\n    var root = getRootNode(target);\n\n    // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n    var elementAtPosition = elementFromPoint(root, {\n      x: e.pageX - window.pageXOffset,\n      y: e.pageY - window.pageYOffset\n    });\n\n    // test if target is the element or if one of its children is\n    return elementAtPosition === target || target.contains(elementAtPosition);\n  };\n\n  var initialTarget = null;\n\n  var setDropEffect = function setDropEffect(dataTransfer, effect) {\n    // is in try catch as IE11 will throw error if not\n    try {\n      dataTransfer.dropEffect = effect;\n    } catch (e) {}\n  };\n\n  var dragenter = function dragenter(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      initialTarget = e.target;\n\n      clients.forEach(function(client) {\n        var element = client.element,\n          onenter = client.onenter;\n\n        if (isEventTarget(e, element)) {\n          client.state = 'enter';\n\n          // fire enter event\n          onenter(eventPosition(e));\n        }\n      });\n    };\n  };\n\n  var dragover = function dragover(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      var dataTransfer = e.dataTransfer;\n\n      requestDataTransferItems(dataTransfer).then(function(items) {\n        var overDropTarget = false;\n\n        clients.some(function(client) {\n          var filterElement = client.filterElement,\n            element = client.element,\n            onenter = client.onenter,\n            onexit = client.onexit,\n            ondrag = client.ondrag,\n            allowdrop = client.allowdrop;\n\n          // by default we can drop\n          setDropEffect(dataTransfer, 'copy');\n\n          // allow transfer of these items\n          var allowsTransfer = allowdrop(items);\n\n          // only used when can be dropped on page\n          if (!allowsTransfer) {\n            setDropEffect(dataTransfer, 'none');\n            return;\n          }\n\n          // targetting this client\n          if (isEventTarget(e, element)) {\n            overDropTarget = true;\n\n            // had no previous state, means we are entering this client\n            if (client.state === null) {\n              client.state = 'enter';\n              onenter(eventPosition(e));\n              return;\n            }\n\n            // now over element (no matter if it allows the drop or not)\n            client.state = 'over';\n\n            // needs to allow transfer\n            if (filterElement && !allowsTransfer) {\n              setDropEffect(dataTransfer, 'none');\n              return;\n            }\n\n            // dragging\n            ondrag(eventPosition(e));\n          } else {\n            // should be over an element to drop\n            if (filterElement && !overDropTarget) {\n              setDropEffect(dataTransfer, 'none');\n            }\n\n            // might have just left this client?\n            if (client.state) {\n              client.state = null;\n              onexit(eventPosition(e));\n            }\n          }\n        });\n      });\n    };\n  };\n\n  var drop = function drop(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      var dataTransfer = e.dataTransfer;\n\n      requestDataTransferItems(dataTransfer).then(function(items) {\n        clients.forEach(function(client) {\n          var filterElement = client.filterElement,\n            element = client.element,\n            ondrop = client.ondrop,\n            onexit = client.onexit,\n            allowdrop = client.allowdrop;\n\n          client.state = null;\n\n          // if we're filtering on element we need to be over the element to drop\n          if (filterElement && !isEventTarget(e, element)) return;\n\n          // no transfer for this client\n          if (!allowdrop(items)) return onexit(eventPosition(e));\n\n          // we can drop these items on this client\n          ondrop(eventPosition(e), items);\n        });\n      });\n    };\n  };\n\n  var dragleave = function dragleave(root, clients) {\n    return function(e) {\n      if (initialTarget !== e.target) {\n        return;\n      }\n\n      clients.forEach(function(client) {\n        var onexit = client.onexit;\n\n        client.state = null;\n\n        onexit(eventPosition(e));\n      });\n    };\n  };\n\n  var createHopper = function createHopper(scope, validateItems, options) {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper');\n\n    // shortcuts\n    var catchesDropsOnPage = options.catchesDropsOnPage,\n      requiresDropOnElement = options.requiresDropOnElement,\n      _options$filterItems = options.filterItems,\n      filterItems =\n        _options$filterItems === void 0\n          ? function(items) {\n              return items;\n            }\n          : _options$filterItems;\n\n    // create a dnd client\n    var client = createDragNDropClient(\n      scope,\n      catchesDropsOnPage ? document.documentElement : scope,\n      requiresDropOnElement\n    );\n\n    // current client state\n    var lastState = '';\n    var currentState = '';\n\n    // determines if a file may be dropped\n    client.allowdrop = function(items) {\n      // TODO: if we can, throw error to indicate the items cannot by dropped\n\n      return validateItems(filterItems(items));\n    };\n\n    client.ondrop = function(position, items) {\n      var filteredItems = filterItems(items);\n\n      if (!validateItems(filteredItems)) {\n        api.ondragend(position);\n        return;\n      }\n\n      currentState = 'drag-drop';\n\n      api.onload(filteredItems, position);\n    };\n\n    client.ondrag = function(position) {\n      api.ondrag(position);\n    };\n\n    client.onenter = function(position) {\n      currentState = 'drag-over';\n\n      api.ondragstart(position);\n    };\n\n    client.onexit = function(position) {\n      currentState = 'drag-exit';\n\n      api.ondragend(position);\n    };\n\n    var api = {\n      updateHopperState: function updateHopperState() {\n        if (lastState !== currentState) {\n          scope.dataset.hopperState = currentState;\n          lastState = currentState;\n        }\n      },\n      onload: function onload() {},\n      ondragstart: function ondragstart() {},\n      ondrag: function ondrag() {},\n      ondragend: function ondragend() {},\n      destroy: function destroy() {\n        // destroy client\n        client.destroy();\n      }\n    };\n\n    return api;\n  };\n\n  var listening = false;\n  var listeners$1 = [];\n\n  var handlePaste = function handlePaste(e) {\n    // if is pasting in input or textarea and the target is outside of a filepond scope, ignore\n    var activeEl = document.activeElement;\n    if (activeEl && /textarea|input/i.test(activeEl.nodeName)) {\n      // test textarea or input is contained in filepond root\n      var inScope = false;\n      var element = activeEl;\n      while (element !== document.body) {\n        if (element.classList.contains('filepond--root')) {\n          inScope = true;\n          break;\n        }\n        element = element.parentNode;\n      }\n\n      if (!inScope) return;\n    }\n\n    requestDataTransferItems(e.clipboardData).then(function(files) {\n      // no files received\n      if (!files.length) {\n        return;\n      }\n\n      // notify listeners of received files\n      listeners$1.forEach(function(listener) {\n        return listener(files);\n      });\n    });\n  };\n\n  var listen = function listen(cb) {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n      return;\n    }\n\n    // add initial listener\n    listeners$1.push(cb);\n\n    // setup paste listener for entire page\n    if (listening) {\n      return;\n    }\n\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n  };\n\n  var unlisten = function unlisten(listener) {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener));\n\n    // clean up\n    if (listeners$1.length === 0) {\n      document.removeEventListener('paste', handlePaste);\n      listening = false;\n    }\n  };\n\n  var createPaster = function createPaster() {\n    var cb = function cb(files) {\n      api.onload(files);\n    };\n\n    var api = {\n      destroy: function destroy() {\n        unlisten(cb);\n      },\n      onload: function onload() {}\n    };\n\n    listen(cb);\n\n    return api;\n  };\n\n  /**\n   * Creates the file view\n   */\n  var create$d = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.element.id = 'filepond--assistant-' + props.id;\n    attr(root.element, 'role', 'status');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n  };\n\n  var addFilesNotificationTimeout = null;\n  var notificationClearTimeout = null;\n\n  var filenames = [];\n\n  var assist = function assist(root, message) {\n    root.element.textContent = message;\n  };\n\n  var clear$1 = function clear(root) {\n    root.element.textContent = '';\n  };\n\n  var listModified = function listModified(root, filename, label) {\n    var total = root.query('GET_TOTAL_ITEMS');\n    assist(\n      root,\n      label +\n        ' ' +\n        filename +\n        ', ' +\n        total +\n        ' ' +\n        (total === 1\n          ? root.query('GET_LABEL_FILE_COUNT_SINGULAR')\n          : root.query('GET_LABEL_FILE_COUNT_PLURAL'))\n    );\n\n    // clear group after set amount of time so the status is not read twice\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(function() {\n      clear$1(root);\n    }, 1500);\n  };\n\n  var isUsingFilePond = function isUsingFilePond(root) {\n    return root.element.parentNode.contains(document.activeElement);\n  };\n\n  var itemAdded = function itemAdded(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    root.element.textContent = '';\n    var item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(function() {\n      listModified(\n        root,\n        filenames.join(', '),\n        root.query('GET_LABEL_FILE_ADDED')\n      );\n\n      filenames.length = 0;\n    }, 750);\n  };\n\n  var itemRemoved = function itemRemoved(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    var item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n  };\n\n  var itemProcessed = function itemProcessed(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemProcessedUndo = function itemProcessedUndo(_ref5) {\n    var root = _ref5.root,\n      action = _ref5.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemError = function itemError(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);\n  };\n\n  var assistant = createView({\n    create: create$d,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: itemAdded,\n      DID_REMOVE_ITEM: itemRemoved,\n      DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n\n      DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n\n      DID_THROW_ITEM_REMOVE_ERROR: itemError,\n      DID_THROW_ITEM_LOAD_ERROR: itemError,\n      DID_THROW_ITEM_INVALID: itemError,\n      DID_THROW_ITEM_PROCESSING_ERROR: itemError\n    }),\n\n    tag: 'span',\n    name: 'assistant'\n  });\n\n  var toCamels = function toCamels(string) {\n    var separator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.replace(new RegExp(separator + '.', 'g'), function(sub) {\n      return sub.charAt(1).toUpperCase();\n    });\n  };\n\n  var debounce = function debounce(func) {\n    var interval =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n    var immidiateOnly =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var last = Date.now();\n    var timeout = null;\n\n    return function() {\n      for (\n        var _len = arguments.length, args = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        args[_key] = arguments[_key];\n      }\n      clearTimeout(timeout);\n\n      var dist = Date.now() - last;\n\n      var fn = function fn() {\n        last = Date.now();\n        func.apply(void 0, args);\n      };\n\n      if (dist < interval) {\n        // we need to delay by the difference between interval and dist\n        // for example: if distance is 10 ms and interval is 16 ms,\n        // we need to wait an additional 6ms before calling the function)\n        if (!immidiateOnly) {\n          timeout = setTimeout(fn, interval - dist);\n        }\n      } else {\n        // go!\n        fn();\n      }\n    };\n  };\n\n  var MAX_FILES_LIMIT = 1000000;\n\n  var prevent = function prevent(e) {\n    return e.preventDefault();\n  };\n\n  var create$e = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // Add id\n    var id = root.query('GET_ID');\n    if (id) {\n      root.element.id = id;\n    }\n\n    // Add className\n    var className = root.query('GET_CLASS_NAME');\n    if (className) {\n      className\n        .split(' ')\n        .filter(function(name) {\n          return name.length;\n        })\n        .forEach(function(name) {\n          root.element.classList.add(name);\n        });\n    }\n\n    // Field label\n    root.ref.label = root.appendChildView(\n      root.createChildView(\n        dropLabel,\n        Object.assign({}, props, {\n          translateY: null,\n          caption: root.query('GET_LABEL_IDLE')\n        })\n      )\n    );\n\n    // List of items\n    root.ref.list = root.appendChildView(\n      root.createChildView(listScroller, { translateY: null })\n    );\n\n    // Background panel\n    root.ref.panel = root.appendChildView(\n      root.createChildView(panel, { name: 'panel-root' })\n    );\n\n    // Assistant notifies assistive tech when content changes\n    root.ref.assistant = root.appendChildView(\n      root.createChildView(assistant, Object.assign({}, props))\n    );\n\n    // Data\n    root.ref.data = root.appendChildView(\n      root.createChildView(data, Object.assign({}, props))\n    );\n\n    // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure);\n\n    // information on the root height or fixed height status\n    root.ref.bounds = null;\n\n    // apply initial style properties\n    root\n      .query('GET_STYLES')\n      .filter(function(style) {\n        return !isEmpty(style.value);\n      })\n      .map(function(_ref2) {\n        var name = _ref2.name,\n          value = _ref2.value;\n        root.element.dataset[name] = value;\n      });\n\n    // determine if width changed\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(function() {\n      root.ref.updateHistory = [];\n      root.dispatch('DID_RESIZE_ROOT');\n    }, 250);\n\n    // history of updates\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = [];\n\n    // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\n    var canHover = window.matchMedia('(pointer: fine) and (hover: hover)')\n      .matches;\n    var hasPointerEvents = 'PointerEvent' in window;\n    if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\n      root.element.addEventListener('touchmove', prevent, { passive: false });\n      root.element.addEventListener('gesturestart', prevent);\n    }\n\n    // add credits\n    var credits = root.query('GET_CREDITS');\n    var hasCredits = credits.length === 2;\n    if (hasCredits) {\n      var frag = document.createElement('a');\n      frag.className = 'filepond--credits';\n      frag.setAttribute('aria-hidden', 'true');\n      frag.href = credits[0];\n      frag.tabindex = -1;\n      frag.target = '_blank';\n      frag.rel = 'noopener noreferrer';\n      frag.textContent = credits[1];\n      root.element.appendChild(frag);\n      root.ref.credits = frag;\n    }\n  };\n\n  var write$9 = function write(_ref3) {\n    var root = _ref3.root,\n      props = _ref3.props,\n      actions = _ref3.actions;\n\n    // route actions\n    route$5({ root: root, props: props, actions: actions });\n\n    // apply style properties\n    actions\n      .filter(function(action) {\n        return /^DID_SET_STYLE_/.test(action.type);\n      })\n      .filter(function(action) {\n        return !isEmpty(action.data.value);\n      })\n      .map(function(_ref4) {\n        var type = _ref4.type,\n          data = _ref4.data;\n        var name = toCamels(type.substr(8).toLowerCase(), '_');\n        root.element.dataset[name] = data.value;\n        root.invalidateLayout();\n      });\n\n    if (root.rect.element.hidden) return;\n\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n      root.ref.widthPrevious = root.rect.element.width;\n      root.ref.widthUpdated();\n    }\n\n    // get box bounds, we do this only once\n    var bounds = root.ref.bounds;\n    if (!bounds) {\n      bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);\n\n      // destroy measure element\n      root.element.removeChild(root.ref.measure);\n      root.ref.measure = null;\n    }\n\n    // get quick references to various high level parts of the upload tool\n    var _root$ref = root.ref,\n      hopper = _root$ref.hopper,\n      label = _root$ref.label,\n      list = _root$ref.list,\n      panel = _root$ref.panel;\n\n    // sets correct state to hopper scope\n    if (hopper) {\n      hopper.updateHopperState();\n    }\n\n    // bool to indicate if we're full or not\n    var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    var isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = isMultiItem\n      ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT\n      : 1;\n    var atMaxCapacity = totalItems === maxItems;\n\n    // action used to add item\n    var addAction = actions.find(function(action) {\n      return action.type === 'DID_ADD_ITEM';\n    });\n\n    // if reached max capacity and we've just reached it\n    if (atMaxCapacity && addAction) {\n      // get interaction type\n      var interactionMethod = addAction.data.interactionMethod;\n\n      // hide label\n      label.opacity = 0;\n\n      if (isMultiItem) {\n        label.translateY = -40;\n      } else {\n        if (interactionMethod === InteractionMethod.API) {\n          label.translateX = 40;\n        } else if (interactionMethod === InteractionMethod.BROWSE) {\n          label.translateY = 40;\n        } else {\n          label.translateY = 30;\n        }\n      }\n    } else if (!atMaxCapacity) {\n      label.opacity = 1;\n      label.translateX = 0;\n      label.translateY = 0;\n    }\n\n    var listItemMargin = calculateListItemMargin(root);\n\n    var listHeight = calculateListHeight(root);\n\n    var labelHeight = label.rect.element.height;\n    var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n\n    var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    var listMarginBottom =\n      totalItems === 0 ? 0 : list.rect.element.marginBottom;\n\n    var visualHeight =\n      currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    var boundsHeight =\n      currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;\n\n    // link list to label bottom position\n    list.translateY =\n      Math.max(0, currentLabelHeight - list.rect.element.marginTop) -\n      listItemMargin.top;\n\n    if (aspectRatio) {\n      // fixed aspect ratio\n\n      // calculate height based on width\n      var width = root.rect.element.width;\n      var height = width * aspectRatio;\n\n      // clear history if aspect ratio has changed\n      if (aspectRatio !== root.ref.previousAspectRatio) {\n        root.ref.previousAspectRatio = aspectRatio;\n        root.ref.updateHistory = [];\n      }\n\n      // remember this width\n      var history = root.ref.updateHistory;\n      history.push(width);\n\n      var MAX_BOUNCES = 2;\n      if (history.length > MAX_BOUNCES * 2) {\n        var l = history.length;\n        var bottom = l - 10;\n        var bounces = 0;\n        for (var i = l; i >= bottom; i--) {\n          if (history[i] === history[i - 2]) {\n            bounces++;\n          }\n\n          if (bounces >= MAX_BOUNCES) {\n            // dont adjust height\n            return;\n          }\n        }\n      }\n\n      // fix height of panel so it adheres to aspect ratio\n      panel.scalable = false;\n      panel.height = height;\n\n      // available height for list\n      var listAvailableHeight =\n        // the height of the panel minus the label height\n        height -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      if (listHeight.visual > listAvailableHeight) {\n        list.overflow = listAvailableHeight;\n      } else {\n        list.overflow = null;\n      }\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = height;\n    } else if (bounds.fixedHeight) {\n      // fixed height\n\n      // fix height of panel\n      panel.scalable = false;\n\n      // available height for list\n      var _listAvailableHeight =\n        // the height of the panel minus the label height\n        bounds.fixedHeight -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      // set list height\n      if (listHeight.visual > _listAvailableHeight) {\n        list.overflow = _listAvailableHeight;\n      } else {\n        list.overflow = null;\n      }\n\n      // no need to set container bounds as these are handles by CSS fixed height\n    } else if (bounds.cappedHeight) {\n      // max-height\n\n      // not a fixed height panel\n      var isCappedHeight = visualHeight >= bounds.cappedHeight;\n      var panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n      panel.scalable = true;\n      panel.height = isCappedHeight\n        ? panelHeight\n        : panelHeight - listItemMargin.top - listItemMargin.bottom;\n\n      // available height for list\n      var _listAvailableHeight2 =\n        // the height of the panel minus the label height\n        panelHeight -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      // set list height (if is overflowing)\n      if (\n        visualHeight > bounds.cappedHeight &&\n        listHeight.visual > _listAvailableHeight2\n      ) {\n        list.overflow = _listAvailableHeight2;\n      } else {\n        list.overflow = null;\n      }\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = Math.min(\n        bounds.cappedHeight,\n        boundsHeight - listItemMargin.top - listItemMargin.bottom\n      );\n    } else {\n      // flexible height\n\n      // not a fixed height panel\n      var itemMargin =\n        totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n      panel.scalable = true;\n      panel.height = Math.max(labelHeight, visualHeight - itemMargin);\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    }\n\n    // move credits to bottom\n    if (root.ref.credits && panel.heightCurrent)\n      root.ref.credits.style.transform =\n        'translateY(' + panel.heightCurrent + 'px)';\n  };\n\n  var calculateListItemMargin = function calculateListItemMargin(root) {\n    var item = root.ref.list.childViews[0].childViews[0];\n    return item\n      ? {\n          top: item.rect.element.marginTop,\n          bottom: item.rect.element.marginBottom\n        }\n      : {\n          top: 0,\n          bottom: 0\n        };\n  };\n\n  var calculateListHeight = function calculateListHeight(root) {\n    var visual = 0;\n    var bounds = 0;\n\n    // get file list reference\n    var scrollList = root.ref.list;\n    var itemList = scrollList.childViews[0];\n    var visibleChildren = itemList.childViews.filter(function(child) {\n      return child.rect.element.height;\n    });\n    var children = root\n      .query('GET_ACTIVE_ITEMS')\n      .map(function(item) {\n        return visibleChildren.find(function(child) {\n          return child.id === item.id;\n        });\n      })\n      .filter(function(item) {\n        return item;\n      });\n\n    // no children, done!\n    if (children.length === 0) return { visual: visual, bounds: bounds };\n\n    var horizontalSpace = itemList.rect.element.width;\n    var dragIndex = getItemIndexByPosition(\n      itemList,\n      children,\n      scrollList.dragCoordinates\n    );\n\n    var childRect = children[0].rect.element;\n\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n\n    var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    var removedItem = children.find(function(child) {\n      return child.markedForRemoval && child.opacity < 0.45;\n    })\n      ? -1\n      : 0;\n    var verticalItemCount = children.length + newItem + removedItem;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      children.forEach(function(item) {\n        var height = item.rect.element.height + itemVerticalMargin;\n        bounds += height;\n        visual += height * item.opacity;\n      });\n    }\n    // grid\n    else {\n      bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n      visual = bounds;\n    }\n\n    return { visual: visual, bounds: bounds };\n  };\n\n  var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(\n    root\n  ) {\n    var height = root.ref.measureHeight || null;\n    var cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    var fixedHeight = height === 0 ? null : height;\n\n    return {\n      cappedHeight: cappedHeight,\n      fixedHeight: fixedHeight\n    };\n  };\n\n  var exceedsMaxFiles = function exceedsMaxFiles(root, items) {\n    var allowReplace = root.query('GET_ALLOW_REPLACE');\n    var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = root.query('GET_MAX_FILES');\n\n    // total amount of items being dragged\n    var totalBrowseItems = items.length;\n\n    // if does not allow multiple items and dragging more than one item\n    if (!allowMultiple && totalBrowseItems > 1) {\n      return true;\n    }\n\n    // limit max items to one if not allowed to drop multiple items\n    maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1;\n\n    // no more room?\n    var hasMaxItems = isInt(maxItems);\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n      root.dispatch('DID_THROW_MAX_FILES', {\n        source: items,\n        error: createResponse('warning', 0, 'Max files')\n      });\n\n      return true;\n    }\n\n    return false;\n  };\n\n  var getDragIndex = function getDragIndex(list, children, position) {\n    var itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, children, {\n      left: position.scopeLeft - itemList.rect.element.left,\n      top:\n        position.scopeTop -\n        (list.rect.outer.top +\n          list.rect.element.marginTop +\n          list.rect.element.scrollTop)\n    });\n  };\n\n  /**\n   * Enable or disable file drop functionality\n   */\n  var toggleDrop = function toggleDrop(root) {\n    var isAllowed = root.query('GET_ALLOW_DROP');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.hopper) {\n      var hopper = createHopper(\n        root.element,\n        function(items) {\n          // allow quick validation of dropped items\n          var beforeDropFile =\n            root.query('GET_BEFORE_DROP_FILE') ||\n            function() {\n              return true;\n            };\n\n          // all items should be validated by all filters as valid\n          var dropValidation = root.query('GET_DROP_VALIDATION');\n          return dropValidation\n            ? items.every(function(item) {\n                return (\n                  applyFilters('ALLOW_HOPPER_ITEM', item, {\n                    query: root.query\n                  }).every(function(result) {\n                    return result === true;\n                  }) && beforeDropFile(item)\n                );\n              })\n            : true;\n        },\n        {\n          filterItems: function filterItems(items) {\n            var ignoredFiles = root.query('GET_IGNORED_FILES');\n            return items.filter(function(item) {\n              if (isFile(item)) {\n                return !ignoredFiles.includes(item.name.toLowerCase());\n              }\n              return true;\n            });\n          },\n          catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n          requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT')\n        }\n      );\n\n      hopper.onload = function(items, position) {\n        // get item children elements and sort based on list sort\n        var list = root.ref.list.childViews[0];\n        var visibleChildren = list.childViews.filter(function(child) {\n          return child.rect.element.height;\n        });\n        var children = root\n          .query('GET_ACTIVE_ITEMS')\n          .map(function(item) {\n            return visibleChildren.find(function(child) {\n              return child.id === item.id;\n            });\n          })\n          .filter(function(item) {\n            return item;\n          });\n\n        applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(\n          function(queue) {\n            // these files don't fit so stop here\n            if (exceedsMaxFiles(root, queue)) return false;\n\n            // go\n            root.dispatch('ADD_ITEMS', {\n              items: queue,\n              index: getDragIndex(root.ref.list, children, position),\n              interactionMethod: InteractionMethod.DROP\n            });\n          }\n        );\n\n        root.dispatch('DID_DROP', { position: position });\n\n        root.dispatch('DID_END_DRAG', { position: position });\n      };\n\n      hopper.ondragstart = function(position) {\n        root.dispatch('DID_START_DRAG', { position: position });\n      };\n\n      hopper.ondrag = debounce(function(position) {\n        root.dispatch('DID_DRAG', { position: position });\n      });\n\n      hopper.ondragend = function(position) {\n        root.dispatch('DID_END_DRAG', { position: position });\n      };\n\n      root.ref.hopper = hopper;\n\n      root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n      root.ref.hopper.destroy();\n      root.ref.hopper = null;\n      root.removeChildView(root.ref.drip);\n    }\n  };\n\n  /**\n   * Enable or disable browse functionality\n   */\n  var toggleBrowse = function toggleBrowse(root, props) {\n    var isAllowed = root.query('GET_ALLOW_BROWSE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.browser) {\n      root.ref.browser = root.appendChildView(\n        root.createChildView(\n          browser,\n          Object.assign({}, props, {\n            onload: function onload(items) {\n              applyFilterChain('ADD_ITEMS', items, {\n                dispatch: root.dispatch\n              }).then(function(queue) {\n                // these files don't fit so stop here\n                if (exceedsMaxFiles(root, queue)) return false;\n\n                // add items!\n                root.dispatch('ADD_ITEMS', {\n                  items: queue,\n                  index: -1,\n                  interactionMethod: InteractionMethod.BROWSE\n                });\n              });\n            }\n          })\n        ),\n\n        0\n      );\n    } else if (!enabled && root.ref.browser) {\n      root.removeChildView(root.ref.browser);\n      root.ref.browser = null;\n    }\n  };\n\n  /**\n   * Enable or disable paste functionality\n   */\n  var togglePaste = function togglePaste(root) {\n    var isAllowed = root.query('GET_ALLOW_PASTE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.paster) {\n      root.ref.paster = createPaster();\n      root.ref.paster.onload = function(items) {\n        applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(\n          function(queue) {\n            // these files don't fit so stop here\n            if (exceedsMaxFiles(root, queue)) return false;\n\n            // add items!\n            root.dispatch('ADD_ITEMS', {\n              items: queue,\n              index: -1,\n              interactionMethod: InteractionMethod.PASTE\n            });\n          }\n        );\n      };\n    } else if (!enabled && root.ref.paster) {\n      root.ref.paster.destroy();\n      root.ref.paster = null;\n    }\n  };\n\n  /**\n   * Route actions\n   */\n  var route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {\n      var root = _ref6.root;\n      toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {\n      var root = _ref7.root;\n      togglePaste(root);\n    },\n    DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {\n      var root = _ref8.root,\n        props = _ref8.props;\n      toggleDrop(root);\n      togglePaste(root);\n      toggleBrowse(root, props);\n      var isDisabled = root.query('GET_DISABLED');\n      if (isDisabled) {\n        root.element.dataset.disabled = 'disabled';\n      } else {\n        // delete root.element.dataset.disabled; <= this does not work on iOS 10\n        root.element.removeAttribute('data-disabled');\n      }\n    }\n  });\n\n  var root = createView({\n    name: 'root',\n    read: function read(_ref9) {\n      var root = _ref9.root;\n      if (root.ref.measure) {\n        root.ref.measureHeight = root.ref.measure.offsetHeight;\n      }\n    },\n    create: create$e,\n    write: write$9,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      if (root.ref.paster) {\n        root.ref.paster.destroy();\n      }\n      if (root.ref.hopper) {\n        root.ref.hopper.destroy();\n      }\n      root.element.removeEventListener('touchmove', prevent);\n      root.element.removeEventListener('gesturestart', prevent);\n    },\n    mixins: {\n      styles: ['height']\n    }\n  });\n\n  // creates the app\n  var createApp = function createApp() {\n    var initialOptions =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // let element\n    var originalElement = null;\n\n    // get default options\n    var defaultOptions = getOptions();\n\n    // create the data store, this will contain all our app info\n    var store = createStore(\n      // initial state (should be serializable)\n      createInitialState(defaultOptions),\n\n      // queries\n      [queries, createOptionQueries(defaultOptions)],\n\n      // action handlers\n      [actions, createOptionActions(defaultOptions)]\n    );\n\n    // set initial options\n    store.dispatch('SET_OPTIONS', { options: initialOptions });\n\n    // kick thread if visibility changes\n    var visibilityHandler = function visibilityHandler() {\n      if (document.hidden) return;\n      store.dispatch('KICK');\n    };\n    document.addEventListener('visibilitychange', visibilityHandler);\n\n    // re-render on window resize start and finish\n    var resizeDoneTimer = null;\n    var isResizing = false;\n    var isResizingHorizontally = false;\n    var initialWindowWidth = null;\n    var currentWindowWidth = null;\n    var resizeHandler = function resizeHandler() {\n      if (!isResizing) {\n        isResizing = true;\n      }\n      clearTimeout(resizeDoneTimer);\n      resizeDoneTimer = setTimeout(function() {\n        isResizing = false;\n        initialWindowWidth = null;\n        currentWindowWidth = null;\n        if (isResizingHorizontally) {\n          isResizingHorizontally = false;\n          store.dispatch('DID_STOP_RESIZE');\n        }\n      }, 500);\n    };\n    window.addEventListener('resize', resizeHandler);\n\n    // render initial view\n    var view = root(store, { id: getUniqueId() });\n\n    //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n    var isResting = false;\n    var isHidden = false;\n\n    var readWriteApi = {\n      // necessary for update loop\n\n      /**\n       * Reads from dom (never call manually)\n       * @private\n       */\n      _read: function _read() {\n        // test if we're resizing horizontally\n        // TODO: see if we can optimize this by measuring root rect\n        if (isResizing) {\n          currentWindowWidth = window.innerWidth;\n          if (!initialWindowWidth) {\n            initialWindowWidth = currentWindowWidth;\n          }\n\n          if (\n            !isResizingHorizontally &&\n            currentWindowWidth !== initialWindowWidth\n          ) {\n            store.dispatch('DID_START_RESIZE');\n            isResizingHorizontally = true;\n          }\n        }\n\n        if (isHidden && isResting) {\n          // test if is no longer hidden\n          isResting = view.element.offsetParent === null;\n        }\n\n        // if resting, no need to read as numbers will still all be correct\n        if (isResting) return;\n\n        // read view data\n        view._read();\n\n        // if is hidden we need to know so we exit rest mode when revealed\n        isHidden = view.rect.element.hidden;\n      },\n\n      /**\n       * Writes to dom (never call manually)\n       * @private\n       */\n      _write: function _write(ts) {\n        // get all actions from store\n        var actions = store\n          .processActionQueue()\n\n          // filter out set actions (these will automatically trigger DID_SET)\n          .filter(function(action) {\n            return !/^SET_/.test(action.type);\n          });\n\n        // if was idling and no actions stop here\n        if (isResting && !actions.length) return;\n\n        // some actions might trigger events\n        routeActionsToEvents(actions);\n\n        // update the view\n        isResting = view._write(ts, actions, isResizingHorizontally);\n\n        // will clean up all archived items\n        removeReleasedItems(store.query('GET_ITEMS'));\n\n        // now idling\n        if (isResting) {\n          store.processDispatchQueue();\n        }\n      }\n    };\n\n    //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n    var createEvent = function createEvent(name) {\n      return function(data) {\n        // create default event\n        var event = {\n          type: name\n        };\n\n        // no data to add\n        if (!data) {\n          return event;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('error')) {\n          event.error = data.error ? Object.assign({}, data.error) : null;\n        }\n\n        if (data.status) {\n          event.status = Object.assign({}, data.status);\n        }\n\n        if (data.file) {\n          event.output = data.file;\n        }\n\n        // only source is available, else add item if possible\n        if (data.source) {\n          event.file = data.source;\n        } else if (data.item || data.id) {\n          var item = data.item ? data.item : store.query('GET_ITEM', data.id);\n          event.file = item ? createItemAPI(item) : null;\n        }\n\n        // map all items in a possible items array\n        if (data.items) {\n          event.items = data.items.map(createItemAPI);\n        }\n\n        // if this is a progress event add the progress amount\n        if (/progress/.test(name)) {\n          event.progress = data.progress;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('origin') && data.hasOwnProperty('target')) {\n          event.origin = data.origin;\n          event.target = data.target;\n        }\n\n        return event;\n      };\n    };\n\n    var eventRoutes = {\n      DID_DESTROY: createEvent('destroy'),\n\n      DID_INIT: createEvent('init'),\n\n      DID_THROW_MAX_FILES: createEvent('warning'),\n\n      DID_INIT_ITEM: createEvent('initfile'),\n      DID_START_ITEM_LOAD: createEvent('addfilestart'),\n      DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n      DID_LOAD_ITEM: createEvent('addfile'),\n\n      DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n\n      DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n\n      DID_THROW_ITEM_REMOVE_ERROR: [\n        createEvent('error'),\n        createEvent('removefile')\n      ],\n\n      DID_PREPARE_OUTPUT: createEvent('preparefile'),\n\n      DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n      DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n      DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n      DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n      DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n\n      DID_THROW_ITEM_PROCESSING_ERROR: [\n        createEvent('error'),\n        createEvent('processfile')\n      ],\n\n      DID_REMOVE_ITEM: createEvent('removefile'),\n\n      DID_UPDATE_ITEMS: createEvent('updatefiles'),\n\n      DID_ACTIVATE_ITEM: createEvent('activatefile'),\n\n      DID_REORDER_ITEMS: createEvent('reorderfiles')\n    };\n\n    var exposeEvent = function exposeEvent(event) {\n      // create event object to be dispatched\n      var detail = Object.assign({ pond: exports }, event);\n      delete detail.type;\n      view.element.dispatchEvent(\n        new CustomEvent('FilePond:' + event.type, {\n          // event info\n          detail: detail,\n\n          // event behaviour\n          bubbles: true,\n          cancelable: true,\n          composed: true // triggers listeners outside of shadow root\n        })\n      );\n\n      // event object to params used for `on()` event handlers and callbacks `oninit()`\n      var params = [];\n\n      // if is possible error event, make it the first param\n      if (event.hasOwnProperty('error')) {\n        params.push(event.error);\n      }\n\n      // file is always section\n      if (event.hasOwnProperty('file')) {\n        params.push(event.file);\n      }\n\n      // append other props\n      var filtered = ['type', 'error', 'file'];\n      Object.keys(event)\n        .filter(function(key) {\n          return !filtered.includes(key);\n        })\n        .forEach(function(key) {\n          return params.push(event[key]);\n        });\n\n      // on(type, () => { })\n      exports.fire.apply(exports, [event.type].concat(params));\n\n      // oninit = () => {}\n      var handler = store.query('GET_ON' + event.type.toUpperCase());\n      if (handler) {\n        handler.apply(void 0, params);\n      }\n    };\n\n    var routeActionsToEvents = function routeActionsToEvents(actions) {\n      if (!actions.length) return;\n      actions\n        .filter(function(action) {\n          return eventRoutes[action.type];\n        })\n        .forEach(function(action) {\n          var routes = eventRoutes[action.type];\n          (Array.isArray(routes) ? routes : [routes]).forEach(function(route) {\n            // this isn't fantastic, but because of the stacking of settimeouts plugins can handle the did_load before the did_init\n            if (action.type === 'DID_INIT_ITEM') {\n              exposeEvent(route(action.data));\n            } else {\n              setTimeout(function() {\n                exposeEvent(route(action.data));\n              }, 0);\n            }\n          });\n        });\n    };\n\n    //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n    var setOptions = function setOptions(options) {\n      return store.dispatch('SET_OPTIONS', { options: options });\n    };\n\n    var getFile = function getFile(query) {\n      return store.query('GET_ACTIVE_ITEM', query);\n    };\n\n    var prepareFile = function prepareFile(query) {\n      return new Promise(function(resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PREPARE', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var addFile = function addFile(source) {\n      var options =\n        arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new Promise(function(resolve, reject) {\n        addFiles([{ source: source, options: options }], {\n          index: options.index\n        })\n          .then(function(items) {\n            return resolve(items && items[0]);\n          })\n          .catch(reject);\n      });\n    };\n\n    var isFilePondFile = function isFilePondFile(obj) {\n      return obj.file && obj.id;\n    };\n\n    var removeFile = function removeFile(query, options) {\n      // if only passed options\n      if (typeof query === 'object' && !isFilePondFile(query) && !options) {\n        options = query;\n        query = undefined;\n      }\n\n      // request item removal\n      store.dispatch(\n        'REMOVE_ITEM',\n        Object.assign({}, options, { query: query })\n      );\n\n      // see if item has been removed\n      return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n\n    var addFiles = function addFiles() {\n      for (\n        var _len = arguments.length, args = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        args[_key] = arguments[_key];\n      }\n      return new Promise(function(resolve, reject) {\n        var sources = [];\n        var options = {};\n\n        // user passed a sources array\n        if (isArray(args[0])) {\n          sources.push.apply(sources, args[0]);\n          Object.assign(options, args[1] || {});\n        } else {\n          // user passed sources as arguments, last one might be options object\n          var lastArgument = args[args.length - 1];\n          if (\n            typeof lastArgument === 'object' &&\n            !(lastArgument instanceof Blob)\n          ) {\n            Object.assign(options, args.pop());\n          }\n\n          // add rest to sources\n          sources.push.apply(sources, args);\n        }\n\n        store.dispatch('ADD_ITEMS', {\n          items: sources,\n          index: options.index,\n          interactionMethod: InteractionMethod.API,\n          success: resolve,\n          failure: reject\n        });\n      });\n    };\n\n    var getFiles = function getFiles() {\n      return store.query('GET_ACTIVE_ITEMS');\n    };\n\n    var processFile = function processFile(query) {\n      return new Promise(function(resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PROCESSING', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var prepareFiles = function prepareFiles() {\n      for (\n        var _len2 = arguments.length, args = new Array(_len2), _key2 = 0;\n        _key2 < _len2;\n        _key2++\n      ) {\n        args[_key2] = arguments[_key2];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var items = queries.length ? queries : getFiles();\n      return Promise.all(items.map(prepareFile));\n    };\n\n    var processFiles = function processFiles() {\n      for (\n        var _len3 = arguments.length, args = new Array(_len3), _key3 = 0;\n        _key3 < _len3;\n        _key3++\n      ) {\n        args[_key3] = arguments[_key3];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      if (!queries.length) {\n        var files = getFiles().filter(function(item) {\n          return (\n            !(\n              item.status === ItemStatus.IDLE &&\n              item.origin === FileOrigin.LOCAL\n            ) &&\n            item.status !== ItemStatus.PROCESSING &&\n            item.status !== ItemStatus.PROCESSING_COMPLETE &&\n            item.status !== ItemStatus.PROCESSING_REVERT_ERROR\n          );\n        });\n\n        return Promise.all(files.map(processFile));\n      }\n      return Promise.all(queries.map(processFile));\n    };\n\n    var removeFiles = function removeFiles() {\n      for (\n        var _len4 = arguments.length, args = new Array(_len4), _key4 = 0;\n        _key4 < _len4;\n        _key4++\n      ) {\n        args[_key4] = arguments[_key4];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n\n      var options;\n      if (typeof queries[queries.length - 1] === 'object') {\n        options = queries.pop();\n      } else if (Array.isArray(args[0])) {\n        options = args[1];\n      }\n\n      var files = getFiles();\n\n      if (!queries.length)\n        return Promise.all(\n          files.map(function(file) {\n            return removeFile(file, options);\n          })\n        );\n\n      // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n      var mappedQueries = queries\n        .map(function(query) {\n          return isNumber(query)\n            ? files[query]\n              ? files[query].id\n              : null\n            : query;\n        })\n        .filter(function(query) {\n          return query;\n        });\n\n      return mappedQueries.map(function(q) {\n        return removeFile(q, options);\n      });\n    };\n\n    var exports = Object.assign(\n      {},\n\n      on(),\n      {},\n\n      readWriteApi,\n      {},\n\n      createOptionAPI(store, defaultOptions),\n      {\n        /**\n         * Override options defined in options object\n         * @param options\n         */\n        setOptions: setOptions,\n\n        /**\n         * Load the given file\n         * @param source - the source of the file (either a File, base64 data uri or url)\n         * @param options - object, { index: 0 }\n         */\n        addFile: addFile,\n\n        /**\n         * Load the given files\n         * @param sources - the sources of the files to load\n         * @param options - object, { index: 0 }\n         */\n        addFiles: addFiles,\n\n        /**\n         * Returns the file objects matching the given query\n         * @param query { string, number, null }\n         */\n        getFile: getFile,\n\n        /**\n         * Upload file with given name\n         * @param query { string, number, null  }\n         */\n        processFile: processFile,\n\n        /**\n         * Request prepare output for file with given name\n         * @param query { string, number, null  }\n         */\n        prepareFile: prepareFile,\n\n        /**\n         * Removes a file by its name\n         * @param query { string, number, null  }\n         */\n        removeFile: removeFile,\n\n        /**\n         * Moves a file to a new location in the files list\n         */\n        moveFile: function moveFile(query, index) {\n          return store.dispatch('MOVE_ITEM', { query: query, index: index });\n        },\n\n        /**\n         * Returns all files (wrapped in public api)\n         */\n        getFiles: getFiles,\n\n        /**\n         * Starts uploading all files\n         */\n        processFiles: processFiles,\n\n        /**\n         * Clears all files from the files list\n         */\n        removeFiles: removeFiles,\n\n        /**\n         * Starts preparing output of all files\n         */\n        prepareFiles: prepareFiles,\n\n        /**\n         * Sort list of files\n         */\n        sort: function sort(compare) {\n          return store.dispatch('SORT', { compare: compare });\n        },\n\n        /**\n         * Browse the file system for a file\n         */\n        browse: function browse() {\n          // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n          var input = view.element.querySelector('input[type=file]');\n          if (input) {\n            input.click();\n          }\n        },\n\n        /**\n         * Destroys the app\n         */\n        destroy: function destroy() {\n          // request destruction\n          exports.fire('destroy', view.element);\n\n          // stop active processes (file uploads, fetches, stuff like that)\n          // loop over items and depending on states call abort for ongoing processes\n          store.dispatch('ABORT_ALL');\n\n          // destroy view\n          view._destroy();\n\n          // stop listening to resize\n          window.removeEventListener('resize', resizeHandler);\n\n          // stop listening to the visiblitychange event\n          document.removeEventListener('visibilitychange', visibilityHandler);\n\n          // dispatch destroy\n          store.dispatch('DID_DESTROY');\n        },\n\n        /**\n         * Inserts the plugin before the target element\n         */\n        insertBefore: function insertBefore$1(element) {\n          return insertBefore(view.element, element);\n        },\n\n        /**\n         * Inserts the plugin after the target element\n         */\n        insertAfter: function insertAfter$1(element) {\n          return insertAfter(view.element, element);\n        },\n\n        /**\n         * Appends the plugin to the target element\n         */\n        appendTo: function appendTo(element) {\n          return element.appendChild(view.element);\n        },\n\n        /**\n         * Replaces an element with the app\n         */\n        replaceElement: function replaceElement(element) {\n          // insert the app before the element\n          insertBefore(view.element, element);\n\n          // remove the original element\n          element.parentNode.removeChild(element);\n\n          // remember original element\n          originalElement = element;\n        },\n\n        /**\n         * Restores the original element\n         */\n        restoreElement: function restoreElement() {\n          if (!originalElement) {\n            return; // no element to restore\n          }\n\n          // restore original element\n          insertAfter(originalElement, view.element);\n\n          // remove our element\n          view.element.parentNode.removeChild(view.element);\n\n          // remove reference\n          originalElement = null;\n        },\n\n        /**\n         * Returns true if the app root is attached to given element\n         * @param element\n         */\n        isAttachedTo: function isAttachedTo(element) {\n          return view.element === element || originalElement === element;\n        },\n\n        /**\n         * Returns the root element\n         */\n        element: {\n          get: function get() {\n            return view.element;\n          }\n        },\n\n        /**\n         * Returns the current pond status\n         */\n        status: {\n          get: function get() {\n            return store.query('GET_STATUS');\n          }\n        }\n      }\n    );\n\n    // Done!\n    store.dispatch('DID_INIT');\n\n    // create actual api object\n    return createObject(exports);\n  };\n\n  var createAppObject = function createAppObject() {\n    var customOptions =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // default options\n    var defaultOptions = {};\n    forin(getOptions(), function(key, value) {\n      defaultOptions[key] = value[0];\n    });\n\n    // set app options\n    var app = createApp(\n      Object.assign(\n        {},\n\n        defaultOptions,\n        {},\n\n        customOptions\n      )\n    );\n\n    // return the plugin instance\n    return app;\n  };\n\n  var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {\n    return string.charAt(0).toLowerCase() + string.slice(1);\n  };\n\n  var attributeNameToPropertyName = function attributeNameToPropertyName(\n    attributeName\n  ) {\n    return toCamels(attributeName.replace(/^data-/, ''));\n  };\n\n  var mapObject = function mapObject(object, propertyMap) {\n    // remove unwanted\n    forin(propertyMap, function(selector, mapping) {\n      forin(object, function(property, value) {\n        // create regexp shortcut\n        var selectorRegExp = new RegExp(selector);\n\n        // tests if\n        var matches = selectorRegExp.test(property);\n\n        // no match, skip\n        if (!matches) {\n          return;\n        }\n\n        // if there's a mapping, the original property is always removed\n        delete object[property];\n\n        // should only remove, we done!\n        if (mapping === false) {\n          return;\n        }\n\n        // move value to new property\n        if (isString(mapping)) {\n          object[mapping] = value;\n          return;\n        }\n\n        // move to group\n        var group = mapping.group;\n        if (isObject(mapping) && !object[group]) {\n          object[group] = {};\n        }\n\n        object[group][\n          lowerCaseFirstLetter(property.replace(selectorRegExp, ''))\n        ] = value;\n      });\n\n      // do submapping\n      if (mapping.mapping) {\n        mapObject(object[mapping.group], mapping.mapping);\n      }\n    });\n  };\n\n  var getAttributesAsObject = function getAttributesAsObject(node) {\n    var attributeMapping =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    // turn attributes into object\n    var attributes = [];\n    forin(node.attributes, function(index) {\n      attributes.push(node.attributes[index]);\n    });\n\n    var output = attributes\n      .filter(function(attribute) {\n        return attribute.name;\n      })\n      .reduce(function(obj, attribute) {\n        var value = attr(node, attribute.name);\n\n        obj[attributeNameToPropertyName(attribute.name)] =\n          value === attribute.name ? true : value;\n        return obj;\n      }, {});\n\n    // do mapping of object properties\n    mapObject(output, attributeMapping);\n\n    return output;\n  };\n\n  var createAppAtElement = function createAppAtElement(element) {\n    var options =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    // how attributes of the input element are mapped to the options for the plugin\n    var attributeMapping = {\n      // translate to other name\n      '^class$': 'className',\n      '^multiple$': 'allowMultiple',\n      '^capture$': 'captureMethod',\n      '^webkitdirectory$': 'allowDirectoriesOnly',\n\n      // group under single property\n      '^server': {\n        group: 'server',\n        mapping: {\n          '^process': {\n            group: 'process'\n          },\n\n          '^revert': {\n            group: 'revert'\n          },\n\n          '^fetch': {\n            group: 'fetch'\n          },\n\n          '^restore': {\n            group: 'restore'\n          },\n\n          '^load': {\n            group: 'load'\n          }\n        }\n      },\n\n      // don't include in object\n      '^type$': false,\n      '^files$': false\n    };\n\n    // add additional option translators\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);\n\n    // create final options object by setting options object and then overriding options supplied on element\n    var mergedOptions = Object.assign({}, options);\n\n    var attributeOptions = getAttributesAsObject(\n      element.nodeName === 'FIELDSET'\n        ? element.querySelector('input[type=file]')\n        : element,\n      attributeMapping\n    );\n\n    // merge with options object\n    Object.keys(attributeOptions).forEach(function(key) {\n      if (isObject(attributeOptions[key])) {\n        if (!isObject(mergedOptions[key])) {\n          mergedOptions[key] = {};\n        }\n        Object.assign(mergedOptions[key], attributeOptions[key]);\n      } else {\n        mergedOptions[key] = attributeOptions[key];\n      }\n    });\n\n    // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n    mergedOptions.files = (options.files || []).concat(\n      Array.from(element.querySelectorAll('input:not([type=file])')).map(\n        function(input) {\n          return {\n            source: input.value,\n            options: {\n              type: input.dataset.type\n            }\n          };\n        }\n      )\n    );\n\n    // build plugin\n    var app = createAppObject(mergedOptions);\n\n    // add already selected files\n    if (element.files) {\n      Array.from(element.files).forEach(function(file) {\n        app.addFile(file);\n      });\n    }\n\n    // replace the target element\n    app.replaceElement(element);\n\n    // expose\n    return app;\n  };\n\n  // if an element is passed, we create the instance at that element, if not, we just create an up object\n  var createApp$1 = function createApp() {\n    return isNode(arguments.length <= 0 ? undefined : arguments[0])\n      ? createAppAtElement.apply(void 0, arguments)\n      : createAppObject.apply(void 0, arguments);\n  };\n\n  var PRIVATE_METHODS = ['fire', '_read', '_write'];\n\n  var createAppAPI = function createAppAPI(app) {\n    var api = {};\n\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n\n    return api;\n  };\n\n  /**\n   * Replaces placeholders in given string with replacements\n   * @param string - \"Foo {bar}\"\"\n   * @param replacements - { \"bar\": 10 }\n   */\n  var replaceInString = function replaceInString(string, replacements) {\n    return string.replace(/(?:{([a-zA-Z]+)})/g, function(match, group) {\n      return replacements[group];\n    });\n  };\n\n  var createWorker = function createWorker(fn) {\n    var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n      type: 'application/javascript'\n    });\n\n    var workerURL = URL.createObjectURL(workerBlob);\n    var worker = new Worker(workerURL);\n\n    return {\n      transfer: function transfer(message, cb) {},\n      post: function post(message, cb, transferList) {\n        var id = getUniqueId();\n\n        worker.onmessage = function(e) {\n          if (e.data.id === id) {\n            cb(e.data.message);\n          }\n        };\n\n        worker.postMessage(\n          {\n            id: id,\n            message: message\n          },\n\n          transferList\n        );\n      },\n      terminate: function terminate() {\n        worker.terminate();\n        URL.revokeObjectURL(workerURL);\n      }\n    };\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function(resolve, reject) {\n      var img = new Image();\n      img.onload = function() {\n        resolve(img);\n      };\n      img.onerror = function(e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  var renameFile = function renameFile(file, name) {\n    var renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n  };\n\n  var copyFile = function copyFile(file) {\n    return renameFile(file, file.name);\n  };\n\n  // already registered plugins (can't register twice)\n  var registeredPlugins = [];\n\n  // pass utils to plugin\n  var createAppPlugin = function createAppPlugin(plugin) {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n      return;\n    }\n\n    // remember this plugin\n    registeredPlugins.push(plugin);\n\n    // setup!\n    var pluginOutline = plugin({\n      addFilter: addFilter,\n      utils: {\n        Type: Type,\n        forin: forin,\n        isString: isString,\n        isFile: isFile,\n        toNaturalFileSize: toNaturalFileSize,\n        replaceInString: replaceInString,\n        getExtensionFromFilename: getExtensionFromFilename,\n        getFilenameWithoutExtension: getFilenameWithoutExtension,\n        guesstimateMimeType: guesstimateMimeType,\n        getFileFromBlob: getFileFromBlob,\n        getFilenameFromURL: getFilenameFromURL,\n        createRoute: createRoute,\n        createWorker: createWorker,\n        createView: createView,\n        createItemAPI: createItemAPI,\n        loadImage: loadImage,\n        copyFile: copyFile,\n        renameFile: renameFile,\n        createBlob: createBlob,\n        applyFilterChain: applyFilterChain,\n        text: text,\n        getNumericAspectRatioFromString: getNumericAspectRatioFromString\n      },\n\n      views: {\n        fileActionButton: fileActionButton\n      }\n    });\n\n    // add plugin options to default options\n    extendDefaultOptions(pluginOutline.options);\n  };\n\n  // feature detection used by supported() method\n  var isOperaMini = function isOperaMini() {\n    return (\n      Object.prototype.toString.call(window.operamini) === '[object OperaMini]'\n    );\n  };\n  var hasPromises = function hasPromises() {\n    return 'Promise' in window;\n  };\n  var hasBlobSlice = function hasBlobSlice() {\n    return 'slice' in Blob.prototype;\n  };\n  var hasCreateObjectURL = function hasCreateObjectURL() {\n    return 'URL' in window && 'createObjectURL' in window.URL;\n  };\n  var hasVisibility = function hasVisibility() {\n    return 'visibilityState' in document;\n  };\n  var hasTiming = function hasTiming() {\n    return 'performance' in window;\n  }; // iOS 8.x\n  var hasCSSSupports = function hasCSSSupports() {\n    return 'supports' in (window.CSS || {});\n  }; // use to detect Safari 9+\n  var isIE11 = function isIE11() {\n    return /MSIE|Trident/.test(window.navigator.userAgent);\n  };\n\n  var supported = (function() {\n    // Runs immediately and then remembers result for subsequent calls\n    var isSupported =\n      // Has to be a browser\n      isBrowser() &&\n      // Can't run on Opera Mini due to lack of everything\n      !isOperaMini() &&\n      // Require these APIs to feature detect a modern browser\n      hasVisibility() &&\n      hasPromises() &&\n      hasBlobSlice() &&\n      hasCreateObjectURL() &&\n      hasTiming() &&\n      // doesn't need CSSSupports but is a good way to detect Safari 9+ (we do want to support IE11 though)\n      (hasCSSSupports() || isIE11());\n\n    return function() {\n      return isSupported;\n    };\n  })();\n\n  /**\n   * Plugin internal state (over all instances)\n   */\n  var state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: []\n  };\n\n  // plugin name\n  var name = 'filepond';\n\n  /**\n   * Public Plugin methods\n   */\n  var fn = function fn() {};\n  exports.Status = {};\n  exports.FileStatus = {};\n  exports.FileOrigin = {};\n  exports.OptionTypes = {};\n  exports.create = fn;\n  exports.destroy = fn;\n  exports.parse = fn;\n  exports.find = fn;\n  exports.registerPlugin = fn;\n  exports.getOptions = fn;\n  exports.setOptions = fn;\n\n  // if not supported, no API\n  if (supported()) {\n    // start painter and fire load event\n    createPainter(\n      function() {\n        state.apps.forEach(function(app) {\n          return app._read();\n        });\n      },\n      function(ts) {\n        state.apps.forEach(function(app) {\n          return app._write(ts);\n        });\n      }\n    );\n\n    // fire loaded event so we know when FilePond is available\n    var dispatch = function dispatch() {\n      // let others know we have area ready\n      document.dispatchEvent(\n        new CustomEvent('FilePond:loaded', {\n          detail: {\n            supported: supported,\n            create: exports.create,\n            destroy: exports.destroy,\n            parse: exports.parse,\n            find: exports.find,\n            registerPlugin: exports.registerPlugin,\n            setOptions: exports.setOptions\n          }\n        })\n      );\n\n      // clean up event\n      document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n\n    if (document.readyState !== 'loading') {\n      // move to back of execution queue, FilePond should have been exported by then\n      setTimeout(function() {\n        return dispatch();\n      }, 0);\n    } else {\n      document.addEventListener('DOMContentLoaded', dispatch);\n    }\n\n    // updates the OptionTypes object based on the current options\n    var updateOptionTypes = function updateOptionTypes() {\n      return forin(getOptions(), function(key, value) {\n        exports.OptionTypes[key] = value[1];\n      });\n    };\n\n    exports.Status = Object.assign({}, Status);\n    exports.FileOrigin = Object.assign({}, FileOrigin);\n    exports.FileStatus = Object.assign({}, ItemStatus);\n\n    exports.OptionTypes = {};\n    updateOptionTypes();\n\n    // create method, creates apps and adds them to the app array\n    exports.create = function create() {\n      var app = createApp$1.apply(void 0, arguments);\n      app.on('destroy', exports.destroy);\n      state.apps.push(app);\n      return createAppAPI(app);\n    };\n\n    // destroys apps and removes them from the app array\n    exports.destroy = function destroy(hook) {\n      // returns true if the app was destroyed successfully\n      var indexToRemove = state.apps.findIndex(function(app) {\n        return app.isAttachedTo(hook);\n      });\n      if (indexToRemove >= 0) {\n        // remove from apps\n        var app = state.apps.splice(indexToRemove, 1)[0];\n\n        // restore original dom element\n        app.restoreElement();\n\n        return true;\n      }\n\n      return false;\n    };\n\n    // parses the given context for plugins (does not include the context element itself)\n    exports.parse = function parse(context) {\n      // get all possible hooks\n      var matchedHooks = Array.from(context.querySelectorAll('.' + name));\n\n      // filter out already active hooks\n      var newHooks = matchedHooks.filter(function(newHook) {\n        return !state.apps.find(function(app) {\n          return app.isAttachedTo(newHook);\n        });\n      });\n\n      // create new instance for each hook\n      return newHooks.map(function(hook) {\n        return exports.create(hook);\n      });\n    };\n\n    // returns an app based on the given element hook\n    exports.find = function find(hook) {\n      var app = state.apps.find(function(app) {\n        return app.isAttachedTo(hook);\n      });\n      if (!app) {\n        return null;\n      }\n      return createAppAPI(app);\n    };\n\n    // adds a plugin extension\n    exports.registerPlugin = function registerPlugin() {\n      for (\n        var _len = arguments.length, plugins = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        plugins[_key] = arguments[_key];\n      }\n\n      // register plugins\n      plugins.forEach(createAppPlugin);\n\n      // update OptionTypes, each plugin might have extended the default options\n      updateOptionTypes();\n    };\n\n    exports.getOptions = function getOptions$1() {\n      var opts = {};\n      forin(getOptions(), function(key, value) {\n        opts[key] = value[0];\n      });\n      return opts;\n    };\n\n    exports.setOptions = function setOptions$1(opts) {\n      if (isObject(opts)) {\n        // update existing plugins\n        state.apps.forEach(function(app) {\n          app.setOptions(opts);\n        });\n\n        // override defaults\n        setOptions(opts);\n      }\n\n      // return new options\n      return exports.getOptions();\n    };\n  }\n\n  exports.supported = supported;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}